(self.webpackChunkapril_crm=self.webpackChunkapril_crm||[]).push([[761],{8205:(e,t,n)=>{n.d(t,{R4:()=>s,Ss:()=>a,db:()=>r,pY:()=>l,wV:()=>c});var r=!0,a="gsr.bitrix24.ru",l=143,c=187,s=!1},9394:(e,t,n)=>{n.d(t,{A:()=>fe});var r,a=n(7075),l=n(9733),c=n(6540),s={setFetchedCallings:function setFetchedCallings(e){return{type:"callings/SET_FITCHED_CALLINGS",callings:e}},setFetchedDepartament:function setFetchedDepartament(e,t,n,r){return{type:"callings/SET_FITCHED_DEPARTAMENT",departament:e,currentUser:t,placement:n,domain:r}},setPrimrtiveStateProp:function setPrimrtiveStateProp(e,t){return{type:"callings/SET_STATE_PROP",name:e,value:t}},setFullCompleteStatus:function setFullCompleteStatus(e){return{type:"callings/SET_FULL_COMPLETE_STATUS",status:e}},setFinishStatus:function setFinishStatus(e,t){return{type:"callings/SET_FINISH_STATUS",status:e,result:t}}},o=n(9002),u=n(4929),i=n(291),p=n(8205),d=n(4003),m=n(1715),f=n(5580);!function(e){e.SALES="sales",e.CUP="cup",e.TMC="tmc",e.SERVICE="service",e.EDU="edu",e.GENERAL="general"}(r||(r={}));var b,y=function setMenuStatus(e,t){return{type:"callings/result/SET_MENU_STATUS",status:e,menuType:t}},__awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},__generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},v=function getResultMenu(e,t){return function(n,r){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(r){return n(y(e,t)),{default:{general:{next:{date:"",name:""},workStatus:{items:[],current:null},failReason:{items:[],current:null},noPerspektType:{items:[],current:null},isFail:!1},noResult:{type:{items:[],current:null}}}},[2]}))}))}},g=n(1301),report_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},report_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}};!function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(b||(b={}));var E=function checkIfTaskIsOverdue(e){var t="no",n=new Date,r=new Date(e.deadline);r<n?t="yes":(r.setHours(0,0,0,0),n.setHours(0,0,0,0),n.getTime()===r.getTime()&&(t="almost"));return t},_=function parseTaskTitle(e){e.match(/^(.*?)(?=\sзапланирован)/),e.match(/запланирован[ао]?\s+(.*?)\s+\d{2}\.\d{2}\.\d{4}/);return{type:"Запланирован",name:e}},S=function getFormatDate(e){if(e){var t=(0,u.H)(e);return(0,i.GP)(t,"d MMMM yyyy HH:mm",{locale:f.ru})}return""},h=n(5826),A=n(9704),T=n(3342);n(6540);var C=n(5169),w=n(7917),P=n(2056),N=n(6540);const O=function Comment(e){var t=e.handleChange,n=(0,c.useState)(!1),r=(0,a.A)(n,2),l=r[0],s=r[1];return N.createElement(N.Fragment,null,N.createElement("label",{htmlFor:"description-string-input",className:"col-md-12 col-form-label"},"Опишите кратко что было"),N.createElement("div",{className:"col-md-12 mt-2  mb-2"},N.createElement("textarea",{onChange:function onChange(e){return t(P.u$.DESCRIPTION,e.target.value)},onFocus:function handleOnNameFocus(){l&&s(!1)},className:"form-control",type:"text",id:"description-string-input",lang:"rus",rows:"7"})))};var I=n(6477);const x=function Presentation(e){var t=e.presentation,n=(0,c.useState)(!1),r=(0,a.A)(n,2),l=r[0],s=r[1];return c.createElement(c.Fragment,null,c.createElement("div",{className:"page-content"},c.createElement(C.A,{fluid:!0},c.createElement(h.A,{className:"mb-12"},c.createElement(A.A,{sm:12},c.createElement("h3",{className:"text__bold col-md-4 col-form-label"},"Презентации"))),c.createElement(h.A,null,c.createElement(A.A,{sm:12},c.createElement(h.A,{sm:12,className:"d-flex flex-row justify-content-start align-items-start"},c.createElement(A.A,{sm:6,className:"d-flex flex-column justify-content-start align-items-start"},c.createElement("div",null,c.createElement("label",{className:"col-md-12 col-form-label mt-2"},"По компании")),c.createElement("div",{sm:12},c.createElement("div",{className:"f col-md-12 mt-1"},c.createElement("input",{disabled:!0,style:{height:"37.6px"},className:"form-control mt-0",type:"text",id:"example-string-input",lang:"rus",value:t.companyCount})))),c.createElement(A.A,{sm:6,className:"d-flex flex-column justify-content-start align-items-start"},c.createElement("div",{sm:12},c.createElement("label",{className:"col-md-12 col-form-label mt-2"},"Текущие")),c.createElement("div",{sm:12},c.createElement("div",{className:"f mt-1"},c.createElement("input",{disabled:!0,style:{height:"37.6px"},className:"form-control mt-0",type:"text",id:"example-string-input",lang:"rus",value:t.smartCout}))))),c.createElement("div",{onClick:function onClick(){return s(!l)},className:"d-flex flex-column justify-content-start align-items-start"},c.createElement("label",{htmlFor:"example-string-input",className:"col-md-6 mt-1 col-form-label mt-3"},"Зафиксировать презентацию"),c.createElement("div",{className:"presentation__actions"},c.createElement(I.A,{style:{cursor:"pointer"},outline:!0,className:"col-md-3 \n                                    ".concat(l?"presentation__badge__active":"presentation__badge")},"Была проведена"),l&&c.createElement("div",{className:"presentation__done__count"},"+1"))))))))};const R=function Plan(e){var t=e.responsibility,n=e.createdBy,r=e.date,l=(e.name,e.type),s=(e.plan,e.setCurentCallingProp),o=e.changeDeadline,u=(e.createTask,(0,c.useState)(t.current)),i=(0,a.A)(u,2),p=(i[0],i[1]),d=(0,c.useState)(n.current),m=(0,a.A)(d,2),f=(m[0],m[1],(0,c.useState)(!1)),b=(0,a.A)(f,2),y=b[0],v=b[1];(0,c.useEffect)((function(){p(t.current)}),[t.current]);var g=function handleChange(e,t){s(e,t)};return c.createElement(c.Fragment,null,c.createElement("label",{htmlFor:"example-string-input",className:"col-md-12 col-form-label ".concat(y?"calling-name-label-error":"")},y?"Заполните обязательное поле - Тема звонка":"Название - что нужно сделать"),c.createElement("div",{className:"col-md-12 mt-2 mb-2"},c.createElement("input",{onChange:function onChange(e){return g(P.u$.NAME,e.target.value)},onFocus:function handleOnNameFocus(){y&&v(!1)},className:"mt-0 form-control ".concat(y?"is-invalid":""),type:"text",id:"example-string-input",lang:"rus"})),c.createElement("label",{htmlFor:"example-datetime-local-input",className:"col-md-12 col-form-label"},"Дата и время звонка"),c.createElement("div",{className:"col-md-12 mt-2   mb-2"},c.createElement("input",{className:"form-control mt-0",type:"datetime-local",defaultValue:r,id:"example-datetime-local-input",lang:"rus",onChange:function onChange(e){return o(e.target.value)}})),c.createElement("label",{className:"col-md-12 col-form-label"},"Тип звонка"),c.createElement("div",{className:"col-md-12 mt-2  mb-0"},c.createElement("select",{className:"form-control  mt-0",value:l.current.id,onChange:function onChange(e){return g(P.u$.TYPE,e.target.value)}},l.items&&l.items.length&&l.items.map((function(e){return c.createElement("option",{key:"call-type-".concat(e.id),value:e.id},e.title)})))))};var D,k,M,j,F,L,U=n(4705),Y=n(467),$=n(4756),B=n.n($),H=n(6266).A.create({baseURL:"https://april-hook.ru/api",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),z={getCollection:(M=(0,Y.A)(B().mark((function _callee(e,t,n){var r,a,l,c=arguments;return B().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(r=c.length>3&&void 0!==c[3]?c[3]:null,a=null,s.prev=2,r){s.next=9;break}return s.next=6,H[t](e);case 6:s.t0=s.sent,s.next=12;break;case 9:return s.next=11,H[t](e,r);case 11:s.t0=s.sent;case 12:if(!(l=s.t0)){s.next=16;break}return l.data&&0===l.data.resultCode&&l.data[n]&&(a=l.data.isCollection?l.data[n].data:l.data[n]),s.abrupt("return",a);case 16:s.next=21;break;case 18:return s.prev=18,s.t1=s.catch(2),s.abrupt("return",a);case 21:case"end":return s.stop()}}),_callee,null,[[2,18]])}))),function getCollection(e,t,n){return M.apply(this,arguments)}),setCollection:(k=(0,Y.A)(B().mark((function _callee2(e,t){var n,r,a;return B().wrap((function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:return n=null,l.prev=1,r=(0,U.A)({},e,t),l.next=5,H.post(e,r);case 5:return(a=l.sent)&&0===a.data.resultCode&&(n=a.data.data),l.abrupt("return",n);case 10:return l.prev=10,l.t0=l.catch(1),l.abrupt("return",n);case 13:case"end":return l.stop()}}),_callee2,null,[[1,10]])}))),function setCollection(e,t){return k.apply(this,arguments)}),service:(D=(0,Y.A)(B().mark((function _callee3(e,t,n,r){var a,l;return B().wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,H[t](e,r);case 4:return(l=c.sent)&&l.data&&0===l.data.resultCode&&(a=l.data[n]),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee3,null,[[1,9]])}))),function service(e,t,n,r){return D.apply(this,arguments)})},K=(L=(0,Y.A)(B().mark((function _callee4(e,t,n,r,a,l,c,s,o,u,i,p,d,m){var f,b,y;return B().wrap((function _callee4$(v){for(;;)switch(v.prev=v.next){case 0:return f=null,b={type:e,auth:{domain:t},company_id:n,deadline:r,responsible:a,created:l,name:c,comment:s,crm:o,company:u,smart:i,sale:p,isOneMore:d,placement:m},v.prev=2,v.next=5,H.post("task/warm",b);case 5:return(y=v.sent)&&y.data&&0===y.data.resultCode&&(f=y.data),v.abrupt("return",f);case 10:return v.prev=10,v.t0=v.catch(2),v.abrupt("return",f);case 13:case"end":return v.stop()}}),_callee4,null,[[2,10]])}))),F=(0,Y.A)(B().mark((function _callee5(e,t,n,r,a){var l,c,s;return B().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return l=null,c={auth:{domain:e},company_id:t,placement:n,smart:a,responsible:r},o.prev=2,o.next=5,H.post("task/fail",c);case 5:return(s=o.sent)&&s.data&&0===s.data.resultCode&&(l=s.data.result),o.abrupt("return",l);case 10:return o.prev=10,o.t0=o.catch(2),o.abrupt("return",l);case 13:case"end":return o.stop()}}),_callee5,null,[[2,10]])}))),j=(0,Y.A)(B().mark((function _callee6(e,t,n,r,a,l,c){var s,o,u;return B().wrap((function _callee6$(i){for(;;)switch(i.prev=i.next){case 0:return s=null,o={auth:{domain:e},company_id:t,placement:n,company:a,smart:l,responsibleId:r,isUnplannedPresentation:c},i.prev=2,i.next=5,H.post("presentation/done",o);case 5:return(u=i.sent)&&u.data&&0===u.data.resultCode&&(s=u.data.result),i.abrupt("return",s);case 10:return i.prev=10,i.t0=i.catch(2),i.abrupt("return",s);case 13:case"end":return i.stop()}}),_callee6,null,[[2,10]])}))),function setPresentationCount(e,t){return{type:"callings/presentation/SET_PRESENTATION_COUNT",count:e,entityType:t}}),G=n(2872),W=function setPrimrtiveStateProp(e,t){return{type:"callings/plan/SET_STATE_PROP",name:e,value:t}},q=function setSaleComplete(){return{type:"callings/postSale/SET_SALE_COMPLETE"}},Q=function setSaleQuestionStatus(e){return{type:"callings/postSale/SET_SALE_QUESTION_STATUS",status:e}},X=n(4850),V=n(8329),calling_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},calling_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},Z=function getCallingPlan(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,u;return calling_thunk_generator(this,(function(i){switch(i.label){case 0:return n=t(),r=n.app.domain,a=n.calling[P.u$.RESPONSIBILITY].current,l=n.calling.date,c={domain:r,userId:a&&a.ID,date:l},[4,o.o_.service("bitrix/callingtasks","post","tasks",c)];case 1:return(u=i.sent())&&e(s.setPrimrtiveStateProp(P.u$.PLAN,u)),[2]}}))}))}},J=function getBitrixItems(e){return function(t,n){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var r,a,l,c,o,u,i,f,b,y,v,g,E;return calling_thunk_generator(this,(function(_){switch(_.label){case 0:return Number(e.options.ID),null,e.placement.includes(P.u7.LEAD)?P.u7.LEAD:e.placement.includes(P.u7.COMPANY)&&P.u7.COMPANY,r=n(),a=null,l=r.app.domain,c=r.calling[P.u$.RESPONSIBILITY].current,e.placement.includes(P.u7.LEAD)?(o=Number(e.options.ID),(i=p.db)?[4,d.l.getLead(o)]:[3,2]):[3,5];case 1:i=_.sent(),_.label=2;case 2:return(u=i)?(g={domain:l,leadId:o,userId:null==c?void 0:c.ID},[4,z.service("smart/item/fromlead",m.b.POST,"data",g)]):[3,4];case 3:(a=_.sent())&&(a.ufCrm10_1709111529&&t(K(a.ufCrm10_1709111529,"smart")),a.ufCrm6_1709894507&&t(K(a.ufCrm6_1709894507,"smart")),t(s.setPrimrtiveStateProp(P.u$.SMART,a)),a.stageId&&("DT162_26:SUCCESS"!==a.stageId&&"DT156_12:SUCCESS"!==a.stageId||t(q()))),u&&(t(s.setPrimrtiveStateProp(P.u$.LEAD,u)),f=n().calling[P.u$.LEAD],t(s.setFullCompleteStatus(f))),_.label=4;case 4:return[3,9];case 5:return e.placement.includes(P.u7.COMPANY)?(b=Number(e.options.ID),(v=p.db)?[4,d.l.getCompany(b)]:[3,7]):[3,9];case 6:v=_.sent(),_.label=7;case 7:return(y=v)?(g={domain:l,companyId:b,userId:null==c?void 0:c.ID},[4,z.service("smart/item",m.b.POST,"data",g)]):[3,9];case 8:(a=_.sent())&&(a.ufCrm10_1709111529&&t(K(a.ufCrm10_1709111529,"smart")),a.ufCrm6_1709894507&&t(K(a.ufCrm6_1709894507,"smart")),t(s.setPrimrtiveStateProp(P.u$.SMART,a)),a.stageId&&("DT162_26:SUCCESS"!==a.stageId&&"DT156_12:SUCCESS"!==a.stageId||t(q()))),y&&(y.UF_CRM_1709807026&&t(K(y.UF_CRM_1709807026,"company")),t(s.setPrimrtiveStateProp(P.u$.COMPANY,y)),E=n().calling[P.u$.COMPANY],t(s.setFullCompleteStatus(E))),_.label=9;case 9:return[2]}}))}))}},ee=function setCurentCallingProp(e,t){return function(n,r){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var a,l,c,u,i,p,d;return calling_thunk_generator(this,(function(m){switch(m.label){case 0:switch(a=r(),l=a.app.domain,e){case P.u$.RESPONSIBILITY:case P.u$.CREATED_BY:return[3,1];case G.zu.NAME:case G.zu.IS_ONE_MORE:return[3,3]}return[3,4];case 1:return c=a.calling[e].items,u=c.find((function(e){return e.ID==t})),n(s.setPrimrtiveStateProp(e,u)),i=a.plan[G.zu.DATE],p={domain:l,userId:u.ID,date:i},[4,o.o_.service("bitrix/callingtasks","post","tasks",p)];case 2:return(d=m.sent())&&n(s.setPrimrtiveStateProp(P.u$.PLAN,d)),[3,5];case 3:return n(W(e,t)),[3,5];case 4:return[3,5];case 5:return[2]}}))}))}};const te=function ReportSelect(e){var t=e.label,n=e.nameForHandler,r=e.handleChange,a=e.current,l=e.items;return c.createElement(c.Fragment,null,c.createElement("label",{className:"col-md-12 col-form-label mt-2"},t),c.createElement("div",{className:"col-md-12 mt-1  mb-1"},c.createElement("select",{className:"form-control mt-0",value:a.code,onChange:function onChange(e){return r(n,e.target.value)}},l&&l.length&&l.map((function(e){return c.createElement("option",{key:"".concat(n,"-").concat(e.id),value:e.code},e.name)})))))};const ne=function Noresult(e){var t=e.report,n=e.setReportProp,r=t.noresultReason.items,a=t.noresultReason.current;return c.createElement(c.Fragment,null,c.createElement("div",{className:"page-content"},c.createElement(C.A,{fluid:!0},c.createElement(h.A,null,c.createElement("h3",{className:"text__bold col-md-12 col-form-label"},"Нерезультативный звонок")),c.createElement(h.A,{className:""},c.createElement(A.A,{className:"calling__noresult__status",sm:12},c.createElement(te,{label:"Причины нерезультативности/ Переноса",nameForHandler:X.as.NORESULT_REASON,handleChange:function handleChange(e,t){n(e,t)},current:a,items:r}))))))};const re=function Report(e){var t,n=e.report,r=e.setCurentCallingProp,l=e.setReportProp,s=(0,c.useState)(!1),o=(0,a.A)(s,2),u=(o[0],o[1],function handleChange(e,t){e===X.as.FAIL_REASON||e===X.as.COMMENT||e===X.as.FAIL_TYPE||e===X.as.NORESULT_REASON||e===X.as.WORK_STATUS?l(e,t):r(e,t)}),i=(n.failType.items,n.failReason.items),p=n.workStatus.items;return c.createElement(c.Fragment,null,c.createElement("div",{className:"page-content"},c.createElement(C.A,{fluid:!0},c.createElement(h.A,null,c.createElement("h3",{className:"text__bold col-md-4 col-form-label"},"Результат")),c.createElement(h.A,{className:""},c.createElement(A.A,{className:"calling__result__status",sm:12},c.createElement(te,{label:"Статус Работы",nameForHandler:X.as.WORK_STATUS,handleChange:u,current:n.workStatus.current,items:p}),"fail"===(null===(t=n.workStatus.current)||void 0===t?void 0:t.code)&&c.createElement(te,{label:"Причины отказа",nameForHandler:X.as.FAIL_REASON,handleChange:u,current:n.failReason.current,items:i}))))))};var ae=n(6540);const le=(0,l.Ng)((function mapSTate(e,t){return{report:e.report.report,isNoResult:t.isNoResult}}),{setCurentCallingProp:ee,setReportProp:X.Tb.setReportProp})((function ReportContainer(e){var t=e.setCurentCallingProp,n=e.report,r=e.setReportProp;return e.isNoResult?ae.createElement(ne,{report:n,setReportProp:r}):ae.createElement(re,{report:n,setCurentCallingProp:t,setReportProp:r})}));const ce=function Menu(e){var t=e.responsibility,n=e.createdBy,r=e.date,l=e.name,s=e.type,o=e.menuType,u=(e.current,e.sale,e.report),i=e.isUnplannedPresentation,p=e.presentation,d=e.setCurentCallingProp,m=e.changeDeadline,f=e.send,b=(e.isFullComplete,e.setMenuStatus),y=(0,c.useState)(t.current),v=(0,a.A)(y,2),g=(v[0],v[1]),E=(0,c.useState)(n.current),_=(0,a.A)(E,2),S=(_[0],_[1],(0,c.useState)(!1)),T=(0,a.A)(S,2),P=(T[0],T[1],(0,c.useState)("inJob")),N=(0,a.A)(P,2),I=(N[0],N[1],(0,c.useState)("other")),D=(0,a.A)(I,2);D[0],D[1];(0,c.useEffect)((function(){g(t.current)}),[t.current]);return(0,c.useEffect)((function(){console.log("menuType"),console.log(o)}),[o]),c.createElement(c.Fragment,null,c.createElement("div",{className:"page-content"},c.createElement(C.A,{fluid:!0},c.createElement(h.A,{className:"p-0"},c.createElement(A.A,{sm:6,className:"p-0"},c.createElement(le,{isNoResult:!1})),c.createElement(A.A,{sm:6,className:"p-0"},"result"===o?c.createElement(x,{isUnplannedPresentation:i,presentation:p}):c.createElement(le,{isNoResult:!0}))),c.createElement(h.A,{className:"mt-2"},c.createElement(A.A,{sm:6}),c.createElement(A.A,{sm:6})),c.createElement(h.A,{className:"mt-2"},c.createElement(A.A,{sm:6},c.createElement("h3",{className:"bold"}," Комментарий")),c.createElement(A.A,{sm:6},c.createElement("h3",{className:"bold"}," Планирование следующего звонка"))),c.createElement(h.A,null,c.createElement(A.A,{sm:6},c.createElement(O,{handleChange:function handleChange(e,t){d(e,t)}})),u[X.as.WORK_STATUS].current&&("inJob"===u[X.as.WORK_STATUS].current.code||"setAside"===u[X.as.WORK_STATUS].current.code)&&c.createElement(A.A,{sm:6},c.createElement(R,{responsibility:t,createdBy:n,date:r,name:l,type:s,changeDeadline:m,setCurentCallingProp:d})))),c.createElement("div",{className:"calling__result__menu__footer"},c.createElement("div",{className:"calling__result__menu__buttons"},c.createElement(w.A,{size:"sm",color:"primary",onClick:f},"Отправить"),c.createElement(w.A,{size:"sm",color:"danger",onClick:function onClick(){b(!1,null)}},"Отмена")))))};var se=n(6540);const oe=function ResultMenu(e){e.isSuccess;var t=e.responsibility,n=e.createdBy,r=e.date,a=e.name,l=e.type,c=e.menuType,s=e.current,o=e.sale,u=e.isOneMore,i=e.isUnplannedPresentation,p=e.report,d=(e.isMenuActive,e.presentation),m=e.setCurentCallingProp,f=e.changeDeadline,b=e.send,y=e.isFullComplete,v=e.setMenuStatus;return se.createElement(ce,{responsibility:t,createdBy:n,date:r,name:a,type:l,menuType:c,current:s,sale:o,isOneMore:u,report:p,isUnplannedPresentation:i,presentation:d,setCurentCallingProp:m,changeDeadline:f,send:b,isFullComplete:y,setMenuStatus:v})};var plan_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},plan_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},ue=n(6540);const ie=(0,l.Ng)((function mapSTate(e){return{responsibility:e.calling.responsibility,createdBy:e.calling.createdBy,name:e.plan[G.zu.NAME],type:e.plan[G.zu.TYPE],date:e.plan[G.zu.DATE],current:{responsibility:e.calling.responsibility.current,createdBy:e.calling.createdBy.current,type:e.plan[G.zu.TYPE].current,date:e.plan[G.zu.DATE],time:e.plan[G.zu.TIME],name:e.plan[G.zu.NAME],description:e.report.comment},sale:e.calling.sale,presentation:e.presentation.presentation,isFullComplete:e.calling.isFullComplete,isUnplannedPresentation:e.presentation.isUnplannedPresentation,isFinish:e.calling.isFinish,result:e.calling.result,isMenuActive:e.result.isActive,menuType:e.result.type,report:e.report.report}}),{initialCalling:function initialCalling(e){return void 0===e&&(e=null),function(t,n){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var r,a,l,c,u,i,m,f;return calling_thunk_generator(this,(function(b){switch(b.label){case 0:return(r=e)?[3,3]:(a=p.db)?[4,d.l.getPlacement()]:[3,2];case 1:a=b.sent(),b.label=2;case 2:r=a,b.label=3;case 3:return t(s.setFinishStatus(!1,"")),l=null,r&&r.placement&&(l=r,console.log("initialCalling calling placement"),console.log(l)),c=n(),u=c.app.domain,i=c.app.currentUser,m=null,f={domain:u},[4,o.o_.service("bitrix/departament","post","departament",f)];case 4:return(m=b.sent())&&(m=[]),t(s.setFetchedDepartament(m,i,l,u)),t(Z()),r&&r.options?t(J(r)):t(s.setFullCompleteStatus(!0)),n(),[2]}}))}))}},setCurentCallingProp:ee,changeDeadline:function changeDeadline(e){return function(t,n){return plan_thunk_awaiter(void 0,void 0,void 0,(function(){return plan_thunk_generator(this,(function(r){return n(),t(W(G.zu.DATE,e)),[2]}))}))}},setFinishStatus:s.setFinishStatus,setMenuStatus:v,send:function send(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,o,u,p,d,f,b,v,g,E,_,S,h,A,T,C,w,N;return calling_thunk_generator(this,(function(O){switch(O.label){case 0:return n=t(),r=n.postSale,a=r.questionStatus,!r.isSaleComplete||a?[3,1]:(e(Q(!0)),[3,3]);case 1:return l=n.app.domain,c=n.calling,s=n.report,o=n.plan,u=c[P.u$.RESPONSIBILITY].current,p=c[P.u$.CREATED_BY].current,d=o[G.zu.TYPE].current,f=o[G.zu.NAME],b=o[G.zu.DATE],v=(0,i.GP)(new Date(b),"dd.MM.yyyy HH:mm:ss"),g={responsibility:u,createdBy:p,type:d,name:f,deadline:v},E=s.report[X.as.COMMENT],_=s.report[X.as.WORK_STATUS].current,S=s.report[X.as.NORESULT_REASON].current,h=s.report[X.as.FAIL_TYPE].current,A=s.report[X.as.FAIL_REASON].current,T={description:E,workStatus:_,noresultReason:S,failType:h,failReason:A},e((0,V.Z)(!0)),e(Q(!1)),C=c.placement,console.log("callingState.placement"),console.log(C),w={domain:l,plan:g,report:T,placement:C},console.log("sending data"),console.log(w),[4,z.service("full",m.b.POST,"result",w)];case 2:N=O.sent(),console.log(N),e((0,V.Z)(!1)),e(y(!1,null)),O.label=3;case 3:return[2]}}))}))}}})((function ResultMenuContainer(e){var t=e.domain,n=e.responsibility,r=e.createdBy,l=e.name,s=e.type,o=e.date,u=e.menuType,i=e.current,p=e.sale,d=e.presentation,m=e.setCurentCallingProp,f=e.initialCalling,b=(e.getCallingPlan,e.changeDeadline),y=e.isFullComplete,v=e.isFinish,g=(e.result,e.isOneMore),E=e.isUnplannedPresentation,_=e.isMenuActive,S=e.report,h=(e.setFinishStatus,e.setMenuStatus),A=e.send,T=(0,c.useState)(!1),C=(0,a.A)(T,2),w=C[0],P=C[1],N=(0,c.useState)(v),O=(0,a.A)(N,2),I=O[0],x=O[1];return(0,c.useEffect)((function(){w||I||(f(),P(!0))}),[w,I]),(0,c.useEffect)((function(){v&&P(!1),x(v)}),[v]),_&&ue.createElement(oe,{success:!0,domain:t,currentUser:n,responsibility:n,createdBy:r,date:o,name:l,type:s,menuType:u,current:i,sale:p,isOneMore:g,isUnplannedPresentation:E,isMenuActive:_,report:S,presentation:d,setCurentCallingProp:m,changeDeadline:b,send:A,isFullComplete:y,setMenuStatus:h})}));const pe=function CallingList(e){var t=e.tasks,n=e.setResultMenuStatus;return c.createElement(c.Fragment,null,c.createElement(h.A,null,c.createElement(A.A,{xl:12},c.createElement("div",{className:"table-responsive p-4 calling__page__wrapper"},c.createElement("div",{className:"table-responsive"},c.createElement(T.A,{className:"align-middle mb-0"},c.createElement("thead",null,c.createElement("tr",null,c.createElement("th",null,"#"),c.createElement("th",null,"Что надо сделать"),c.createElement("th",null,"Тип"),c.createElement("th",null,"Крайний срок"),c.createElement("th",null,"Текущий статус"),c.createElement("th",null,"Действие"))),c.createElement("tbody",null,t&&t.length&&t.map((function(e,t){return c.createElement("tr",null,c.createElement("th",{scope:"row"},t+1),c.createElement("td",null,e.name),c.createElement("td",null,e.type),c.createElement("td",null,e.deadline),c.createElement("td",null,"no"===e.isExpired?c.createElement("span",{className:"statusSuccess"},"Запланирован"):"yes"===e.isExpired?c.createElement("span",{className:"statusWarning"},"Просрочен"):c.createElement("span",{className:"statusExpired"},"Скоро")),c.createElement("td",null,c.createElement("div",{className:"actionsCell"},c.createElement("button",{type:"button",className:"btn btn-sm  mr-5 badge__star",onClick:function onClick(){return n(!0,"result")}},"Результативный"),c.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__error",onClick:function onClick(){return n(!0,"noresult")}},"Не очень"),c.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__tolong",onClick:function onClick(){return n(!0,"expired")}},"Перенос"),c.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__cancel",onClick:function onClick(){return n(!0,"cancel")}},"Не считать"))))})))))))))};const de=function CallingFinish(e){var t=e.result,n=e.setFinishStatus;return c.createElement(c.Fragment,null,c.createElement("div",{className:"account-pages my-5 pt-2"},c.createElement(C.A,null,c.createElement(h.A,null,c.createElement(A.A,{lg:"12"},c.createElement("div",{className:"text-center mb-2"},c.createElement("h1",{className:"display-2 fw-medium"},c.createElement("i",{className:"bx bx-buoy bx-spin text-primary display-3"})),c.createElement("h4",{className:"text-uppercase"},t),c.createElement("div",{className:"mt-3 \r d-flex\r justify-content-center\r align-items-center\r "},c.createElement(w.A,{onClick:function startHendler(){n(!1,"")},className:"btn\r col-md-3\r calling-button\r d-flex justify-content-center\r bg-success\r pointer\r ",size:"sm"},"Запланировать еще"))))),c.createElement(h.A,{className:"justify-content-center"},c.createElement(A.A,{md:"8",xl:"6"})))))};var me=n(6540);const fe=(0,l.Ng)((function mapSTate(e){return{domain:e.app.domain,currentUser:e.app.currentUser,responsibility:e.calling.responsibility,tasks:e.tasks.tasks,isMenuActive:e.result.isActive,isFinish:e.calling.isFinish,result:e.calling.result}}),{initialCallingReport:function initialCallingReport(){return function(e,t){return report_thunk_awaiter(void 0,void 0,void 0,(function(){var n,a,l,c,s,u,i,f,b,y;return report_thunk_generator(this,(function(v){switch(v.label){case 0:return n=t(),console.log("initialCallingReport"),console.log(n),a=n.app.domain,l=n.app.currentUser,(s=p.db)?[4,d.l.getPlacement()]:[3,2];case 1:s=v.sent(),v.label=2;case 2:return c=s,u={domain:a||p.Ss,userId:l||p.wV,placement:c||{placement:"COMPANY",options:{ID:p.pY}}},console.log("placement",c),[4,o.o_.service("bitrix/callingreport",m.b.POST,"tasks",u)];case 3:return i=v.sent(),f={domain:a||p.Ss,userId:l||p.wV},[4,o.o_.service("front/portal",m.b.POST,"portal",f)];case 4:return b=v.sent(),p.db&&b&&e(function getHistory(e){return function(t,n){return __awaiter(void 0,void 0,void 0,(function(){var t,n,a;return __generator(this,(function(l){switch(l.label){case 0:return e?(null==(t=e.bitrixLists.find((function(e){return e.group==r.SALES&&"history"==e.type})))||t.bitrixfields,n={IBLOCK_TYPE_ID:"lists",IBLOCK_ID:null==t?void 0:t.bitrixId},[4,d.l.getMethod("lists.element.get",n)]):[3,2];case 1:a=l.sent(),console.log("items"),console.log(a),l.label=2;case 2:return[2]}}))}))}}(b)),i&&i.length&&(y=i.map((function(e){var t=_(e.title),n=t.type;return{name:t.name,type:n,isExpired:E(e),deadline:S(e.deadline)}})),e(g.l1.setFetchedTasks(y))),t(),[2]}}))}))}},setFinishStatus:s.setFinishStatus,setResultMenuStatus:v})((function CallingListContainer(e){var t=e.domain,n=e.responsibility,r=e.isFinish,l=e.result,s=e.setFinishStatus,o=e.isMenuActive,u=e.tasks,i=e.initialCallingReport,p=e.setResultMenuStatus,d=(0,c.useState)(!1),m=(0,a.A)(d,2),f=m[0],b=m[1],y=(0,c.useState)(r),v=(0,a.A)(y,2),g=v[0],E=v[1];return(0,c.useEffect)((function(){f||g||(i(),b(!0))}),[f,g]),(0,c.useEffect)((function(){r&&b(!1),E(r)}),[r]),g?me.createElement(de,{result:l,setFinishStatus:s}):f&&me.createElement(me.Fragment,null,o?me.createElement(ie,null):me.createElement(pe,{domain:t,responsibility:n,tasks:u,setResultMenuStatus:p}))}))},6750:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(6540),a=n(6229);const l=function Logo(){return r.createElement("img",{className:"logo",src:a,alt:"logo"})};n(4003),n(9245);var c=n(6540);const s=function Gradient(e){e.isResized;var t=e.isActive,n=(e.currentRoute,(0,r.useRef)(null));return(0,r.useEffect)((function(){}),[]),c.createElement("div",{ref:n,className:"monohrom__containerApril"},c.createElement("div",{className:"content__wrapper"},c.createElement("div",{className:"newchildren__wrapper"},c.createElement(l,null)),t&&c.createElement("p",{className:"loader__title"},"Загрузка  . . .")))};const o=(0,n(9733).Ng)((function mapStateToProps(e,t){return{isResized:e.app.isResized,isActive:t.isActive}}),{})(s);var u=n(6540);const i=function Preloader(e){var t=e.currentRoute;return u.createElement(o,{currentRoute:t,isActive:!0},u.createElement(l,null))}},6745:(e,t,n)=>{n.d(t,{Ay:()=>w,Fc:()=>T,Vh:()=>A});var r=n(4705),a=n(467),l=n(4756),c=n.n(l),s=n(4003),o=n(9002),u=n(8205),i=n(8329),p=n(9245),d=n(1715);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m="SET_APP_DEAL",f="SET_RESIZE_STATUS",b="SET_APP_DATA",y="SET_APP_BITRIX_DATA",v="SET_INITIALIZED_SUCCESS",g={domain:"",company:null,user:"",currentUser:null,token:"",dealId:null,bitrix:{company:null,deal:null,lead:null},isResized:!1,initialized:!1},E=function setAppData(e,t,n,r,a,l){return{type:b,domain:e,companyId:t,userId:n,currentUser:r,token:a,dealId:l}},_=function setAppBitrixData(e,t){return{type:y,company:e,deal:t}},S=function setResizeStatus(e){return{type:f,boolean:e}},h=function setInitializedSuccess(){return{type:v}},A=function initial(){return function(){var e=(0,a.A)(c().mark((function _callee(e,t){var n,r,a,l,o;return c().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e((0,i.Z)(!0)),n=t(),r=n.router.current,null,null,u.db&&r.route===p.a$.CALLING&&e(C()),!u.db){c.next=12;break}return c.next=9,s.l.getDomain();case 9:c.t0=c.sent,c.next=13;break;case 12:c.t0=null;case 13:if(a=c.t0,l=a||u.Ss,!r||!r.route){c.next=30;break}if(r.route!==p.a$.CALLING){c.next=27;break}if(c.t1=u.db,!c.t1){c.next=22;break}return c.next=21,s.l.getCurrentUser();case 21:c.t1=c.sent;case 22:o=c.t1,e(E(l,null,null,o,"",null)),e(h()),c.next=30;break;case 27:e(E(l,null,null,null,"",null)),e(h()),e((0,i.Z)(!1));case 30:e((0,p._t)(p.xY.CALLING,!1)),e((0,i.Z)(!1));case 32:case"end":return c.stop()}}),_callee)})));return function(t,n){return e.apply(this,arguments)}}()},T=function getBitrixData(e,t,n,r,l,i,m){return function(){var f=(0,a.A)(c().mark((function _callee2(a,f){var b,y,v,g,S,h,A,T;return c().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:if(null,null,b={currentCompany:null,currentDeal:null},y=null,v=null,g=!1,!u.db){c.next=12;break}return c.next=9,s.l.getDealAndCompany(i,l);case 9:b=c.sent,c.next=22;break;case 12:if(!l){c.next=17;break}return S={domain:t,companyId:l},c.next=16,o.o_.service("bitrixcompany",d.b.POST,"company",S);case 16:b.currentCompany=c.sent;case 17:if(!i){c.next=22;break}return h={domain:t,dealId:i},c.next=21,o.o_.service("bitrixdeal",d.b.POST,"deal",h);case 21:b.currentCompany=c.sent;case 22:A=b.company,T=b.deal,A&&A.ID&&(y=A.ID),T&&T.ID&&(v=T.ID),a(E(t,y,r,n,m,v)),a(_(A,T)),a((0,p._t)(e,g));case 29:case"end":return c.stop()}}),_callee2)})));return function(e,t){return f.apply(this,arguments)}}()},C=function getResizeCalling(){return function(){var e=(0,a.A)(c().mark((function _callee5(e,t){return c().wrap((function _callee5$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.l.getResizeCalling();case 2:e(S(!0));case 3:case"end":return t.stop()}}),_callee5)})));return function(t,n){return e.apply(this,arguments)}}()};const w=function app(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return _objectSpread(_objectSpread({},e),{},{domain:t.domain,company:t.companyId,user:t.userId,token:t.token,dealId:t.dealId,currentUser:t.currentUser});case y:return _objectSpread(_objectSpread({},e),{},{bitrix:_objectSpread(_objectSpread({},e.bitrix),{},{company:t.company,deal:t.deal}),initialized:!0});case m:return _objectSpread(_objectSpread({},e),{},{dealId:t.dealId,bitrix:_objectSpread(_objectSpread({},e.bitrix),{},{deal:t.deal})});case f:return _objectSpread(_objectSpread({},e),{},{isResized:t.status});case v:return _objectSpread(_objectSpread({},e),{},{initialized:!0});default:return e}}},8329:(e,t,n)=>{n.d(t,{A:()=>s,Z:()=>c});var r=n(4705);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a={inProgress:!0},l="PRELOADER",c=function setPreloader(e){return{type:l,bool:e}};const s=function preloader(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;return t.type===l&&e.inProgress!==t.bool?_objectSpread(_objectSpread({},e),{},{inProgress:t.bool}):e}},9002:(e,t,n)=>{n.d(t,{o_:()=>h});var r=n(467),a=n(4705),l=n(4756),c=n.n(l),s=n(8205),o=n(1715),u=n(6266);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i=u.A.create({baseURL:s.R4?"http://localhost:8000/api":"https://april-online.ru/api",withCredentials:!0,headers:(0,a.A)((0,a.A)((0,a.A)({"content-type":"application/json",accept:"application/json"},"accept","application/json"),"X-Requested-With","XMLHttpRequest"),"X-API-KEY","e0336d3b27299e405a344d2475627c5810eab829a4e5c1214e452e20519d5984")});u.A.create({baseURL:s.R4?"http://localhost:8000":"https://april-online.ru",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}});y=(0,r.A)(c().mark((function _callee3(){var e,t,n;return c().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return e=null,r.prev=1,r.next=4,i.get("profile");case 4:return t=r.sent,(n=t.data)&&(0===n.resultCode?e=n.deal:n.message),r.abrupt("return",e);case 10:return r.prev=10,r.t0=r.catch(1),r.abrupt("return",e);case 13:case"end":return r.stop()}}),_callee3,null,[[1,10]])}))),b=(0,r.A)(c().mark((function _callee4(e){var t,n;return c().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.prev=1,r.next=4,i.post("deal",_objectSpread({},e));case 4:return(n=r.sent)&&(0===n.resultCode?t=n.deal:n.message),r.abrupt("return",t);case 9:return r.prev=9,r.t0=r.catch(1),r.abrupt("return",t);case 12:case"end":return r.stop()}}),_callee4,null,[[1,9]])}))),f=(0,r.A)(c().mark((function _callee5(e,t){var n,r,a;return c().wrap((function _callee5$(l){for(;;)switch(l.prev=l.next){case 0:return n=null,l.prev=1,l.next=4,i.post("getDeal",{dealId:e,domain:t});case 4:return r=l.sent,(a=r.data)&&0===a.resultCode&&(n=a.deal),l.abrupt("return",n);case 10:return l.prev=10,l.t0=l.catch(1),l.abrupt("return",n);case 13:case"end":return l.stop()}}),_callee5,null,[[1,10]])}))),m=(0,r.A)(c().mark((function _callee6(e,t,n,r,a){var l,s,o,u;return c().wrap((function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:return l=null,c.prev=1,c.next=4,i.post("getDescription",{domain:e,userId:t,complect:n,infoblocks:r,groups:a});case 4:if(!(s=c.sent)||!s.data||0!==s.data.resultCode){c.next=9;break}return o=s.data.file,u=s.data.fileBase64,c.abrupt("return",{link:o,file:u});case 9:c.next=14;break;case 11:return c.prev=11,c.t0=c.catch(1),c.abrupt("return",l);case 14:case"end":return c.stop()}}),_callee6,null,[[1,11]])}))),d=(0,r.A)(c().mark((function _callee7(e,t,n,r,a){var l,s;return c().wrap((function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:return l=null,c.prev=1,c.next=4,i.post("get/offer",{domain:e,userId:t,complect:n,infoblocks:r,groups:a});case 4:(s=c.sent)&&s.data&&s.data.resultCode,c.next=11;break;case 8:return c.prev=8,c.t0=c.catch(1),c.abrupt("return",l);case 11:case"end":return c.stop()}}),_callee7,null,[[1,8]])}))),p=(0,r.A)(c().mark((function _callee8(e,t,n){var r,a;return c().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,i.post("get/offer",{domain:e,userId:t,complect,infoblocks,groups});case 4:(a=n.sent)&&a.data&&a.data.resultCode,n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",r);case 11:case"end":return n.stop()}}),_callee8,null,[[1,8]])})));var p,d,m,f,b,y,v,g,E,_,S,h={getCollection:(E=(0,r.A)(c().mark((function _callee9(e,t,n,r){var a,l;return c().wrap((function _callee9$(c){for(;;)switch(c.prev=c.next){case 0:if(a=null,c.prev=1,r){c.next=8;break}return c.next=5,i[t](e);case 5:c.t0=c.sent,c.next=11;break;case 8:return c.next=10,i[t](e,r);case 10:c.t0=c.sent;case 11:if(!(l=c.t0)){c.next=15;break}return l.data&&0===l.data.resultCode&&l.data[n]&&(a=l.data.isCollection?l.data[n].data:l.data[n]),c.abrupt("return",a);case 15:c.next=20;break;case 17:return c.prev=17,c.t1=c.catch(1),c.abrupt("return",a);case 20:case"end":return c.stop()}}),_callee9,null,[[1,17]])}))),function getCollection(e,t,n,r){return E.apply(this,arguments)}),setCollection:(g=(0,r.A)(c().mark((function _callee10(e,t){var n,r,l;return c().wrap((function _callee10$(c){for(;;)switch(c.prev=c.next){case 0:return n=null,c.prev=1,r=(0,a.A)({},e,t),c.next=5,i.post(e,r);case 5:return(l=c.sent)&&0===l.data.resultCode&&(n=l.data.data),c.abrupt("return",n);case 10:return c.prev=10,c.t0=c.catch(1),c.abrupt("return",n);case 13:case"end":return c.stop()}}),_callee10,null,[[1,10]])}))),function setCollection(e,t){return g.apply(this,arguments)}),service:(v=(0,r.A)(c().mark((function _callee11(e,t,n,r){var a,l;return c().wrap((function _callee11$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,i[t](e,r);case 4:return(l=c.sent)&&l.data&&(0===l.data.resultCode?a=l.data.data?l.data.data[n]:l.data[n]:1===l.data.resultCode&&(l.data.message?console.log("".concat(n," ").concat(l.data.message)):console.log(l))),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee11,null,[[1,9]])}))),function service(e,t,n,r){return v.apply(this,arguments)})},A=(_=(0,r.A)(c().mark((function _callee12(e,t,n,r,l,s,u,p,d,m,f,b,y,v,g,E,_,S){var h,A,T,C,w,P,N,O,I,x,R,D;return c().wrap((function _callee12$(c){for(;;)switch(c.prev=c.next){case 0:return T=null,C={FIELDS:(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},v.dealName.bitrixId,"".concat(t)),v.assigned.bitrixId,n),v.category.bitrixId,v.category.value),v.stage.bitrixId,v.stage.value),v.opened.bitrixId,v.opened.value),"PROBABILITY",30),"OPPORTUNITY",0),"CURRENCY_ID","RUB"),"UF_CRM_5B39D7C2EC0AB",!0),PARAMS:{REGISTER_SONET_EVENT:"Y"}},w=isNaN(+E.contractSupplyPropSuppliesQuantity)?1:+E.contractSupplyPropSuppliesQuantity,P=_?_.contractConsaltingProp:E.contractConsaltingProp,N=_?_.contractConsaltingComment:E.contractConsaltingComment,O={id:r,fields:(h={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(h,y.contract.bitrixId,l),y.companyId.bitrixId,s),y.npa.bitrixId,u.npa),y.la.bitrixId,u.la),y.c.bitrixId,u.c),y.sp.bitrixId,u.sp),y.er.bitrixId,p.er),y.per.bitrixId,p.per),y.erinpac.bitrixId,p.erinpac),y.lt.bitrixId,m.lt),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(h,y.plt.bitrixId,m.plt),y.ltinpac.bitrixId,m.ltinpac),y.freeBlocks.bitrixId,d),y.consalting.bitrixId,f),y.field_14.bitrixId,b),v.category.bitrixId,v.category.value),v.stage.bitrixId,"C".concat(v.category.value,":NEW"))),PARAMS:{REGISTER_SONET_EVENT:"Y"}},I={id:r,fields:(A={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(A,g.complectName.bitrixId,E.name),g.abonementTime.bitrixId,1===E.contractCoefficient?null:E.contractCoefficient),g.consalting.bitrixId,P),g.note2.bitrixId,N),g.hdd.bitrixId,E.contractSupplyProp1?E.contractSupplyProp1:""),g.way.bitrixId,E.contractSupplyProp2?E.contractSupplyProp2:""),g.note.bitrixId,E.contractSupplyPropComment?E.contractSupplyPropComment:""),g.note3.bitrixId,E.contractSupplyPropEmail?E.contractSupplyPropEmail:""),g.supply.bitrixId,E.supplyName?E.supplyName:""),g.supplyForContract.bitrixId,E.contractSupplyName?E.contractSupplyName:""),(0,a.A)((0,a.A)((0,a.A)((0,a.A)(A,g.loginsQuantity.bitrixId,E.contractSupplyPropLoginsQuantity?E.contractSupplyPropLoginsQuantity:""),g.contractSupplyPropSuppliesQuantity.bitrixId,w),g.supplyForContract.bitrixId,E.contractSupplyName),g.field_1.bitrixId,E.quantityForKp))},x=S.map((function(e,t){var n=e.prepayment,a=e.price.current,l=e.price.default,c=l-a;return{id:e.id||e.number,priceNetto:l,price:a,discountSum:c,discountTypeId:1,ownerId:r,ownerType:"D",productName:"".concat(e.name," ").concat(e.supply.name),quantity:e.price.quantity||n,customized:"Y",supply:e.supplyName,measureCode:e.price.measure.code,measureId:e.price.measure.id,sort:t}})),R={domain:e,dealId:r,setDealData:C,updateDealInfoblocksData:O,updateDealContractData:I,setProductRowsData:{ownerType:"D",ownerId:r,productRows:x},updateProductRowsData:{id:null,fields:{priceNetto:null,price:null,discountSum:null,discountTypeId:1}}},c.prev=11,c.next=14,i[o.b.POST]("konstructor/bitrix/deal/update",R);case 14:return(D=c.sent)&&D.data&&(0===D.data.resultCode?D.data.data&&(T=D.data.data.dealId):1===D.data.resultCode&&(D.data.message?console.log("".concat(D.data.message)):console.log(D))),c.abrupt("return",T);case 19:return c.prev=19,c.t0=c.catch(11),c.abrupt("return",T);case 22:case"end":return c.stop()}}),_callee12,null,[[11,19]])}))),u.A.create({baseURL:"http://localhost:8000/api",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}}));S=(0,r.A)(c().mark((function _callee13(e,t,n,r){var a,l;return c().wrap((function _callee13$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,A[t](e,r);case 4:return(l=c.sent)&&l.data&&(0===l.data.resultCode?a=l.data.data?l.data.data[n]:l.data[n]:1===l.data.resultCode&&(l.data.message?console.log("".concat(n," ").concat(l.data.message)):console.log(l))),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee13,null,[[1,9]])})))},4003:(e,t,n)=>{n.d(t,{l:()=>A});var r=n(467),a=n(4705),l=n(4756),c=n.n(l),s=n(3953);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var o,u,i,p,d,m,f,b,y,v,g,E,_,S,h,A={getMethod:(h=(0,r.A)(c().mark((function _callee(e,t){var n,r;return c().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return n=null,a.prev=1,a.next=4,s.g9(e,t);case 4:return(r=a.sent)&&r.answer&&r.answer.result&&(n=r.answer.result),a.abrupt("return",n);case 9:return a.prev=9,a.t0=a.catch(1),console.log("error"),console.log(dealResponse),console.log(a.t0),a.abrupt("return",n);case 15:case"end":return a.stop()}}),_callee,null,[[1,9]])}))),function getMethod(e,t){return h.apply(this,arguments)}),getPlacement:(S=(0,r.A)(c().mark((function _callee2(){var e;return c().wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.ot.info();case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),_callee2)}))),function getPlacement(){return S.apply(this,arguments)}),getCompanyId:(_=(0,r.A)(c().mark((function _callee3(){var e,t;return c().wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,A.getPlacement();case 3:return e=n.sent,t=e.options.ID,n.abrupt("return",Number(t));case 8:return n.prev=8,n.t0=n.catch(0),n.abrupt("return",null);case 11:case"end":return n.stop()}}),_callee3,null,[[0,8]])}))),function getCompanyId(){return _.apply(this,arguments)}),getCurrentUserId:(E=(0,r.A)(c().mark((function _callee4(e){var t,n;return c().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.next=3,(0,s.g9)("crm.company.get",{id:e});case 3:return n=(n=r.sent).answer&&n.answer.result,t=n?n.ASSIGNED_BY_ID:null,r.abrupt("return",t);case 7:case"end":return r.stop()}}),_callee4)}))),function getCurrentUserId(e){return E.apply(this,arguments)}),getCurrentUser:(g=(0,r.A)(c().mark((function _callee5(){var e,t;return c().wrap((function _callee5$(n){for(;;)switch(n.prev=n.next){case 0:return e=null,n.prev=1,n.next=4,(0,s.g9)("user.current");case 4:return(t=n.sent)&&t.answer&&t.answer.result&&t.answer.result.ID&&(e=t.answer.result),n.abrupt("return",e);case 9:return n.prev=9,n.t0=n.catch(1),console.log(n.t0),n.abrupt("return",null);case 13:case"end":return n.stop()}}),_callee5,null,[[1,9]])}))),function getCurrentUser(){return g.apply(this,arguments)}),getResize:(v=(0,r.A)(c().mark((function _callee6(){var e,t;return c().wrap((function _callee6$(n){for(;;)switch(n.prev=n.next){case 0:return e=.9*window.screen.height,t=.73*window.screen.width,n.next=5,(0,s.Ru)(t,e);case 5:n.sent;case 6:case"end":return n.stop()}}),_callee6)}))),function getResize(){return v.apply(this,arguments)}),getResizeCalling:(y=(0,r.A)(c().mark((function _callee7(){return c().wrap((function _callee7$(e){for(;;)switch(e.prev=e.next){case 0:return window.screen.height,window.screen.width,e.next=5,(0,s.eQ)();case 5:e.sent;case 6:case"end":return e.stop()}}),_callee7)}))),function getResizeCalling(){return y.apply(this,arguments)}),getScroll:(b=(0,r.A)(c().mark((function _callee8(){var e,t;return c().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("scroll"),n.next=4,(0,s.TC)();case 4:return e=n.sent,console.log(e),n.next=8,(0,s.OO)(100);case 8:t=n.sent,console.log(t),n.next=14;break;case 12:n.prev=12,n.t0=n.catch(0);case 14:case"end":return n.stop()}}),_callee8,null,[[0,12]])}))),function getScroll(){return b.apply(this,arguments)}),getLead:(f=(0,r.A)(c().mark((function _callee9(e){var t,n;return c().wrap((function _callee9$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,console.log("crm.lead.get"),r.prev=2,r.next=5,s.g9("crm.lead.get",{id:e});case 5:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result,console.log(t)),r.abrupt("return",t);case 10:return r.prev=10,r.t0=r.catch(2),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 16:case"end":return r.stop()}}),_callee9,null,[[2,10]])}))),function getLead(e){return f.apply(this,arguments)}),getCompany:(m=(0,r.A)(c().mark((function _callee10(e){var t,n;return c().wrap((function _callee10$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,console.log("crm.company.get"),r.prev=2,r.next=5,s.g9("crm.company.get",{id:e,select:["TITLE","ID","UF_CRM_1706007840","UF_CRM_1706007882","UF_CRM_1706007856"]});case 5:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result,console.log(t)),r.abrupt("return",t);case 10:return r.prev=10,r.t0=r.catch(2),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 16:case"end":return r.stop()}}),_callee10,null,[[2,10]])}))),function getCompany(e){return m.apply(this,arguments)}),getDeal:(d=(0,r.A)(c().mark((function _callee11(e){var t,n;return c().wrap((function _callee11$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.prev=1,r.next=4,s.g9("crm.deal.get",{id:e,select:["TITLE","COMPANY_ID","ID","UF_CRM_1695372881","UF_CRM_1695373462","UF_CRM_1695373326"]});case 4:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result),r.abrupt("return",t);case 9:return r.prev=9,r.t0=r.catch(1),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 15:case"end":return r.stop()}}),_callee11,null,[[1,9]])}))),function getDeal(e){return d.apply(this,arguments)}),getDealAndCompany:(p=(0,r.A)(c().mark((function _callee12(){var e,t,n,r,a=arguments;return c().wrap((function _callee12$(l){for(;;)switch(l.prev=l.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:null,t=a.length>1&&void 0!==a[1]?a[1]:null,l.prev=2,n=null,r=null,t||!e){l.next=16;break}return l.next=8,A.getDeal(e);case 8:if(!(n=l.sent)||!n.COMPANY_ID){l.next=14;break}return t=n.COMPANY_ID,l.next=13,A.getCompany(t);case 13:r=l.sent;case 14:l.next=21;break;case 16:if(!t||e){l.next=21;break}return l.next=19,A.getCompany(t);case 19:r=l.sent,n&&n.COMPANY_ID&&(t=n.COMPANY_ID);case 21:return l.abrupt("return",{company:r,deal:n});case 24:return l.prev=24,l.t0=l.catch(2),console.error("Произошла ошибка при выполнении запроса",l.t0),l.abrupt("return",{company:null,deal:null});case 28:case"end":return l.stop()}}),_callee12,null,[[2,24]])}))),function getDealAndCompany(){return p.apply(this,arguments)}),getSmart:(i=(0,r.A)(c().mark((function _callee13(e){var t,n;return c().wrap((function _callee13$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,$method="/crm.item.list.json",$data={entityTypeId:e,filter:{"=assignedById":$userId,COMPANY_ID:$companyId}},r.prev=3,r.next=6,s.g9("crm.item.list",{id:dealId});case 6:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result.items),r.abrupt("return",t);case 11:return r.prev=11,r.t0=r.catch(3),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 17:case"end":return r.stop()}}),_callee13,null,[[3,11]])}))),function getSmart(e){return i.apply(this,arguments)}),getDomain:(u=(0,r.A)(c().mark((function _callee14(){var e;return c().wrap((function _callee14$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.xI();case 2:return t.sent,t.next=5,s.FB();case 5:return e=t.sent,t.abrupt("return",e);case 7:case"end":return t.stop()}}),_callee14)}))),function getDomain(){return u.apply(this,arguments)}),updateRecipient:(o=(0,r.A)(c().mark((function _callee15(e,t,n,r,a){var l,o,u,i,p,d,m,f,b;return c().wrap((function _callee15$(c){for(;;)switch(c.prev=c.next){case 0:if(!e&&!t){c.next=28;break}if(!(n||r||a)){c.next=28;break}return l={},o={},n&&(l.UF_CRM_1706007840=n,o.UF_CRM_1695372881=n),r&&(l.UF_CRM_1706007856=r,o.UF_CRM_1695373326=r),a&&(l.UF_CRM_1706007882=a,o.UF_CRM_1695373462=a),u={ID:e,FIELDS:_objectSpread({},o),PARAMS:{REGISTER_SONET_EVENT:"Y"}},i={ID:t,FIELDS:_objectSpread({},l),PARAMS:{REGISTER_SONET_EVENT:"Y"}},p="crm.company.update",d=null,m=null,c.prev=13,c.next=16,s.g9("crm.deal.update",_objectSpread({},u));case 16:return f=c.sent,c.next=19,s.g9(p,_objectSpread({},i));case 19:return b=c.sent,d=f.answer&&f.answer.result,m=b.answer&&b.answer.result,c.abrupt("return",{deal:d,company:m});case 25:return c.prev=25,c.t0=c.catch(13),c.abrupt("return",d);case 28:case"end":return c.stop()}}),_callee15,null,[[13,25]])}))),function updateRecipient(e,t,n,r,a){return o.apply(this,arguments)})}},2056:(e,t,n)=>{n.d(t,{Ay:()=>o,u$:()=>l,u7:()=>c});var r,a,l,c,__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.COLD="cold",e.WARM="warm",e.PRESENTATION="presentation",e.HOT="hot",e.PAY="moneyAwait"}(a||(a={})),function(e){e.RESPONSIBILITY="responsibility",e.CREATED_BY="createdBy",e.STATUS="status",e.CRM="crm",e.PLAN="plan",e.COMPANY="company",e.LEAD="lead",e.SMART="smart"}(l||(l={})),function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(c||(c={}));var s=((r={})[l.RESPONSIBILITY]={items:[],current:null},r[l.CREATED_BY]={items:[],current:null},r.placement=null,r.groupId=28,r.company=null,r.smart=null,r.isFullComplete=!1,r.isFinish=!1,r.result="",r);const o=function calling(e,t){var n,r,a;switch(void 0===e&&(e=s),t.type){case"callings/SET_FITCHED_CALLINGS":return __assign(__assign({},e),{calling:t.callings});case"callings/SET_FITCHED_DEPARTAMENT":var c=t.currentUser,o=107;return"alfacentr.bitrix24.ru"===t.domain&&(o=158),console.log("SET_FITCHED_DEPARTAMENT"),console.log({responsibility:__assign(__assign({},e.responsibility),{items:t.departament,current:c}),createdBy:__assign(__assign({},e.createdBy),{items:t.departament,current:{ID:o}}),placement:t.placement}),__assign(__assign({},e),{responsibility:__assign(__assign({},e.responsibility),{items:t.departament,current:c}),createdBy:__assign(__assign({},e.createdBy),{items:t.departament,current:{ID:o}}),placement:t.placement});case"callings/SET_STATE_PROP":switch(t.name){case l.RESPONSIBILITY:case l.CREATED_BY:return __assign(__assign({},e),((n={})[t.name]=__assign(__assign({},e[t.name]),{current:t.value}),n));default:return __assign(__assign({},e),((r={})[t.name]=t.value,r))}case"callings/SET_FULL_COMPLETE_STATUS":return __assign(__assign({},e),{isFullComplete:t.status});case"callings/SET_FINISH_STATUS":return(a={})[l.RESPONSIBILITY]={items:[],current:null},a[l.CREATED_BY]={items:[],current:null},a.placement=null,a.groupId=28,a.company=null,a.smart=null,a.isFullComplete=!1,a.isFinish=t.status,a.result=t.result,a;default:return e}}},2872:(e,t,n)=>{n.d(t,{Ay:()=>i,zu:()=>l});var r,a,l,c=n(291),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.COLD="cold",e.WARM="warm",e.PRESENTATION="presentation",e.HOT="hot",e.PAY="moneyAwait"}(a||(a={})),function(e){e.NAME="name",e.RESPONSIBILITY="responsibility",e.CREATED_BY="createdBy",e.DATE="date",e.TIME="time",e.TYPE="type",e.STATUS="status",e.IS_ONE_MORE="isOneMore"}(l||(l={}));var s=function getInitialDate(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);return{first:(0,c.GP)(t,"yyyy-MM-dd"),current:(0,c.GP)(e,"yyyy-MM-dd HH:mm:ss")}},o=[{id:1,name:a.WARM,title:"Звонок"},{id:2,name:a.PRESENTATION,title:"Презентация"},{id:3,name:a.HOT,title:"Решение"},{id:4,name:a.PAY,title:"Оплата"}],u=((r={})[l.TYPE]={items:o,current:o[0]},r[l.NAME]="",r[l.DATE]=s().current,r[l.TIME]=null,r);const i=function plan(e,t){var n,r,a;switch(void 0===e&&(e=u),t.type){case"callings/plan/SET_STATE_PROP":return t.name===l.TYPE?__assign(__assign({},e),((n={})[t.name]=__assign(__assign({},e[t.name]),{current:t.value}),n)):__assign(__assign({},e),((r={})[t.name]=t.value,r));case"callings/plan/SET_FINISH_STATUS":return(a={})[l.TYPE]={items:o,current:o[0]},a.name="",a.date=s().current,a.time=null,a;default:return e}}},4850:(e,t,n)=>{n.d(t,{Ay:()=>s,Tb:()=>c,as:()=>a});var r,a,__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.WORK_STATUS="workStatus",e.NORESULT_REASON="noresultReason",e.FAIL_TYPE="failType",e.FAIL_REASON="failReason",e.COMMENT="comment"}(a||(a={}));var l={isNewEvent:!1,report:(r={},r[a.WORK_STATUS]={items:[{id:0,code:"inJob",name:"В работе"},{id:1,code:"setAside",name:"Отложено"},{id:2,code:"success",name:"Продажа"},{id:3,code:"fail",name:"Отказ"}],current:{id:0,code:"inJob",name:"В работе"},default:{id:0,code:"inJob",name:"В работе"}},r[a.NORESULT_REASON]={items:[{id:0,code:"secretar",name:"Секретарь"},{id:1,code:"nopickup",name:"Недозвон - трубку не берут"},{id:2,code:"nonumber",name:"Недозвон - номер не существует"},{id:3,code:"busy",name:"Занято"},{id:4,code:"notime",name:"Перенос - не было времени"},{id:5,code:"nocontact",name:"Контактера нет на месте"},{id:6,code:"giveup",name:"Просят оставить свой номер"},{id:7,code:"bay",name:"Не интересует, до свидания"},{id:8,code:"wrong",name:"По телефону отвечает не та организация"},{id:9,code:"auto",name:"Автоответчик"}],current:{id:1,code:"nopickup",name:"Недозвон - трубку не берут"},default:{id:1,code:"nopickup",name:"Недозвон - трубку не берут"}},r[a.FAIL_TYPE]={items:[{id:0,code:"garant",name:"Гарант/Запрет"},{id:1,code:"go",name:"Покупает ГО"},{id:2,code:"territory",name:"Чужая территория"},{id:3,code:"accountant",name:"Бухприх"},{id:4,code:"autsorc",name:"Аутсорсинг"},{id:5,code:"depend",name:"Несамостоятельная организация"},{id:6,code:"failure",name:"Отказ"}],current:{id:0,code:"garant",name:"Гарант/Запрет"},default:{id:0,code:"garant",name:"Гарант/Запрет"}},r[a.FAIL_REASON]={items:[{id:0,code:"fail_notime",name:"Не было времени"},{id:1,code:"c_habit",name:"Конкуренты - привыкли"},{id:2,code:"c_prepay",name:"Конкуренты - оплачено"},{id:3,code:"c_price",name:"Конкуренты - цена"},{id:4,code:"money",name:"Дорого/нет Денег"},{id:5,code:"to_cheap",name:"Слишком дешево"},{id:6,code:"nomoney",name:"Нет денег"},{id:7,code:"noneed",name:"Не видят надобности"},{id:8,code:"lpr",name:"ЛПР против"},{id:9,code:"employee",name:"Ключевой сотрудник против"}],current:{id:0,code:"fail_notime",name:"Не было времени"},default:{id:0,code:"fail_notime",name:"Не было времени"}},r[a.COMMENT]="",r)},c={setFetchedDepartament:function setFetchedDepartament(e,t,n,r){return{type:"report/SET_FITCHED_DEPARTAMENT",departament:e,currentUser:t,placement:n,domain:r}},setReportProp:function setReportProp(e,t){return{type:"report/SET_REPORT_PROP",propName:e,value:t}}};const s=function report(e,t){var n,r;switch(void 0===e&&(e=l),t.type){case"report/SET_FITCHED_DEPARTAMENT":default:return e;case"report/SET_REPORT_PROP":if(t.propName===a.COMMENT)return __assign(__assign({},e),((n={})[a.COMMENT]=t.value,n));var c=e.report[t.propName].items.find((function(e){return e.code==t.value}));return __assign(__assign({},e),{report:__assign(__assign({},e.report),(r={},r[t.propName]=__assign(__assign({},e.report[t.propName]),{current:c}),r))})}}},1301:(e,t,n)=>{n.d(t,{Ay:()=>l,l1:()=>a});var __assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)},r={tasks:null,isFetched:!1},a={setFetchedTasks:function setFetchedTasks(e){return{type:"report/SET_FITCHED_TASKS",tasks:e}}};const l=function tasks(e,t){return void 0===e&&(e=r),"report/SET_FITCHED_TASKS"===t.type?__assign(__assign({},e),{tasks:t.tasks}):e}},9245:(e,t,n)=>{n.d(t,{QB:()=>i,_t:()=>o,a$:()=>r,xY:()=>a});var r,a,l=n(8329),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.GLOBAL="global",e.KONSTRUCTOR="konstructor",e.PRODUCTS="products",e.TEMPLATE="template",e.DOCUMENT="document",e.REPORT="report",e.CALLING="calling",e.TRANSKRIBATION="transcribation",e.FINISH="finish"}(r||(r={})),function(e){e.KONSTRUCTOR="konstructor",e.REPORT="report",e.CALLING="calling",e.TRANSKRIBATION="transcribation"}(a||(a={}));var c={routes:[{id:0,name:"Начальные настройки",route:r.GLOBAL},{id:1,name:"Конструктор",route:r.KONSTRUCTOR},{id:2,name:"Цены и сравнение комплектов",route:r.PRODUCTS},{id:3,name:"Выбор Шаблона",route:r.TEMPLATE},{id:4,name:"Документ",route:r.DOCUMENT},{id:5,name:"Отчет",route:r.REPORT},{id:6,name:"Звонки",route:r.CALLING},{id:7,name:"Транскрибация",route:r.TRANSKRIBATION},{id:8,name:"Финиш",route:r.FINISH}],current:{id:6,name:"Звонки",route:r.CALLING},previous:null,next:null},s=function setCurrentRoute(e){return{type:"router/SET_CURRENT",id:e}},o=function setInitialRoute(e,t){return function(e,t){e(u(r.CALLING))}},u=function navigate(e){return function(t,n){console.log("navigate "+e);var r=n().router.routes.find((function(t){return t.route===e}));if(r){var a=r.id;t(s(a))}t((0,l.Z)(!1))}},i=function router(e,t){if(void 0===e&&(e=c),"router/SET_CURRENT"===t.type){var n=e.routes.find((function(e){return e.id==t.id})),r=e.current,a=e.previous;return n?__assign(__assign({},e),{current:n,previous:r,next:a}):e}return e}},6277:(e,t,n)=>{n.d(t,{A:()=>P});var r=n(2960),a=n(1265),l=n(6745),c=n(8329),s=n(9245),o=n(2056),u=n(4705);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,u.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i="SET_TOP_DISPLAY_STATUS",p="SET_SCROLL_TOP_STATUS",d={isTopDisplayShowing:!0,scrollTop:!1};const m=function display(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i:return _objectSpread(_objectSpread({},e),{},{isTopDisplayShowing:t.status});case p:return _objectSpread(_objectSpread({},e),{},{scrollTop:t.status});default:return e}};var f,b=n(4850),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.RESULT="result",e.NORESULT="noresult",e.EXPIRED="expired"}(f||(f={}));var y={isActive:!1,type:null};const v=function callingResult(e,t){switch(void 0===e&&(e=y),t.type){case"callings/result/SET_FITCHED_LIST":default:return e;case"callings/result/SET_MENU_STATUS":return __assign(__assign({},e),{isActive:t.status,type:t.status?t.menuType:null})}};var g,E,_=n(1301),presentation_reducer_assign=function(){return presentation_reducer_assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},presentation_reducer_assign.apply(this,arguments)};!function(e){e.PRESENTATION="presentation",e.IS_UNPLANNED_PRESENTATION="isUnplannedPresentation"}(E||(E={}));var S=((g={presentation:{companyCount:0,smartCout:0}})[E.IS_UNPLANNED_PRESENTATION]=!1,g);const h=function presentation(e,t){var n;switch(void 0===e&&(e=S),t.type){case"callings/presentation/SET_STATE_PROP":return presentation_reducer_assign(presentation_reducer_assign({},e),((n={})[t.name]=t.value,n));case"callings/presentation/SET_PRESENTATION_COUNT":var r=presentation_reducer_assign({},e.presentation);return"company"==t.entityType?r.companyCount=t.count:"smart"==t.entityType&&(r.smartCout=t.count),presentation_reducer_assign(presentation_reducer_assign({},e),{presentation:presentation_reducer_assign(presentation_reducer_assign({},e.presentation),r)});default:return e}};var A=n(2872),post_sale_reducer_assign=function(){return post_sale_reducer_assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},post_sale_reducer_assign.apply(this,arguments)},T={isActive:!1,questionStatus:!1,isSaleComplete:!1,isCreateNewSale:!1,questions:{new:{id:0,title:"Уже сделана продажа этому клиенту",isActive:!0,value:!0,isAnswered:!1}}};const C=function postSale(e,t){switch(void 0===e&&(e=T),t.type){case"callings/postSale/SET_SALE_COMPLETE":return post_sale_reducer_assign(post_sale_reducer_assign({},e),{isSaleComplete:!0});case"callings/postSale/SET_IS_NEW_SALE_STATUS":return post_sale_reducer_assign(post_sale_reducer_assign({},e),{isCreateNewSale:t.status});case"callings/postSale/SET_SALE_ANSWER_STATUS":return post_sale_reducer_assign(post_sale_reducer_assign({},e),{questionStatus:t.status});case"callings/postSale/SET_SALE_QUESTION_STATUS":return post_sale_reducer_assign(post_sale_reducer_assign({},e),{isActive:t.status});case"callings/postSale/SET_FINISH_STATUS":return{isActive:!1,questionStatus:!1,isSaleComplete:!1,isCreateNewSale:!1,questions:{new:{id:0,title:"Уже сделана продажа этому клиенту",isActive:!0,value:!0,isAnswered:!1}}};default:return e}};var w=(0,r.HY)({app:l.Ay,display:m,router:s.QB,result:v,preloader:c.A,calling:o.Ay,tasks:_.Ay,presentation:h,plan:A.Ay,report:b.Ay,postSale:C});const P=(0,r.y$)(w,(0,r.Tw)(a.A))},1715:(e,t,n)=>{var r,a;n.d(t,{b:()=>r}),function(e){e.GET="get",e.POST="post",e.PUT="put",e.DELETE="delete"}(r||(r={})),function(e){e.ENTITY="entity",e.ENTITIES="entities"}(a||(a={}))}},e=>{e.O(0,[446,610,110,996,992,248,644,484,214],(()=>{return t=3670,e(e.s=t);var t}));e.O()}]);