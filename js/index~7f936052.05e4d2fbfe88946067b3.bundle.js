(self.webpackChunkapril_kp=self.webpackChunkapril_kp||[]).push([[197],{3095:(e,t,r)=>{r.d(t,{D7:()=>p,E6:()=>R,IW:()=>L,TF:()=>h,W3:()=>x,YY:()=>C,Z$:()=>c,ZP:()=>w,bD:()=>d,lr:()=>T,m6:()=>I,op:()=>P,rS:()=>a,xC:()=>O});var n=r(2167),o=r(2234),u=r(3138),s=r(9407),i=r(5623),l=r(7585);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var a="Интернет",c="Проксима",p="Универсальная линейка",d="ПРОФ",b={supplies:{name:"Тип Доступа",values:[{id:0,title:a},{id:1,title:c}]},complects:{name:"Тип Комплекта",values:[{id:0,title:p},{id:1,title:d}]},regions:{name:"Регион",values:[{id:0,title:"КМВ"},{id:1,title:"Ставрополь"}]},currentSupply:null,currentComplectsType:null,currentRegion:null,status:!1,message:"",error:{region:null,complect:null,supply:null}},f="SET_FETCHED_REGIONS",S="SET_SUPPLY",m="SET_COMPLECTS_TYPE",y="SET_REGION",g="SET_STATUS",_="CLEAN_MESSAGE",T="global/SET_GLOBAL",E=" RESET_GLOBAL",v="REMEMBER_GLOBAL",I=function setFetchedRegions(e){return{type:f,regions:e}},O=function setSupply(e){return{type:S,supplyId:e}},R=function setComplectsType(e){return{type:m,complectTypeId:e}},h=function setRegion(e){return{type:y,regionId:e}},D=function setStatus(e){return{type:g,status:e}},C=function cleanError(e){return{type:_,name:e}},j=function setGlobal(e,t,r){return{type:T,currentSupply:e,currentComplectsType:t,currentRegion:r}},L=function changeAndSetGlobalStatus(e){return function(t,r){r().global,r().contract;t(D(e));var n=r().global;r().contract;!n.status||n.error.region||n.error.complect||n.error.supply||n.currentSupply&&n.currentComplectsType&&n.currentRegion&&(t(j(n.currentSupply,n.currentComplectsType,n.currentRegion)),t(s.f.setGlobal(n.currentSupply,n.currentComplectsType,n.currentRegion)),t(o.p.setCurrentRegion(n.currentRegion)),t((0,l.c4)(l.ln.KONSTRUCTOR)),n.currentComplectsType.title===p&&t((0,u.lr)()))}},P=function back(){return function(e,t){e(D(!1)),e((0,i.mc)())}},x=function rememberGlobal(e,t){return function(r,n){r(function setRememberGlobal(e){return{type:v,global:e}}(e)),r(j(e.currentSupply,e.currentComplectsType,e.currentRegion)),r(t?o.p.setRememberRegions(t):o.p.setCurrentRegion(e.currentRegion))}};const w=function global(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:var r=t.regions.map((function(e){return _objectSpread(_objectSpread({},e),{},{id:e.number})}));return _objectSpread(_objectSpread({},e),{},{regions:_objectSpread(_objectSpread({},e.regions),{},{name:"Регион",values:r})});case S:var o=e.supplies.values.find((function(e){return e.id===t.supplyId}));return _objectSpread(_objectSpread({},e),{},{currentSupply:o,message:"",error:_objectSpread(_objectSpread({},e.error),{},{supply:null})});case m:return _objectSpread(_objectSpread({},e),{},{currentComplectsType:e.complects.values.find((function(e){return e.id===t.complectTypeId})),message:"",error:_objectSpread(_objectSpread({},e.error),{},{complect:null})});case y:var u=e.regions.values.find((function(e){return e.number===t.regionId}));return u?_objectSpread(_objectSpread({},e),{},{currentRegion:u,message:"",error:_objectSpread(_objectSpread({},e.error),{},{region:null})}):e;case g:e.message;if(t.status){if(e.status!==t.status){var s=_objectSpread({},e.error);return e.currentRegion||(s.region="Выберите ".concat(e.regions.name)),e.currentComplectsType||(s.complect="Выберите ".concat(e.complects.name)),e.currentSupply||(s.supply="Выберите ".concat(e.supplies.name)),s.region||s.complect||s.supply?_objectSpread(_objectSpread({},e),{},{error:s}):_objectSpread(_objectSpread({},e),{},{status:t.status,message:""})}return e}return _objectSpread(_objectSpread({},e),{},{currentSupply:null,currentComplectsType:null,currentRegion:null,status:t.status,message:""});case _:return _objectSpread(_objectSpread({},e),{},{error:_objectSpread(_objectSpread({},e.error),{},(0,n.Z)({},t.name,null))});case v:return t.global;case E:return _objectSpread(_objectSpread({},e),{},{currentSupply:null,currentComplectsType:null,currentRegion:null,status:t.bool,message:""});default:return e}}},786:(e,t,r)=>{r.d(t,{ZP:()=>o});r(6097);var __assign=function(){return __assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)},n={items:[],type:null,current:null,creating:{formData:null,isInitialized:!1,isFetching:!1,isHaveGroup:!1},relation:{isCreating:!1,parrentGroupName:null}};const o=function entity(e,t){switch(void 0===e&&(e=n),t.type){case"entity/SET_ENTITIES":return __assign(__assign({},e),{items:t.items});case"entity/SET_CURRENT_ENTIY":return __assign(__assign({},e),{current:t.item,creating:{formData:null,isInitialized:!1,isFetching:!1}});case"entity/SET_INITIAL_CREATE_ENTITY":var r=t.initialData;return __assign(__assign({},e),{creating:{formData:r,isInitialized:!0,isFetching:!1}});case"entity/SET_FETCHING_INITIAL_DATA":return __assign(__assign({},e),{creating:__assign(__assign({},e.creating),{isInitialized:!1,isFetching:!0})});case"entity/SET_CREATING_RELATION":return t.entity&&t.entity.groups[0]&&t.entity.groups[0].fields?__assign(__assign({},e),{relation:__assign(__assign({},e.relation),{parrentGroupName:t.groupName,formData:t.entity,isCreating:!0,relationIndex:t.relationIndex})}):e;case"entity/SET_CREATED_RELATION":return __assign(__assign({},e),{creating:__assign(__assign({},e.creating),{formData:__assign(__assign({},e.creating.formData),{groups:t.groups})}),relation:__assign(__assign({},e.relation),{isCreating:!1,formData:null,parrentGroupName:null,relationIndex:null})});default:return e}}},7968:(e,t,r)=>{r.d(t,{W:()=>u,q:()=>o});var __assign=function(){return __assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)},n={taskDeals:{},portalList:null,portalDeal:null,isSaled:!1,isFetched:!1,isLoading:!1,isCurrentShow:!1,isCurrentFetched:!1,presDeals:{items:[],current:null,show:null,isItemsFetched:!1},presList:{items:[],isItemsFetched:!1,current:null,show:null}},o={setPortalSale:function setPortalSale(e,t){return{type:"event/SET_PORTAL_SALE",portalList:t,portalDeal:e}},setIsLoading:function setIsLoading(e){return{type:"event/SET_IS_LOADING",status:e}},setCurrentPresShowStatus:function setCurrentPresShowStatus(e){return{type:"event/SET_PRES_SHOW_STATUS",status:e}},setCurrentPresList:function setCurrentPresList(e){return{type:"event/SET_CURRENT_PRES_LIST",predDeals:e}},setCurrentPresItem:function setCurrentPresItem(e,t){return{type:"event/SET_CURRENT_PRES_ITEM",dealId:e,actionType:t}}},u=function eventPres(e,t){var r;switch(void 0===e&&(e=n),t.type){case"event/SET_IS_LOADING":return __assign(__assign({},e),{isLoading:t.status});case"event/SET_PORTAL_SALE":return __assign(__assign({},e),{portalList:t.portalList,portalDeal:t.portalDeal,isLoading:!1,isFetched:!0});case"event/SET_PRES_SHOW_STATUS":return __assign(__assign({},e),{isCurrentShow:t.status,isCurrentFetched:t.status});case"event/SET_CURRENT_PRES_LIST":console.log("SET_CURRENT_PRES_LIST"),console.log("predDeals"),console.log(t.predDeals);var o=__assign(__assign({},e),{presDeals:__assign(__assign({},e.presDeals),{items:t.predDeals||[],isItemsFetched:!0}),presList:__assign(__assign({},e.presList),{items:[],isItemsFetched:!0})});return console.log("SET_CURRENT_PRES_LIST"),console.log(o),o;case"event/SET_CURRENT_PRES_ITEM":var u=t.dealId,s=e.presDeals.items.find((function(e){return e.ID===u}))||null,i=__assign(__assign({},e),{presDeals:__assign(__assign({},e.presDeals),(r={},r[t.actionType]=s,r))});return console.log("current pres deal state"),console.log(i),i;default:return e}}},2888:(e,t,r)=>{r.d(t,{f:()=>l});var n=r(7968),o=r(2823),u=r(4353),s=r(6097),i=r(3129),__awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(o,u){function fulfilled(e){try{step(n.next(e))}catch(e){u(e)}}function rejected(e){try{step(n.throw(e))}catch(e){u(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},__generator=function(e,t){var r,n,o,u,s={label:0,sent:function sent(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function verb(i){return function(l){return function step(i){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},l=function getInitEventPres(){return function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var r,l,a,c,p,d,b,f,S,m,y,g,_,T,E,v;return __generator(this,(function(I){switch(I.label){case 0:return r=t(),r.event.isLoading?[3,3]:(e(n.q.setIsLoading(!0)),l=r.app,a=i.XK?null:i.vF,l.bitrix.placement&&l.bitrix.placement.options&&(a=l.bitrix.placement.options.ID),l.bitrix.company&&l.bitrix.company.ID&&(a=l.bitrix.company.ID),c=l.domain||i.PO,p=(null===(v=l.user)||void 0===v?void 0:v.ID)||1,d=l.bitrix.deal||i.vi,console.log("baseDealId"),console.log(d),b={domain:c||i.PO,userId:p},d&&d.ID&&(d=d.ID),f={domain:c,companyId:a,baseDealId:d,userId:p},[4,o.L.service("full/document/init",u.F.POST,"deals",f)]);case 1:return S=I.sent(),console.log("sessionData"),console.log(S),S&&"deals"in S&&(m=S.deals,console.log("sessionDeals"),console.log(m),"basePresentationDeals"in m&&(y=m.basePresentationDeals,console.log("basePresentationDeals"),console.log(y),e(n.q.setCurrentPresList(y)))),[4,s.gT.service("front/portal",u.F.POST,"portal",b)];case 2:g=I.sent(),null,null,_=null,T=null,g&&(g.bitrixDeal&&g.bitrixDeal.categories&&g.bitrixDeal.categories.forEach((function(e){"sales_presentation"===e.code&&(T=g.bitrixDeal,e.bitrixId)})),g.bitrixDeal&&g.bitrixLists&&g.bitrixLists.forEach((function(e){"presentation"===e.type&&(_=e)})),_&&(_.bitrixId,_.bitrixfields&&_.bitrixfields.length&&(E={},_.bitrixfields.forEach((function(e){"sales_presentation_pres_responsible"==e.code&&(E[e.bitrixId]=p)})))),e(n.q.setPortalSale(T,_))),I.label=3;case 3:return[2]}}))}))}}},3535:(e,t,r)=>{r.d(t,{I:()=>i,U:()=>s,od:()=>l});var n=r(5549),o=r(3095),__assign=function(){return __assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)},u={currentOd:"Количество доступов",currentOdIndex:0,supplies:[],prof:{},universal:{},all:[]},s={setInitialOds:function setInitialOds(e){return{type:"supply/SET_INITIAL_ODS",supplies:e}},setCurrentOd:function setCurrentOd(e){return{type:"supply/SET_CURRENT_OD",odNumber:e}},setRememberOd:function setRememberOd(e){return{type:"supply/SET_REMEMBER_OD",od:e}},resetSupply:function resetSupply(){return{type:"RESET"}},setGlobal:function setGlobal(e,t,r){return{type:"global/SET_GLOBAL",currentSupply:e,currentComplectsType:t,currentRegion:r}}},i=function odChange(e){return function(t,r){var o=r().currentComplect,u=r().global.currentSupply;if(o&&"Универсальный комплект"!==o.name){t(s.setCurrentOd(e));var i=r().contract.select,l=void 0;u&&1==u.id?10==e&&(l=i.find((function(e){return 1==e.number}))):l=i[0],l&&l.number&&t((0,n.Ck)(l.number))}else window.alert("сначала выберите комплект")}},l=function od(e,t){switch(void 0===e&&(e=u),t.type){case"supply/SET_INITIAL_ODS":var r={internet:[],proxima:[]},n={internet:[],proxima:[]},s=[];return t.supplies&&t.supplies.length>0&&t.supplies.forEach((function(e){"internet"===e.type?(0!==e.number&&(r.internet[e.number-1]=e),n.internet[e.number]=e,s[e.number]=e):(9!==e.number&&(r.proxima[e.number-10]=e),n.proxima[e.number-9]=e,s[e.number]=e)})),__assign(__assign({},e),{supplies:r.internet,prof:r,universal:n,all:s,currentOd:r.internet[0]});case"supply/SET_CURRENT_OD":var i=e.supplies.find((function(e){return e.number===t.odNumber}));return e.currentOd.number!==t.odNumber?__assign(__assign({},e),{currentOd:i,currentOdIndex:t.odNumber}):e;case"global/SET_GLOBAL":if(t.currentComplectsType.title===o.bD){if(t.currentSupply&&t.currentSupply.title===o.rS)return __assign(__assign({},e),{supplies:e.prof.internet,currentOd:e.prof.internet[0]});if(t.currentSupply&&t.currentSupply.title===o.Z$)return __assign(__assign({},e),{supplies:e.prof.proxima,currentOd:e.prof.proxima[0]})}else if(t.currentComplectsType.title===o.D7){if(t.currentSupply&&t.currentSupply.title===o.rS)return __assign(__assign({},e),{supplies:e.universal.internet,currentOd:e.universal.internet[0]});if(t.currentSupply&&t.currentSupply.title===o.Z$)return __assign(__assign({},e),{supplies:e.universal.proxima,currentOd:e.universal.proxima[0]})}return e;case"RESET":return __assign(__assign({},e),{currentOd:e.supplies[0]});case"supply/SET_REMEMBER_OD":var l=e.supplies[0]?e.supplies[0].number:0;t.od.currentOd&&(t.od.currentOd.number||0===t.od.currentOd.number)&&(l=t.od.currentOd.number);var a=e.supplies.find((function(e){return e.number===l}));return a||(a=e.supplies[0]),__assign(__assign({},e),{currentOd:a,currentOdIndex:t.od.currentOdIndex});default:return e}}}}]);