(self.webpackChunkapril_crm=self.webpackChunkapril_crm||[]).push([[761],{8205:(e,t,n)=>{n.d(t,{R4:()=>s,Ss:()=>a,db:()=>r,pY:()=>l,wV:()=>c});var r=!0,a="gsr.bitrix24.ru",l=143,c=187,s=!1},609:(e,t,n)=>{n.d(t,{A:()=>de});var r,a,l=n(7075),c=n(9733),s=n(6540),o={setFetchedCallings:function setFetchedCallings(e){return{type:"callings/SET_FITCHED_CALLINGS",callings:e}},setFetchedDepartament:function setFetchedDepartament(e,t,n,r){return{type:"callings/SET_FITCHED_DEPARTAMENT",departament:e,currentUser:t,placement:n,domain:r}},setPrimrtiveStateProp:function setPrimrtiveStateProp(e,t){return{type:"callings/SET_STATE_PROP",name:e,value:t}},setSaleComplete:function setSaleComplete(){return{type:"callings/SET_SALE_COMPLETE"}},setIsNewSaleStatus:function setIsNewSaleStatus(e){return{type:"callings/SET_IS_NEW_SALE_STATUS",status:e}},setSaleQuestionStatus:function setSaleQuestionStatus(e){return{type:"callings/SET_SALE_QUESTION_STATUS",status:e}},setSaleAnswerStatus:function setSaleAnswerStatus(e){return{type:"callings/SET_SALE_ANSWER_STATUS",status:e}},setPresentationCount:function setPresentationCount(e,t){return{type:"callings/SET_PRESENTATION_COUNT",count:e,entityType:t}},setFullCompleteStatus:function setFullCompleteStatus(e){return{type:"callings/SET_FULL_COMPLETE_STATUS",status:e}},setFinishStatus:function setFinishStatus(e,t){return{type:"callings/SET_FINISH_STATUS",status:e,result:t}}},i=n(9002),u=n(4929),p=n(291),d=n(8205),m=n(4003),f=n(1715),b=n(5580),g=n(7067),y=n(9508),v=function setMenuStatus(e,t){return{type:"callings/result/SET_MENU_STATUS",status:e,menuType:t}},__awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},__generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},E=function getResultMenu(e,t){return function(n,r){return __awaiter(void 0,void 0,void 0,(function(){var a;return __generator(this,(function(l){return n(v(e,t)),{default:{general:{next:{date:"",name:""},workStatus:{items:[],current:null},failReason:{items:[],current:null},noPerspektType:{items:[],current:null},isFail:!1},noResult:{type:{items:[],current:null}}}},a=r().result,a.fetchedKpiList,[2]}))}))}},report_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},report_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}};r||(r={}),function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(a||(a={}));var S=function checkIfTaskIsOverdue(e){var t="no",n=new Date,r=new Date(e.deadline);r<n?t="yes":(r.setHours(0,0,0,0),n.setHours(0,0,0,0),n.getTime()===r.getTime()&&(t="almost"));return t},_=function parseTaskTitle(e){e.match(/^(.*?)(?=\sзапланирован)/),e.match(/запланирован[ао]?\s+(.*?)\s+\d{2}\.\d{2}\.\d{4}/);return{type:"Запланирован",name:e}},A=function getFormatDate(e){if(e){var t=(0,u.H)(e);return(0,p.GP)(t,"d MMMM yyyy HH:mm",{locale:b.ru})}return""},h=n(5826),C=n(9704),T=n(3342),I=n(6556),w=n(4930),P=n(7535),N=n(8756),O=n(7917),x=n(6540);const R=function AprilModal(e){var t=e.isOpen,n=e.cancel,r=e.children,a=(0,s.useState)(!1),c=(0,l.A)(a,2),o=(c[0],c[1],function toggle(){}),i=function close(){n(!1)};return x.createElement("div",null,x.createElement(I.A,{isOpen:t,toggle:o,size:"lg"},x.createElement(w.A,{className:"p-3 ap_modal__header",toggle:i},"Отчет о звонке и планирование"),x.createElement(P.A,null,x.createElement("div",null,r)),x.createElement(N.A,{className:"p-2 calling-modal-q-footer"},x.createElement(O.A,{size:"sm",color:"primary",onClick:o},"Отправить"),x.createElement(O.A,{size:"sm",color:"danger",onClick:i},"Отмена"))))};var D=n(2056),k=n(5169),M=n(6477);const L=function ResultMenuPresentation(e){var t=e.presentation,n=(e.presentationDone,e.isFullComplete,(0,s.useState)(!1)),r=(0,l.A)(n,2),a=r[0],c=r[1];return s.createElement(s.Fragment,null,s.createElement("div",{className:"page-content"},s.createElement(k.A,{fluid:!0},s.createElement(h.A,{className:"mb-3"},s.createElement(C.A,{sm:3},s.createElement("h3",{className:"text__bold col-md-4 col-form-label"},"Презентации"))),s.createElement(h.A,null,s.createElement(C.A,{sm:12},s.createElement(h.A,null,s.createElement(C.A,{sm:3},s.createElement("p",{style:{width:"120px"},className:"text__small col-md-3"},"По компании")),s.createElement(C.A,{sm:3},s.createElement("div",{className:"f col-md-12"},s.createElement("input",{disabled:!0,className:"form-control mt-0",type:"text",id:"example-string-input",lang:"rus",value:t.companyCount}))),s.createElement(C.A,{sm:3},s.createElement("p",{className:"text__small col-md-3",style:{width:"120px"}},"Текущие")),s.createElement(C.A,{sm:3},s.createElement("div",{className:"f"},s.createElement("input",{disabled:!0,className:"form-control mt-0",type:"text",id:"example-string-input",lang:"rus",value:t.smartCout})))),s.createElement("div",{onClick:function onClick(){return c(!a)},className:"d-flex flex-column justify-content-start align-items-start"},s.createElement("label",{htmlFor:"example-string-input",className:"col-md-6 mt-1 col-form-label"},"Зафиксировать презентацию"),s.createElement("div",{className:"presentation__actions"},s.createElement(M.A,{style:{cursor:"pointer"},outline:!0,className:"col-md-3 \n                                    ".concat(a?"presentation__badge__active":"presentation__badge")},"Была проведена"),a&&s.createElement("div",{className:"presentation__done__count"},"+1"))))))))};const j=function ResultMenuSuccessReport(e){var t=e.currentResultStatus,n=e.currentFailReason,r=e.setCurentCallingProp,a=e.report,c=e.setCurrentFailReason,o=e.setCurrentResultStatus,i=(0,s.useState)(!1),u=(0,l.A)(i,2),p=(u[0],u[1],function handleChange(e,t){"result-status"===e?o(t):"fail-reasone"===e?c(t):r(e,t)}),d=(a.noresultReasone.items,a.failType.items,a.failReason.items),m=a.workStatus.items;return s.createElement(s.Fragment,null,s.createElement("div",{className:"page-content"},s.createElement(k.A,{fluid:!0},s.createElement(h.A,null,s.createElement("div",{className:"col-md-12 col-form-label"},s.createElement("h3",{className:"text__bold col-md-4 col-form-label"},"Результат"))),s.createElement(h.A,{className:""},s.createElement(C.A,{sm:12},s.createElement("label",{className:"col-md-12 col-form-label"},"Статус Работы"),s.createElement("div",{className:"col-md-12 mt-2  mb-2"},s.createElement("select",{className:"form-control mt-2",onChange:function onChange(e){return p("result-status",e.target.value)}},m&&m.length&&m.map((function(e){return s.createElement("option",{key:"call-type-".concat(e.id),value:e.code},e.name)})))),"fail"===t&&s.createElement(s.Fragment,null,s.createElement("label",{className:"col-md-12 col-form-label"},"Причины отказа"),s.createElement("div",{className:"col-md-12 mt-2  mb-1"},s.createElement("select",{className:"form-control mt-0",value:n,onChange:function onChange(e){return p("fail-reasone",e.target.value)}},d&&d.length&&d.map((function(e){return s.createElement("option",{key:"call-type-".concat(e.id),value:e.code},e.name)}))))))))))};const F=function ResultMenuCallCreate(e){var t=e.responsibility,n=e.createdBy,r=e.date,a=(e.name,e.type),c=e.plan,o=e.setCurentCallingProp,i=e.changeDeadline,u=(e.createTask,(0,s.useState)(c)),p=(0,l.A)(u,2),d=(p[0],p[1]),m=(0,s.useState)(t.current),f=(0,l.A)(m,2),b=(f[0],f[1]),g=(0,s.useState)(n.current),y=(0,l.A)(g,2),v=(y[0],y[1],(0,s.useState)(!1)),E=(0,l.A)(v,2),S=E[0],_=E[1];(0,s.useEffect)((function(){d(c)}),[c]),(0,s.useEffect)((function(){b(t.current)}),[t.current]);var A=function handleChange(e,t){o(e,t)};return s.createElement(s.Fragment,null,s.createElement("label",{htmlFor:"example-string-input",className:"col-md-12 col-form-label ".concat(S?"calling-name-label-error":"")},S?"Заполните обязательное поле - Тема звонка":"Название - что нужно сделать"),s.createElement("div",{className:"col-md-12 mt-2 mb-2"},s.createElement("input",{onChange:function onChange(e){return A(D.u$.NAME,e.target.value)},onFocus:function handleOnNameFocus(){S&&_(!1)},className:"mt-0 form-control ".concat(S?"is-invalid":""),type:"text",id:"example-string-input",lang:"rus"})),s.createElement("label",{htmlFor:"example-datetime-local-input",className:"col-md-12 col-form-label"},"Дата и время звонка"),s.createElement("div",{className:"col-md-12 mt-2   mb-2"},s.createElement("input",{className:"form-control mt-0",type:"datetime-local",defaultValue:r,id:"example-datetime-local-input",lang:"rus",onChange:function onChange(e){return i(e.target.value)}})),s.createElement("label",{className:"col-md-12 col-form-label"},"Тип звонка"),s.createElement("div",{className:"col-md-12 mt-2  mb-0"},s.createElement("select",{className:"form-control  mt-0",value:a.current.id,onChange:function onChange(e){return A(D.u$.TYPE,e.target.value)}},a.items&&a.items.length&&a.items.map((function(e){return s.createElement("option",{key:"call-type-".concat(e.id),value:e.id},e.title)})))))};var U=n(6540);const $=function ResultComment(e){var t=e.handleChange,n=(0,s.useState)(!1),r=(0,l.A)(n,2),a=r[0],c=r[1];return U.createElement(U.Fragment,null,U.createElement("label",{htmlFor:"description-string-input",className:"col-md-12 col-form-label"},"Опишите кратко что было"),U.createElement("div",{className:"col-md-12 mt-2  mb-2"},U.createElement("textarea",{onChange:function onChange(e){return t(D.u$.DESCRIPTION,e.target.value)},onFocus:function handleOnNameFocus(){a&&c(!1)},className:"form-control",type:"text",id:"description-string-input",lang:"rus",rows:"7"})))};const Y=function ResultMenuSuccess(e){var t=e.domain,n=e.currentUser,r=e.responsibility,a=e.createdBy,c=e.date,o=e.name,i=e.type,u=e.plan,p=e.current,d=e.sale,m=(e.isOneMore,e.report),f=e.isUnplannedPresentation,b=e.presentation,g=e.setCurentCallingProp,y=e.changeDeadline,v=e.createTask,E=e.fail,S=e.presentationDone,_=e.isFullComplete,A=(0,s.useState)(u),T=(0,l.A)(A,2),I=(T[0],T[1]),w=(0,s.useState)(r.current),P=(0,l.A)(w,2),N=(P[0],P[1]),O=(0,s.useState)(a.current),x=(0,l.A)(O,2),R=(x[0],x[1],(0,s.useState)(!1)),D=(0,l.A)(R,2),k=(D[0],D[1],(0,s.useState)("inJob")),M=(0,l.A)(k,2),U=M[0],Y=M[1],B=(0,s.useState)("other"),K=(0,l.A)(B,2),H=K[0],G=K[1];(0,s.useEffect)((function(){I(u)}),[u]),(0,s.useEffect)((function(){N(r.current)}),[r.current]);return s.createElement(s.Fragment,null,s.createElement(h.A,{className:"p-0"},s.createElement(C.A,{sm:6,className:"p-0"},s.createElement(j,{domain:t,currentUser:n,current:p,sale:d,currentFailReason:H,currentResultStatus:U,report:m,setCurrentResultStatus:Y,setCurrentFailReason:G,setCurentCallingProp:g,createTask:v,fail:E,isFullComplete:_})),s.createElement(C.A,{sm:6,className:"p-0"},s.createElement(L,{isUnplannedPresentation:f,presentation:b,presentationDone:S,isFullComplete:_}))),s.createElement(h.A,{className:"mt-2"},s.createElement(C.A,{sm:6}),s.createElement(C.A,{sm:6})),s.createElement(h.A,{className:"mt-2"},s.createElement(C.A,{sm:6},s.createElement("h3",{className:"bold"}," Комментарий")),s.createElement(C.A,{sm:6},s.createElement("h3",{className:"bold"}," Планирование следующего звонка"))),s.createElement(h.A,null,s.createElement(C.A,{sm:6},s.createElement($,{handleChange:function handleChange(e,t){g(e,t)}})),("inJob"===U||"setAside"===U)&&s.createElement(C.A,{sm:6},s.createElement(F,{responsibility:r,createdBy:a,date:c,name:o,type:i,plan:u,changeDeadline:y,setCurentCallingProp:g}))))};var B=n(6540);const K=function ResultMenu(e){e.isSuccess;var t=e.domain,n=e.currentUser,r=e.responsibility,a=e.createdBy,l=e.date,c=e.name,s=e.type,o=e.plan,i=e.current,u=e.sale,p=e.isOneMore,d=e.isUnplannedPresentation,m=e.report,f=e.isMenuActive,b=e.presentation,g=e.setCurentCallingProp,y=e.changeDeadline,v=e.createTask,E=e.fail,S=e.presentationDone,_=e.isFullComplete,A=e.setMenuStatus;return B.createElement(R,{isOpen:f,cancel:function cancel(){return A(!1,null)}},B.createElement(Y,{domain:t,currentUser:n,responsibility:r,createdBy:a,date:l,name:c,type:s,plan:o,current:i,sale:u,isOneMore:p,report:m,isUnplannedPresentation:d,presentation:b,setCurentCallingProp:g,changeDeadline:y,createTask:v,fail:E,presentationDone:S,isFullComplete:_}))};var H,G,z,q,Q,W,Z=n(8329),X=n(4705),V=n(467),J=n(4756),ee=n.n(J),te=n(6266).A.create({baseURL:"https://april-hook.ru/api",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),ne={getCollection:(z=(0,V.A)(ee().mark((function _callee(e,t,n){var r,a,l,c=arguments;return ee().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(r=c.length>3&&void 0!==c[3]?c[3]:null,a=null,s.prev=2,r){s.next=9;break}return s.next=6,te[t](e);case 6:s.t0=s.sent,s.next=12;break;case 9:return s.next=11,te[t](e,r);case 11:s.t0=s.sent;case 12:if(!(l=s.t0)){s.next=16;break}return l.data&&0===l.data.resultCode&&l.data[n]&&(a=l.data.isCollection?l.data[n].data:l.data[n]),s.abrupt("return",a);case 16:s.next=21;break;case 18:return s.prev=18,s.t1=s.catch(2),s.abrupt("return",a);case 21:case"end":return s.stop()}}),_callee,null,[[2,18]])}))),function getCollection(e,t,n){return z.apply(this,arguments)}),setCollection:(G=(0,V.A)(ee().mark((function _callee2(e,t){var n,r,a;return ee().wrap((function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:return n=null,l.prev=1,r=(0,X.A)({},e,t),l.next=5,te.post(e,r);case 5:return(a=l.sent)&&0===a.data.resultCode&&(n=a.data.data),l.abrupt("return",n);case 10:return l.prev=10,l.t0=l.catch(1),l.abrupt("return",n);case 13:case"end":return l.stop()}}),_callee2,null,[[1,10]])}))),function setCollection(e,t){return G.apply(this,arguments)}),service:(H=(0,V.A)(ee().mark((function _callee3(e,t,n,r){var a,l;return ee().wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,te[t](e,r);case 4:return(l=c.sent)&&l.data&&0===l.data.resultCode&&(a=l.data[n]),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee3,null,[[1,9]])}))),function service(e,t,n,r){return H.apply(this,arguments)})},re={create:(W=(0,V.A)(ee().mark((function _callee4(e,t,n,r,a,l,c,s,o,i,u,p,d,m){var f,b,g;return ee().wrap((function _callee4$(y){for(;;)switch(y.prev=y.next){case 0:return f=null,b={type:e,auth:{domain:t},company_id:n,deadline:r,responsible:a,created:l,name:c,comment:s,crm:o,company:i,smart:u,sale:p,isOneMore:d,placement:m},y.prev=2,y.next=5,te.post("task/warm",b);case 5:return(g=y.sent)&&g.data&&0===g.data.resultCode&&(f=g.data),y.abrupt("return",f);case 10:return y.prev=10,y.t0=y.catch(2),y.abrupt("return",f);case 13:case"end":return y.stop()}}),_callee4,null,[[2,10]])}))),function create(e,t,n,r,a,l,c,s,o,i,u,p,d,m){return W.apply(this,arguments)}),fail:(Q=(0,V.A)(ee().mark((function _callee5(e,t,n,r,a){var l,c,s;return ee().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return l=null,c={auth:{domain:e},company_id:t,placement:n,smart:a,responsible:r},o.prev=2,o.next=5,te.post("task/fail",c);case 5:return(s=o.sent)&&s.data&&0===s.data.resultCode&&(l=s.data.result),o.abrupt("return",l);case 10:return o.prev=10,o.t0=o.catch(2),o.abrupt("return",l);case 13:case"end":return o.stop()}}),_callee5,null,[[2,10]])}))),function fail(e,t,n,r,a){return Q.apply(this,arguments)}),presentationDone:(q=(0,V.A)(ee().mark((function _callee6(e,t,n,r,a,l,c){var s,o,i;return ee().wrap((function _callee6$(u){for(;;)switch(u.prev=u.next){case 0:return s=null,o={auth:{domain:e},company_id:t,placement:n,company:a,smart:l,responsibleId:r,isUnplannedPresentation:c},u.prev=2,u.next=5,te.post("presentation/done",o);case 5:return(i=u.sent)&&i.data&&0===i.data.resultCode&&(s=i.data.result),u.abrupt("return",s);case 10:return u.prev=10,u.t0=u.catch(2),u.abrupt("return",s);case 13:case"end":return u.stop()}}),_callee6,null,[[2,10]])}))),function presentationDone(e,t,n,r,a,l,c){return q.apply(this,arguments)})},calling_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},calling_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(o){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},ae=function getCallingPlan(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s;return calling_thunk_generator(this,(function(u){switch(u.label){case 0:return n=t(),r=n.app.domain,a=n.calling[D.u$.RESPONSIBILITY].current,l=n.calling.date,c={domain:r,userId:a&&a.ID,date:l},[4,i.o_.service("bitrix/callingtasks","post","tasks",c)];case 1:return(s=u.sent())&&e(o.setPrimrtiveStateProp(D.u$.PLAN,s)),[2]}}))}))}},le=function getBitrixItems(e){return function(t,n){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var r,a,l,c,s,i,u,p,b,g,y,v,E;return calling_thunk_generator(this,(function(S){switch(S.label){case 0:return Number(e.options.ID),null,e.placement.includes(D.u7.LEAD)?D.u7.LEAD:e.placement.includes(D.u7.COMPANY)&&D.u7.COMPANY,r=n(),a=null,l=r.app.domain,c=r.calling[D.u$.RESPONSIBILITY].current,e.placement.includes(D.u7.LEAD)?(s=Number(e.options.ID),(u=d.db)?[4,m.l.getLead(s)]:[3,2]):[3,5];case 1:u=S.sent(),S.label=2;case 2:return(i=u)?(v={domain:l,leadId:s,userId:null==c?void 0:c.ID},[4,ne.service("smart/item/fromlead",f.b.POST,"data",v)]):[3,4];case 3:(a=S.sent())&&(a.ufCrm10_1709111529&&t(o.setPresentationCount(a.ufCrm10_1709111529,"smart")),a.ufCrm6_1709894507&&t(o.setPresentationCount(a.ufCrm6_1709894507,"smart")),t(o.setPrimrtiveStateProp(D.u$.SMART,a)),a.stageId&&("DT162_26:SUCCESS"!==a.stageId&&"DT156_12:SUCCESS"!==a.stageId||t(o.setSaleComplete()))),i&&(t(o.setPrimrtiveStateProp(D.u$.LEAD,i)),p=n().calling[D.u$.LEAD],t(o.setFullCompleteStatus(p))),S.label=4;case 4:return[3,10];case 5:return e.placement.includes(D.u7.COMPANY)?(b=Number(e.options.ID),(y=d.db)?[4,m.l.getCompany(b)]:[3,7]):[3,10];case 6:y=S.sent(),S.label=7;case 7:return(g=y)?(v={domain:l,companyId:b,userId:null==c?void 0:c.ID},[4,ne.service("smart/item",f.b.POST,"data",v)]):[3,10];case 8:return(a=S.sent())&&(a.ufCrm10_1709111529&&t(o.setPresentationCount(a.ufCrm10_1709111529,"smart")),a.ufCrm6_1709894507&&t(o.setPresentationCount(a.ufCrm6_1709894507,"smart")),t(o.setPrimrtiveStateProp(D.u$.SMART,a)),a.stageId&&("DT162_26:SUCCESS"!==a.stageId&&"DT156_12:SUCCESS"!==a.stageId||t(o.setSaleComplete()))),g?(g.UF_CRM_1709807026&&t(o.setPresentationCount(g.UF_CRM_1709807026,"company")),[4,t(o.setPrimrtiveStateProp(D.u$.COMPANY,g))]):[3,10];case 9:S.sent(),E=n().calling[D.u$.COMPANY],t(o.setFullCompleteStatus(E)),S.label=10;case 10:return[2]}}))}))}},ce=function createTask(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,i,u,d,m,f,b,g,y,v,E,S,_;return calling_thunk_generator(this,(function(A){switch(A.label){case 0:return n=t(),r=n.app.domain,n.app.company,a=n.calling,l=a[D.u$.RESPONSIBILITY].current,c=a[D.u$.CREATED_BY].current,s=a[D.u$.TYPE].current,i=a[D.u$.NAME],u=a[D.u$.DESCRIPTION],d=a[D.u$.DATE],s&&i&&l&&c&&d?[3,1]:(alert("Не заполнено обязательное поле"),[3,5]);case 1:return m=n.calling[D.u$.SALE],f=m.questionStatus,!m.isSaleComplete||f?[3,2]:(e(o.setSaleQuestionStatus(!0)),[3,4]);case 2:return e((0,Z.Z)(!0)),e(o.setSaleQuestionStatus(!1)),b=(0,p.GP)(new Date(d),"dd.MM.yyyy HH:mm:ss"),g=a.placement,y=null,v=a[D.u$.COMPANY],E=a[D.u$.SMART],S=a[D.u$.IS_ONE_MORE],g&&g.options&&(y=g.options.ID),[4,re.create(s.name,r,y,b,"user_".concat(l.ID),"user_".concat(c.ID),i,u,null,v,E,m,S,g)];case 3:A.sent(),_="Звонок запланирован",s.name===D.YI.PRESENTATION&&(_="Презентация запланирована"),e(o.setFinishStatus(!0,_)),A.label=4;case 4:e((0,Z.Z)(!1)),A.label=5;case 5:return[2]}}))}))}},se=n(6540);const oe=(0,c.Ng)((function mapSTate(e){return{domain:e.app.domain,currentUser:e.app.currentUser,responsibility:e.calling.responsibility,createdBy:e.calling.createdBy,name:e.calling.name,type:e.calling.type,plan:e.calling.plan,date:e.calling.date,current:{responsibility:e.calling.responsibility.current,createdBy:e.calling.createdBy.current,type:e.calling.type.current,date:e.calling.type.date,time:e.calling.type.time,name:e.calling.type.name,description:e.calling.type.description},sale:e.calling.sale,presentation:e.calling.presentation,isFullComplete:e.calling.isFullComplete,isOneMore:e.calling.isOneMore,isUnplannedPresentation:e.calling.isUnplannedPresentation,isFinish:e.calling.isFinish,result:e.calling.result,isMenuActive:e.result.isActive,report:e.report.report}}),{initialCalling:function initialCalling(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,u,p;return calling_thunk_generator(this,(function(f){switch(f.label){case 0:return(r=d.db)?[4,m.l.getPlacement()]:[3,2];case 1:r=f.sent(),f.label=2;case 2:return n=r,e(o.setFinishStatus(!1,"")),a=null,n&&n.placement&&(a=n,console.log("initialCalling calling placement"),console.log(a)),l=t(),c=l.app.domain,s=l.app.currentUser,u=null,p={domain:c},[4,i.o_.service("bitrix/departament","post","departament",p)];case 3:return(u=f.sent())&&e(o.setFetchedDepartament(u,s,a,c)),e(ae()),n&&n.options?e(le(n)):e(o.setFullCompleteStatus(!0)),t(),[2]}}))}))}},setCurentCallingProp:function setCurentCallingProp(e,t){return function(n,r){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var a,l,c,s,u,p,d,m,f;return calling_thunk_generator(this,(function(b){switch(b.label){case 0:switch(a=r(),l=a.app.domain,e){case D.u$.RESPONSIBILITY:case D.u$.CREATED_BY:return[3,1];case D.u$.TYPE:return[3,3];case D.u$.NAME:case D.u$.DESCRIPTION:case D.u$.IS_ONE_MORE:case D.u$.IS_UNPLANNED_PRESENTATION:return[3,4]}return[3,5];case 1:return c=a.calling[e].items,s=c.find((function(e){return e.ID==t})),n(o.setPrimrtiveStateProp(e,s)),u=a.calling[D.u$.DATE],p={domain:l,userId:s.ID,date:u},[4,i.o_.service("bitrix/callingtasks","post","tasks",p)];case 2:return(d=b.sent())&&n(o.setPrimrtiveStateProp(D.u$.PLAN,d)),[3,6];case 3:return m=a.calling[e].items,f=m.find((function(e){return e.id==t})),n(o.setPrimrtiveStateProp(e,f)),[3,6];case 4:return n(o.setPrimrtiveStateProp(e,t)),[3,6];case 5:return[3,6];case 6:return[2]}}))}))}},getCallingPlan:ae,changeDeadline:function changeDeadline(e){return function(t,n){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var r,a,l,c,s,u,p;return calling_thunk_generator(this,(function(d){switch(d.label){case 0:return r=n(),a=r.app.domain,l=r.calling[D.u$.RESPONSIBILITY].current,c=e.split("T"),s=c[0],u={domain:a,userId:l&&l.ID,date:s},[4,i.o_.service("bitrix/callingtasks","post","tasks",u)];case 1:return(p=d.sent())&&t(o.setPrimrtiveStateProp(D.u$.PLAN,p)),t(o.setPrimrtiveStateProp(D.u$.DATE,e)),[2]}}))}))}},createTask:ce,fail:function fail(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,o;return calling_thunk_generator(this,(function(i){switch(i.label){case 0:return e((0,Z.Z)(!0)),n=t(),r=n.app.domain,a=n.calling,l=a[D.u$.SMART],c=a[D.u$.RESPONSIBILITY].current,s=a.placement,o=null,s&&s.options&&(o=s.options.ID),[4,re.fail(r,o,s,"user_".concat(c.ID),l)];case 1:return i.sent(),e((0,Z.Z)(!1)),[2]}}))}))}},presentationDone:function presentationDone(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,o,i,u;return calling_thunk_generator(this,(function(p){switch(p.label){case 0:return e((0,Z.Z)(!0)),n=t(),r=n.app.domain,a=n.calling,l=a.placement,c=null,s=n.calling[D.u$.COMPANY],o=n.calling[D.u$.SMART],i=n.calling[D.u$.IS_UNPLANNED_PRESENTATION],u=a[D.u$.RESPONSIBILITY].current,l&&l.options&&(c=l.options.ID),[4,re.presentationDone(r,c,l,"user_".concat(u.ID),s,o,i)];case 1:return p.sent(),e((0,Z.Z)(!1)),[2]}}))}))}},setFinishStatus:o.setFinishStatus,setMenuStatus:E})((function ResultMenuContainer(e){var t=e.domain,n=e.responsibility,r=e.createdBy,a=e.name,c=e.type,o=e.date,i=e.plan,u=e.current,p=e.sale,d=e.presentation,m=e.setCurentCallingProp,f=e.initialCalling,b=(e.getCallingPlan,e.changeDeadline),g=e.createTask,y=e.fail,v=e.presentationDone,E=e.isFullComplete,S=e.isFinish,_=(e.result,e.isOneMore),A=e.isUnplannedPresentation,h=e.isMenuActive,C=e.report,T=(e.setFinishStatus,e.setMenuStatus),I=(0,s.useState)(!1),w=(0,l.A)(I,2),P=w[0],N=w[1],O=(0,s.useState)(S),x=(0,l.A)(O,2),R=x[0],D=x[1];return(0,s.useEffect)((function(){P||R||(f(),N(!0))}),[P,R]),(0,s.useEffect)((function(){S&&N(!1),D(S)}),[S]),h&&se.createElement(K,{success:!0,domain:t,currentUser:n,responsibility:n,createdBy:r,date:o,name:a,type:c,plan:i,current:u,sale:p,isOneMore:_,isUnplannedPresentation:A,isMenuActive:h,report:C,presentation:d,setCurentCallingProp:m,changeDeadline:b,createTask:g,fail:y,presentationDone:v,isFullComplete:E,setMenuStatus:T})}));const ie=function CallingReportTable(e){var t=e.tasks,n=e.setResultMenuStatus;return s.createElement(s.Fragment,null,s.createElement(h.A,null,s.createElement(C.A,{xl:12},s.createElement("div",{className:"table-responsive p-4 calling__page__wrapper"},s.createElement("div",{className:"table-responsive"},s.createElement(T.A,{className:"align-middle mb-0"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",null,"#"),s.createElement("th",null,"Что надо сделать"),s.createElement("th",null,"Тип"),s.createElement("th",null,"Крайний срок"),s.createElement("th",null,"Текущий статус"),s.createElement("th",null,"Действие"))),s.createElement("tbody",null,t&&t.length&&t.map((function(e,t){return s.createElement("tr",null,s.createElement("th",{scope:"row"},t+1),s.createElement("td",null,e.name),s.createElement("td",null,e.type),s.createElement("td",null,e.deadline),s.createElement("td",null,"no"===e.isExpired?s.createElement("span",{className:"statusSuccess"},"Запланирован"):"yes"===e.isExpired?s.createElement("span",{className:"statusWarning"},"Просрочен"):s.createElement("span",{className:"statusExpired"},"Скоро")),s.createElement("td",null,s.createElement("div",{className:"actionsCell"},s.createElement("button",{type:"button",className:"btn btn-sm  mr-5 badge__star",onClick:function onClick(){return n(!0,"result")}},"Результативный"),s.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__error",onClick:function onClick(){return n(!0,"noresult")}},"Не очень"))))})))))))))};const ue=function CallingFinish(e){var t=e.result,n=e.setFinishStatus;return s.createElement(s.Fragment,null,s.createElement("div",{className:"account-pages my-5 pt-2"},s.createElement(k.A,null,s.createElement(h.A,null,s.createElement(C.A,{lg:"12"},s.createElement("div",{className:"text-center mb-2"},s.createElement("h1",{className:"display-2 fw-medium"},s.createElement("i",{className:"bx bx-buoy bx-spin text-primary display-3"})),s.createElement("h4",{className:"text-uppercase"},t),s.createElement("div",{className:"mt-3 \r d-flex\r justify-content-center\r align-items-center\r "},s.createElement(O.A,{onClick:function startHendler(){n(!1,"")},className:"btn\r col-md-3\r calling-button\r d-flex justify-content-center\r bg-success\r pointer\r ",size:"sm"},"Запланировать еще"))))),s.createElement(h.A,{className:"justify-content-center"},s.createElement(C.A,{md:"8",xl:"6"})))))};var pe=n(6540);const de=(0,c.Ng)((function mapSTate(e){return{domain:e.app.domain,currentUser:e.app.currentUser,responsibility:e.calling.responsibility,tasks:e.report.tasks,isMenuActive:e.result.isActive,isFinish:e.calling.isFinish,result:e.calling.result}}),{initialCallingReport:function initialCallingReport(){return function(e,t){return report_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,o,u,p,b;return report_thunk_generator(this,(function(v){switch(v.label){case 0:return n=t(),console.log("initialCallingReport"),console.log(n),r=n.app.domain,a=n.app.currentUser,(c=d.db)?[4,m.l.getPlacement()]:[3,2];case 1:c=v.sent(),v.label=2;case 2:return l=c,s={domain:r||d.Ss,userId:a||d.wV,placement:l||{placement:"COMPANY",options:{ID:d.pY}}},console.log("placement",l),[4,i.o_.service("bitrix/callingreport",f.b.POST,"tasks",s)];case 3:return o=v.sent(),u={domain:r||d.Ss,userId:a||d.wV},[4,i.o_.service("front/portal",f.b.POST,"portal",u)];case 4:return p=v.sent(),d.db&&p&&e(function getHistory(e){return function(t,n){return __awaiter(void 0,void 0,void 0,(function(){var t,n,r;return __generator(this,(function(a){switch(a.label){case 0:return e?(null==(t=e.bitrixLists.find((function(e){return e.group==y.O.SALES&&"history"==e.type})))||t.bitrixfields,n={IBLOCK_TYPE_ID:"lists",IBLOCK_ID:null==t?void 0:t.bitrixId},[4,m.l.getMethod("lists.element.get",n)]):[3,2];case 1:r=a.sent(),console.log("items"),console.log(r),a.label=2;case 2:return[2]}}))}))}}(p)),o&&o.length&&(b=o.map((function(e){var t=_(e.title),n=t.type;return{name:t.name,type:n,isExpired:S(e),deadline:A(e.deadline)}})),e(g.Tb.setFetchedTasks(b))),t(),[2]}}))}))}},setFinishStatus:o.setFinishStatus,setResultMenuStatus:E})((function CallingReportContainer(e){var t=e.domain,n=e.responsibility,r=e.isFinish,a=e.result,c=e.setFinishStatus,o=e.isMenuActive,i=e.tasks,u=e.initialCallingReport,p=e.setResultMenuStatus,d=(0,s.useState)(!1),m=(0,l.A)(d,2),f=m[0],b=m[1],g=(0,s.useState)(r),y=(0,l.A)(g,2),v=y[0],E=y[1];return(0,s.useEffect)((function(){f||v||(u(),b(!0))}),[f,v]),(0,s.useEffect)((function(){r&&b(!1),E(r)}),[r]),v?pe.createElement(ue,{result:a,setFinishStatus:c}):f&&pe.createElement(pe.Fragment,null,o?pe.createElement(oe,null):pe.createElement(ie,{domain:t,responsibility:n,tasks:i,setResultMenuStatus:p}))}))},6750:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(6540),a=n(6229);const l=function Logo(){return r.createElement("img",{className:"logo",src:a,alt:"logo"})};n(4003),n(9245);var c=n(6540);const s=function Gradient(e){e.isResized;var t=e.isActive,n=(e.currentRoute,(0,r.useRef)(null));return(0,r.useEffect)((function(){}),[]),c.createElement("div",{ref:n,className:"monohrom__containerApril"},c.createElement("div",{className:"content__wrapper"},c.createElement("div",{className:"newchildren__wrapper"},c.createElement(l,null)),t&&c.createElement("p",{className:"loader__title"},"Загрузка  . . .")))};const o=(0,n(9733).Ng)((function mapStateToProps(e,t){return{isResized:e.app.isResized,isActive:t.isActive}}),{})(s);var i=n(6540);const u=function Preloader(e){var t=e.currentRoute;return i.createElement(o,{currentRoute:t,isActive:!0},i.createElement(l,null))}},6745:(e,t,n)=>{n.d(t,{Ay:()=>I,Fc:()=>C,Vh:()=>h});var r=n(4705),a=n(467),l=n(4756),c=n.n(l),s=n(4003),o=n(9002),i=n(8205),u=n(8329),p=n(9245),d=n(1715);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m="SET_APP_DEAL",f="SET_RESIZE_STATUS",b="SET_APP_DATA",g="SET_APP_BITRIX_DATA",y="SET_INITIALIZED_SUCCESS",v={domain:"",company:null,user:"",currentUser:null,token:"",dealId:null,bitrix:{company:null,deal:null,lead:null},isResized:!1,initialized:!1},E=function setAppData(e,t,n,r,a,l){return{type:b,domain:e,companyId:t,userId:n,currentUser:r,token:a,dealId:l}},S=function setAppBitrixData(e,t){return{type:g,company:e,deal:t}},_=function setResizeStatus(e){return{type:f,boolean:e}},A=function setInitializedSuccess(){return{type:y}},h=function initial(){return function(){var e=(0,a.A)(c().mark((function _callee(e,t){var n,r,a,l,o;return c().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e((0,u.Z)(!0)),n=t(),r=n.router.current,i.db&&r.route===p.a$.CALLING&&e(T()),!i.db){c.next=10;break}return c.next=7,s.l.getDomain();case 7:c.t0=c.sent,c.next=11;break;case 10:c.t0=null;case 11:if(a=c.t0,l=a||i.Ss,!r||!r.route){c.next=29;break}if(r.route!==p.a$.CALLING){c.next=26;break}if(c.t1=i.db,!c.t1){c.next=20;break}return c.next=19,s.l.getCurrentUser();case 19:c.t1=c.sent;case 20:o=c.t1,console.log({type:p.xY.KONSTRUCTOR,domain:l,currentUser:o,placementCompanyId,placementDealId,token}),o&&o.ID&&e(C(p.xY.KONSTRUCTOR,l,o,o.ID,placementCompanyId,placementDealId,token)),e(A()),c.next=29;break;case 26:e(E(l,null,null,null,"",null)),e(A()),e((0,u.Z)(!1));case 29:e((0,p._t)(p.xY.CALLING,!1)),e((0,u.Z)(!1));case 31:case"end":return c.stop()}}),_callee)})));return function(t,n){return e.apply(this,arguments)}}()},C=function getBitrixData(e,t,n,r,l,u,m){return function(){var f=(0,a.A)(c().mark((function _callee2(a,f){var b,g,y,v,_,A,h,C;return c().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:if(null,null,b={currentCompany:null,currentDeal:null},g=null,y=null,v=!1,!i.db){c.next=12;break}return c.next=9,s.l.getDealAndCompany(u,l);case 9:b=c.sent,c.next=22;break;case 12:if(!l){c.next=17;break}return _={domain:t,companyId:l},c.next=16,o.o_.service("bitrixcompany",d.b.POST,"company",_);case 16:b.currentCompany=c.sent;case 17:if(!u){c.next=22;break}return A={domain:t,dealId:u},c.next=21,o.o_.service("bitrixdeal",d.b.POST,"deal",A);case 21:b.currentCompany=c.sent;case 22:h=b.company,C=b.deal,h&&h.ID&&(g=h.ID),C&&C.ID&&(y=C.ID),a(E(t,g,r,n,m,y)),a(S(h,C)),a((0,p._t)(e,v));case 29:case"end":return c.stop()}}),_callee2)})));return function(e,t){return f.apply(this,arguments)}}()},T=function getResizeCalling(){return function(){var e=(0,a.A)(c().mark((function _callee5(e,t){return c().wrap((function _callee5$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.l.getResizeCalling();case 2:e(_(!0));case 3:case"end":return t.stop()}}),_callee5)})));return function(t,n){return e.apply(this,arguments)}}()};const I=function app(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return _objectSpread(_objectSpread({},e),{},{domain:t.domain,company:t.companyId,user:t.userId,token:t.token,dealId:t.dealId,currentUser:t.currentUser});case g:return _objectSpread(_objectSpread({},e),{},{bitrix:_objectSpread(_objectSpread({},e.bitrix),{},{company:t.company,deal:t.deal}),initialized:!0});case m:return _objectSpread(_objectSpread({},e),{},{dealId:t.dealId,bitrix:_objectSpread(_objectSpread({},e.bitrix),{},{deal:t.deal})});case f:return _objectSpread(_objectSpread({},e),{},{isResized:t.status});case y:return _objectSpread(_objectSpread({},e),{},{initialized:!0});default:return e}}},8329:(e,t,n)=>{n.d(t,{A:()=>s,Z:()=>c});var r=n(4705);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a={inProgress:!0},l="PRELOADER",c=function setPreloader(e){return{type:l,bool:e}};const s=function preloader(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;return t.type===l&&e.inProgress!==t.bool?_objectSpread(_objectSpread({},e),{},{inProgress:t.bool}):e}},9002:(e,t,n)=>{n.d(t,{o_:()=>A});var r=n(467),a=n(4705),l=n(4756),c=n.n(l),s=n(8205),o=n(1715),i=n(6266);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=i.A.create({baseURL:s.R4?"http://localhost:8000/api":"https://april-online.ru/api",withCredentials:!0,headers:(0,a.A)((0,a.A)((0,a.A)({"content-type":"application/json",accept:"application/json"},"accept","application/json"),"X-Requested-With","XMLHttpRequest"),"X-API-KEY","e0336d3b27299e405a344d2475627c5810eab829a4e5c1214e452e20519d5984")});i.A.create({baseURL:s.R4?"http://localhost:8000":"https://april-online.ru",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}});g=(0,r.A)(c().mark((function _callee3(){var e,t,n;return c().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return e=null,r.prev=1,r.next=4,u.get("profile");case 4:return t=r.sent,(n=t.data)&&(0===n.resultCode?e=n.deal:n.message),r.abrupt("return",e);case 10:return r.prev=10,r.t0=r.catch(1),r.abrupt("return",e);case 13:case"end":return r.stop()}}),_callee3,null,[[1,10]])}))),b=(0,r.A)(c().mark((function _callee4(e){var t,n;return c().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.prev=1,r.next=4,u.post("deal",_objectSpread({},e));case 4:return(n=r.sent)&&(0===n.resultCode?t=n.deal:n.message),r.abrupt("return",t);case 9:return r.prev=9,r.t0=r.catch(1),r.abrupt("return",t);case 12:case"end":return r.stop()}}),_callee4,null,[[1,9]])}))),f=(0,r.A)(c().mark((function _callee5(e,t){var n,r,a;return c().wrap((function _callee5$(l){for(;;)switch(l.prev=l.next){case 0:return n=null,l.prev=1,l.next=4,u.post("getDeal",{dealId:e,domain:t});case 4:return r=l.sent,(a=r.data)&&0===a.resultCode&&(n=a.deal),l.abrupt("return",n);case 10:return l.prev=10,l.t0=l.catch(1),l.abrupt("return",n);case 13:case"end":return l.stop()}}),_callee5,null,[[1,10]])}))),m=(0,r.A)(c().mark((function _callee6(e,t,n,r,a){var l,s,o,i;return c().wrap((function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:return l=null,c.prev=1,c.next=4,u.post("getDescription",{domain:e,userId:t,complect:n,infoblocks:r,groups:a});case 4:if(!(s=c.sent)||!s.data||0!==s.data.resultCode){c.next=9;break}return o=s.data.file,i=s.data.fileBase64,c.abrupt("return",{link:o,file:i});case 9:c.next=14;break;case 11:return c.prev=11,c.t0=c.catch(1),c.abrupt("return",l);case 14:case"end":return c.stop()}}),_callee6,null,[[1,11]])}))),d=(0,r.A)(c().mark((function _callee7(e,t,n,r,a){var l,s;return c().wrap((function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:return l=null,c.prev=1,c.next=4,u.post("get/offer",{domain:e,userId:t,complect:n,infoblocks:r,groups:a});case 4:(s=c.sent)&&s.data&&s.data.resultCode,c.next=11;break;case 8:return c.prev=8,c.t0=c.catch(1),c.abrupt("return",l);case 11:case"end":return c.stop()}}),_callee7,null,[[1,8]])}))),p=(0,r.A)(c().mark((function _callee8(e,t,n){var r,a;return c().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,u.post("get/offer",{domain:e,userId:t,complect,infoblocks,groups});case 4:(a=n.sent)&&a.data&&a.data.resultCode,n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",r);case 11:case"end":return n.stop()}}),_callee8,null,[[1,8]])})));var p,d,m,f,b,g,y,v,E,S,_,A={getCollection:(E=(0,r.A)(c().mark((function _callee9(e,t,n,r){var a,l;return c().wrap((function _callee9$(c){for(;;)switch(c.prev=c.next){case 0:if(a=null,c.prev=1,r){c.next=8;break}return c.next=5,u[t](e);case 5:c.t0=c.sent,c.next=11;break;case 8:return c.next=10,u[t](e,r);case 10:c.t0=c.sent;case 11:if(!(l=c.t0)){c.next=15;break}return l.data&&0===l.data.resultCode&&l.data[n]&&(a=l.data.isCollection?l.data[n].data:l.data[n]),c.abrupt("return",a);case 15:c.next=20;break;case 17:return c.prev=17,c.t1=c.catch(1),c.abrupt("return",a);case 20:case"end":return c.stop()}}),_callee9,null,[[1,17]])}))),function getCollection(e,t,n,r){return E.apply(this,arguments)}),setCollection:(v=(0,r.A)(c().mark((function _callee10(e,t){var n,r,l;return c().wrap((function _callee10$(c){for(;;)switch(c.prev=c.next){case 0:return n=null,c.prev=1,r=(0,a.A)({},e,t),c.next=5,u.post(e,r);case 5:return(l=c.sent)&&0===l.data.resultCode&&(n=l.data.data),c.abrupt("return",n);case 10:return c.prev=10,c.t0=c.catch(1),c.abrupt("return",n);case 13:case"end":return c.stop()}}),_callee10,null,[[1,10]])}))),function setCollection(e,t){return v.apply(this,arguments)}),service:(y=(0,r.A)(c().mark((function _callee11(e,t,n,r){var a,l;return c().wrap((function _callee11$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,u[t](e,r);case 4:return(l=c.sent)&&l.data&&(0===l.data.resultCode?a=l.data.data?l.data.data[n]:l.data[n]:1===l.data.resultCode&&(l.data.message?console.log("".concat(n," ").concat(l.data.message)):console.log(l))),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee11,null,[[1,9]])}))),function service(e,t,n,r){return y.apply(this,arguments)})},h=(S=(0,r.A)(c().mark((function _callee12(e,t,n,r,l,s,i,p,d,m,f,b,g,y,v,E,S,_){var A,h,C,T,I,w,P,N,O,x,R,D;return c().wrap((function _callee12$(c){for(;;)switch(c.prev=c.next){case 0:return C=null,T={FIELDS:(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},y.dealName.bitrixId,"".concat(t)),y.assigned.bitrixId,n),y.category.bitrixId,y.category.value),y.stage.bitrixId,y.stage.value),y.opened.bitrixId,y.opened.value),"PROBABILITY",30),"OPPORTUNITY",0),"CURRENCY_ID","RUB"),"UF_CRM_5B39D7C2EC0AB",!0),PARAMS:{REGISTER_SONET_EVENT:"Y"}},I=isNaN(+E.contractSupplyPropSuppliesQuantity)?1:+E.contractSupplyPropSuppliesQuantity,w=S?S.contractConsaltingProp:E.contractConsaltingProp,P=S?S.contractConsaltingComment:E.contractConsaltingComment,N={id:r,fields:(A={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(A,g.contract.bitrixId,l),g.companyId.bitrixId,s),g.npa.bitrixId,i.npa),g.la.bitrixId,i.la),g.c.bitrixId,i.c),g.sp.bitrixId,i.sp),g.er.bitrixId,p.er),g.per.bitrixId,p.per),g.erinpac.bitrixId,p.erinpac),g.lt.bitrixId,m.lt),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(A,g.plt.bitrixId,m.plt),g.ltinpac.bitrixId,m.ltinpac),g.freeBlocks.bitrixId,d),g.consalting.bitrixId,f),g.field_14.bitrixId,b),y.category.bitrixId,y.category.value),y.stage.bitrixId,"C".concat(y.category.value,":NEW"))),PARAMS:{REGISTER_SONET_EVENT:"Y"}},O={id:r,fields:(h={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(h,v.complectName.bitrixId,E.name),v.abonementTime.bitrixId,1===E.contractCoefficient?null:E.contractCoefficient),v.consalting.bitrixId,w),v.note2.bitrixId,P),v.hdd.bitrixId,E.contractSupplyProp1?E.contractSupplyProp1:""),v.way.bitrixId,E.contractSupplyProp2?E.contractSupplyProp2:""),v.note.bitrixId,E.contractSupplyPropComment?E.contractSupplyPropComment:""),v.note3.bitrixId,E.contractSupplyPropEmail?E.contractSupplyPropEmail:""),v.supply.bitrixId,E.supplyName?E.supplyName:""),v.supplyForContract.bitrixId,E.contractSupplyName?E.contractSupplyName:""),(0,a.A)((0,a.A)((0,a.A)((0,a.A)(h,v.loginsQuantity.bitrixId,E.contractSupplyPropLoginsQuantity?E.contractSupplyPropLoginsQuantity:""),v.contractSupplyPropSuppliesQuantity.bitrixId,I),v.supplyForContract.bitrixId,E.contractSupplyName),v.field_1.bitrixId,E.quantityForKp))},x=_.map((function(e,t){var n=e.prepayment,a=e.price.current,l=e.price.default,c=l-a;return{id:e.id||e.number,priceNetto:l,price:a,discountSum:c,discountTypeId:1,ownerId:r,ownerType:"D",productName:"".concat(e.name," ").concat(e.supply.name),quantity:e.price.quantity||n,customized:"Y",supply:e.supplyName,measureCode:e.price.measure.code,measureId:e.price.measure.id,sort:t}})),R={domain:e,dealId:r,setDealData:T,updateDealInfoblocksData:N,updateDealContractData:O,setProductRowsData:{ownerType:"D",ownerId:r,productRows:x},updateProductRowsData:{id:null,fields:{priceNetto:null,price:null,discountSum:null,discountTypeId:1}}},c.prev=11,c.next=14,u[o.b.POST]("konstructor/bitrix/deal/update",R);case 14:return(D=c.sent)&&D.data&&(0===D.data.resultCode?D.data.data&&(C=D.data.data.dealId):1===D.data.resultCode&&(D.data.message?console.log("".concat(D.data.message)):console.log(D))),c.abrupt("return",C);case 19:return c.prev=19,c.t0=c.catch(11),c.abrupt("return",C);case 22:case"end":return c.stop()}}),_callee12,null,[[11,19]])}))),i.A.create({baseURL:"http://localhost:8000/api",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}}));_=(0,r.A)(c().mark((function _callee13(e,t,n,r){var a,l;return c().wrap((function _callee13$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,h[t](e,r);case 4:return(l=c.sent)&&l.data&&(0===l.data.resultCode?a=l.data.data?l.data.data[n]:l.data[n]:1===l.data.resultCode&&(l.data.message?console.log("".concat(n," ").concat(l.data.message)):console.log(l))),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee13,null,[[1,9]])})))},4003:(e,t,n)=>{n.d(t,{l:()=>h});var r=n(467),a=n(4705),l=n(4756),c=n.n(l),s=n(3953);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var o,i,u,p,d,m,f,b,g,y,v,E,S,_,A,h={getMethod:(A=(0,r.A)(c().mark((function _callee(e,t){var n,r;return c().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return n=null,a.prev=1,a.next=4,s.g9(e,t);case 4:return(r=a.sent)&&r.answer&&r.answer.result&&(n=r.answer.result),a.abrupt("return",n);case 9:return a.prev=9,a.t0=a.catch(1),console.log("error"),console.log(dealResponse),console.log(a.t0),a.abrupt("return",n);case 15:case"end":return a.stop()}}),_callee,null,[[1,9]])}))),function getMethod(e,t){return A.apply(this,arguments)}),getPlacement:(_=(0,r.A)(c().mark((function _callee2(){var e;return c().wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.ot.info();case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),_callee2)}))),function getPlacement(){return _.apply(this,arguments)}),getCompanyId:(S=(0,r.A)(c().mark((function _callee3(){var e,t;return c().wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,h.getPlacement();case 3:return e=n.sent,t=e.options.ID,n.abrupt("return",Number(t));case 8:return n.prev=8,n.t0=n.catch(0),n.abrupt("return",null);case 11:case"end":return n.stop()}}),_callee3,null,[[0,8]])}))),function getCompanyId(){return S.apply(this,arguments)}),getCurrentUserId:(E=(0,r.A)(c().mark((function _callee4(e){var t,n;return c().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.next=3,(0,s.g9)("crm.company.get",{id:e});case 3:return n=(n=r.sent).answer&&n.answer.result,t=n?n.ASSIGNED_BY_ID:null,r.abrupt("return",t);case 7:case"end":return r.stop()}}),_callee4)}))),function getCurrentUserId(e){return E.apply(this,arguments)}),getCurrentUser:(v=(0,r.A)(c().mark((function _callee5(){var e,t;return c().wrap((function _callee5$(n){for(;;)switch(n.prev=n.next){case 0:return e=null,n.prev=1,n.next=4,(0,s.g9)("user.current");case 4:return(t=n.sent)&&t.answer&&t.answer.result&&t.answer.result.ID&&(e=t.answer.result),n.abrupt("return",e);case 9:return n.prev=9,n.t0=n.catch(1),console.log(n.t0),n.abrupt("return",null);case 13:case"end":return n.stop()}}),_callee5,null,[[1,9]])}))),function getCurrentUser(){return v.apply(this,arguments)}),getResize:(y=(0,r.A)(c().mark((function _callee6(){var e,t;return c().wrap((function _callee6$(n){for(;;)switch(n.prev=n.next){case 0:return e=.9*window.screen.height,t=.73*window.screen.width,n.next=5,(0,s.Ru)(t,e);case 5:n.sent;case 6:case"end":return n.stop()}}),_callee6)}))),function getResize(){return y.apply(this,arguments)}),getResizeCalling:(g=(0,r.A)(c().mark((function _callee7(){return c().wrap((function _callee7$(e){for(;;)switch(e.prev=e.next){case 0:return window.screen.height,window.screen.width,e.next=5,(0,s.eQ)();case 5:e.sent;case 6:case"end":return e.stop()}}),_callee7)}))),function getResizeCalling(){return g.apply(this,arguments)}),getScroll:(b=(0,r.A)(c().mark((function _callee8(){var e,t;return c().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("scroll"),n.next=4,(0,s.TC)();case 4:return e=n.sent,console.log(e),n.next=8,(0,s.OO)(100);case 8:t=n.sent,console.log(t),n.next=14;break;case 12:n.prev=12,n.t0=n.catch(0);case 14:case"end":return n.stop()}}),_callee8,null,[[0,12]])}))),function getScroll(){return b.apply(this,arguments)}),getLead:(f=(0,r.A)(c().mark((function _callee9(e){var t,n;return c().wrap((function _callee9$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,console.log("crm.lead.get"),r.prev=2,r.next=5,s.g9("crm.lead.get",{id:e});case 5:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result,console.log(t)),r.abrupt("return",t);case 10:return r.prev=10,r.t0=r.catch(2),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 16:case"end":return r.stop()}}),_callee9,null,[[2,10]])}))),function getLead(e){return f.apply(this,arguments)}),getCompany:(m=(0,r.A)(c().mark((function _callee10(e){var t,n;return c().wrap((function _callee10$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,console.log("crm.company.get"),r.prev=2,r.next=5,s.g9("crm.company.get",{id:e,select:["TITLE","ID","UF_CRM_1706007840","UF_CRM_1706007882","UF_CRM_1706007856"]});case 5:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result,console.log(t)),r.abrupt("return",t);case 10:return r.prev=10,r.t0=r.catch(2),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 16:case"end":return r.stop()}}),_callee10,null,[[2,10]])}))),function getCompany(e){return m.apply(this,arguments)}),getDeal:(d=(0,r.A)(c().mark((function _callee11(e){var t,n;return c().wrap((function _callee11$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.prev=1,r.next=4,s.g9("crm.deal.get",{id:e,select:["TITLE","COMPANY_ID","ID","UF_CRM_1695372881","UF_CRM_1695373462","UF_CRM_1695373326"]});case 4:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result),r.abrupt("return",t);case 9:return r.prev=9,r.t0=r.catch(1),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 15:case"end":return r.stop()}}),_callee11,null,[[1,9]])}))),function getDeal(e){return d.apply(this,arguments)}),getDealAndCompany:(p=(0,r.A)(c().mark((function _callee12(){var e,t,n,r,a=arguments;return c().wrap((function _callee12$(l){for(;;)switch(l.prev=l.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:null,t=a.length>1&&void 0!==a[1]?a[1]:null,l.prev=2,n=null,r=null,t||!e){l.next=16;break}return l.next=8,h.getDeal(e);case 8:if(!(n=l.sent)||!n.COMPANY_ID){l.next=14;break}return t=n.COMPANY_ID,l.next=13,h.getCompany(t);case 13:r=l.sent;case 14:l.next=21;break;case 16:if(!t||e){l.next=21;break}return l.next=19,h.getCompany(t);case 19:r=l.sent,n&&n.COMPANY_ID&&(t=n.COMPANY_ID);case 21:return l.abrupt("return",{company:r,deal:n});case 24:return l.prev=24,l.t0=l.catch(2),console.error("Произошла ошибка при выполнении запроса",l.t0),l.abrupt("return",{company:null,deal:null});case 28:case"end":return l.stop()}}),_callee12,null,[[2,24]])}))),function getDealAndCompany(){return p.apply(this,arguments)}),getSmart:(u=(0,r.A)(c().mark((function _callee13(e){var t,n;return c().wrap((function _callee13$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,$method="/crm.item.list.json",$data={entityTypeId:e,filter:{"=assignedById":$userId,COMPANY_ID:$companyId}},r.prev=3,r.next=6,s.g9("crm.item.list",{id:dealId});case 6:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result.items),r.abrupt("return",t);case 11:return r.prev=11,r.t0=r.catch(3),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 17:case"end":return r.stop()}}),_callee13,null,[[3,11]])}))),function getSmart(e){return u.apply(this,arguments)}),getDomain:(i=(0,r.A)(c().mark((function _callee14(){var e;return c().wrap((function _callee14$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.xI();case 2:return t.sent,t.next=5,s.FB();case 5:return e=t.sent,t.abrupt("return",e);case 7:case"end":return t.stop()}}),_callee14)}))),function getDomain(){return i.apply(this,arguments)}),updateRecipient:(o=(0,r.A)(c().mark((function _callee15(e,t,n,r,a){var l,o,i,u,p,d,m,f,b;return c().wrap((function _callee15$(c){for(;;)switch(c.prev=c.next){case 0:if(!e&&!t){c.next=28;break}if(!(n||r||a)){c.next=28;break}return l={},o={},n&&(l.UF_CRM_1706007840=n,o.UF_CRM_1695372881=n),r&&(l.UF_CRM_1706007856=r,o.UF_CRM_1695373326=r),a&&(l.UF_CRM_1706007882=a,o.UF_CRM_1695373462=a),i={ID:e,FIELDS:_objectSpread({},o),PARAMS:{REGISTER_SONET_EVENT:"Y"}},u={ID:t,FIELDS:_objectSpread({},l),PARAMS:{REGISTER_SONET_EVENT:"Y"}},p="crm.company.update",d=null,m=null,c.prev=13,c.next=16,s.g9("crm.deal.update",_objectSpread({},i));case 16:return f=c.sent,c.next=19,s.g9(p,_objectSpread({},u));case 19:return b=c.sent,d=f.answer&&f.answer.result,m=b.answer&&b.answer.result,c.abrupt("return",{deal:d,company:m});case 25:return c.prev=25,c.t0=c.catch(13),c.abrupt("return",d);case 28:case"end":return c.stop()}}),_callee15,null,[[13,25]])}))),function updateRecipient(e,t,n,r,a){return o.apply(this,arguments)})}},7067:(e,t,n)=>{n.d(t,{Ay:()=>c,Tb:()=>l});var r,__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(r||(r={}));var a={tasks:null,isFetched:!1,isMenuActive:!0,report:{workStatus:{items:[{id:0,code:"inJob",name:"В работе"},{id:1,code:"setAside",name:"Отложено"},{id:2,code:"success",name:"Продажа"},{id:3,code:"fail",name:"Отказ"}],current:null,default:null},noresultReasone:{items:[{id:0,code:"secretar",name:"Секретарь"},{id:1,code:"nopickup",name:"Недозвон - трубку не берут"},{id:2,code:"nonumber",name:"Недозвон - номер не существует"},{id:3,code:"busy",name:"Занято"},{id:4,code:"notime",name:"Перенос - не было времени"},{id:5,code:"nocontact",name:"Контактера нет на месте"},{id:6,code:"giveup",name:"Просят оставить свой номер"},{id:7,code:"bay",name:"Не интересует, до свидания"},{id:8,code:"wrong",name:"По телефону отвечает не та организация"},{id:9,code:"auto",name:"Автоответчик"}],current:null,default:null},failType:{items:[{id:0,code:"garant",name:"Гарант/Запрет"},{id:1,code:"go",name:"Покупает ГО"},{id:2,code:"territory",name:"Чужая территория"},{id:3,code:"accountant",name:"Бухприх"},{id:4,code:"autsorc",name:"Аутсорсинг"},{id:5,code:"depend",name:"Несамостоятельная организация"},{id:6,code:"failure",name:"Отказ"}],current:null,default:null},failReason:{items:[{id:0,code:"fail_notime",name:"Не было времени"},{id:1,code:"c_habit",name:"Конкуренты - привыкли"},{id:2,code:"c_prepay",name:"Конкуренты - оплачено"},{id:3,code:"c_price",name:"Конкуренты - цена"},{id:4,code:"money",name:"Дорого/нет Денег"},{id:4,code:"money",name:"Дорого/нет Денег"},{id:5,code:"to_cheap",name:"Слишком дешево"},{id:6,code:"nomoney",name:"Нет денег"},{id:7,code:"noneed",name:"Не видят надобности"},{id:8,code:"lpr",name:"ЛПР против"},{id:9,code:"employee",name:"Ключевой сотрудник против"}],current:null,default:null}}},l={setFetchedTasks:function setFetchedTasks(e){return{type:"report/SET_FITCHED_TASKS",tasks:e}},setFetchedDepartament:function setFetchedDepartament(e,t,n,r){return{type:"report/SET_FITCHED_DEPARTAMENT",departament:e,currentUser:t,placement:n,domain:r}}};const c=function report(e,t){return void 0===e&&(e=a),"report/SET_FITCHED_TASKS"===t.type?__assign(__assign({},e),{tasks:t.tasks}):e}},2056:(e,t,n)=>{n.d(t,{Ay:()=>p,YI:()=>a,u$:()=>l,u7:()=>c});var r,a,l,c,s=n(291),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.COLD="cold",e.WARM="warm",e.PRESENTATION="presentation",e.HOT="hot",e.PAY="moneyAwait"}(a||(a={})),function(e){e.NAME="name",e.DESCRIPTION="description",e.RESPONSIBILITY="responsibility",e.CREATED_BY="createdBy",e.DATE="date",e.TIME="time",e.TYPE="type",e.STATUS="status",e.CRM="crm",e.PLAN="plan",e.COMPANY="company",e.LEAD="lead",e.SMART="smart",e.SALE="sale",e.PRESENTATION="presentation",e.IS_ONE_MORE="isOneMore",e.IS_UNPLANNED_PRESENTATION="isUnplannedPresentation"}(l||(l={})),function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(c||(c={}));var o=function getInitialDate(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);return{first:(0,s.GP)(t,"yyyy-MM-dd"),current:(0,s.GP)(e,"yyyy-MM-dd HH:mm:ss")}},i=[{id:1,name:a.WARM,title:"Звонок"},{id:2,name:a.PRESENTATION,title:"Презентация"},{id:3,name:a.HOT,title:"Решение"},{id:4,name:a.PAY,title:"Оплата"}],u=((r={})[l.RESPONSIBILITY]={items:[],current:null},r[l.CREATED_BY]={items:[],current:null},r.type={items:i,current:{id:1,name:a.WARM,title:"Звонок"}},r.name="",r[l.DESCRIPTION]="",r.date=o().current,r.time=null,r.plan=[],r.placement=null,r.groupId=28,r.company=null,r.smart=null,r[l.SALE]={isActive:!1,questionStatus:!1,isSaleComplete:!1,isCreateNewSale:!1,questions:{new:{id:0,title:"Уже сделана продажа этому клиенту",isActive:!0,value:!0,isAnswered:!1}}},r.presentation={companyCount:0,smartCout:0},r[l.IS_ONE_MORE]=!1,r[l.IS_UNPLANNED_PRESENTATION]=!1,r.isFullComplete=!1,r.isFinish=!1,r.result="",r);const p=function calling(e,t){var n,r,c;switch(void 0===e&&(e=u),t.type){case"callings/SET_FITCHED_CALLINGS":return __assign(__assign({},e),{calling:t.callings});case"callings/SET_FITCHED_DEPARTAMENT":var s=t.currentUser?t.currentUser:t.departament[0],p=107;return"alfacentr.bitrix24.ru"===t.domain&&(p=158),__assign(__assign({},e),{responsibility:__assign(__assign({},e.responsibility),{items:t.departament,current:s}),createdBy:__assign(__assign({},e.createdBy),{items:t.departament,current:{ID:p}}),placement:t.placement});case"callings/SET_STATE_PROP":switch(t.name){case l.RESPONSIBILITY:case l.CREATED_BY:case l.TYPE:return __assign(__assign({},e),((n={})[t.name]=__assign(__assign({},e[t.name]),{current:t.value}),n));default:return __assign(__assign({},e),((r={})[t.name]=t.value,r))}case"callings/SET_SALE_COMPLETE":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{isSaleComplete:!0})});case"callings/SET_IS_NEW_SALE_STATUS":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{isCreateNewSale:t.status})});case"callings/SET_SALE_ANSWER_STATUS":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{questionStatus:t.status})});case"callings/SET_SALE_QUESTION_STATUS":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{isActive:t.status})});case"callings/SET_PRESENTATION_COUNT":var d=__assign({},e.presentation);return"company"==t.entityType?d.companyCount=t.count:"smart"==t.entityType&&(d.smartCout=t.count),__assign(__assign({},e),{presentation:__assign(__assign({},e.presentation),d)});case"callings/SET_FULL_COMPLETE_STATUS":return __assign(__assign({},e),{isFullComplete:t.status});case"callings/SET_FINISH_STATUS":return(c={})[l.RESPONSIBILITY]={items:[],current:null},c[l.CREATED_BY]={items:[],current:null},c.type={items:i,current:{id:1,name:a.WARM,title:"Звонок"}},c.name="",c[l.DESCRIPTION]="",c.date=o().current,c.time=null,c.plan=[],c.placement=null,c.groupId=28,c.company=null,c.smart=null,c[l.SALE]={isActive:!1,questionStatus:!1,isSaleComplete:!1,isCreateNewSale:!1,questions:{new:{id:0,title:"Уже сделана продажа этому клиенту",isActive:!0,value:!0,isAnswered:!1}}},c.presentation={companyCount:0,smartCout:0},c[l.IS_ONE_MORE]=!1,c[l.IS_UNPLANNED_PRESENTATION]=!1,c.isFullComplete=!1,c.isFinish=t.status,c.result=t.result,c;default:return e}}},9245:(e,t,n)=>{n.d(t,{QB:()=>u,_t:()=>o,a$:()=>r,xY:()=>a});var r,a,l=n(8329),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.GLOBAL="global",e.KONSTRUCTOR="konstructor",e.PRODUCTS="products",e.TEMPLATE="template",e.DOCUMENT="document",e.REPORT="report",e.CALLING="calling",e.TRANSKRIBATION="transcribation",e.FINISH="finish"}(r||(r={})),function(e){e.KONSTRUCTOR="konstructor",e.REPORT="report",e.CALLING="calling",e.TRANSKRIBATION="transcribation"}(a||(a={}));var c={routes:[{id:0,name:"Начальные настройки",route:r.GLOBAL},{id:1,name:"Конструктор",route:r.KONSTRUCTOR},{id:2,name:"Цены и сравнение комплектов",route:r.PRODUCTS},{id:3,name:"Выбор Шаблона",route:r.TEMPLATE},{id:4,name:"Документ",route:r.DOCUMENT},{id:5,name:"Отчет",route:r.REPORT},{id:6,name:"Звонки",route:r.CALLING},{id:7,name:"Транскрибация",route:r.TRANSKRIBATION},{id:8,name:"Финиш",route:r.FINISH}],current:{id:6,name:"Звонки",route:r.CALLING},previous:null,next:null},s=function setCurrentRoute(e){return{type:"router/SET_CURRENT",id:e}},o=function setInitialRoute(e,t){return function(e,t){e(i(r.CALLING))}},i=function navigate(e){return function(t,n){console.log("navigate "+e);var r=n().router.routes.find((function(t){return t.route===e}));if(r){var a=r.id;t(s(a))}t((0,l.Z)(!1))}},u=function router(e,t){if(void 0===e&&(e=c),"router/SET_CURRENT"===t.type){var n=e.routes.find((function(e){return e.id==t.id})),r=e.current,a=e.previous;return n?__assign(__assign({},e),{current:n,previous:r,next:a}):e}return e}},5376:(e,t,n)=>{n.d(t,{A:()=>S});var r=n(2960),a=n(1265),l=n(6745),c=n(8329),s=n(9245),o=n(2056),i=n(4705);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u="SET_TOP_DISPLAY_STATUS",p="SET_SCROLL_TOP_STATUS",d={isTopDisplayShowing:!0,scrollTop:!1};const m=function display(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return _objectSpread(_objectSpread({},e),{},{isTopDisplayShowing:t.status});case p:return _objectSpread(_objectSpread({},e),{},{scrollTop:t.status});default:return e}};var f,b=n(7067),g=n(9508),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.RESULT="result",e.NORESULT="noresult",e.EXPIRED="expired"}(f||(f={}));var y={isActive:!1,type:null,fetchedKpiList:null};const v=function callingResult(e,t){switch(void 0===e&&(e=y),t.type){case"callings/result/SET_FITCHED_LIST":var n=t.portal.bitrixLists.find((function(e){return e.group==g.O.SALES}));return __assign(__assign({},e),{fetchedKpiList:n});case"callings/result/SET_MENU_STATUS":return __assign(__assign({},e),{isActive:t.status,type:t.status?t.menuType:null});default:return e}};var E=(0,r.HY)({app:l.Ay,display:m,router:s.QB,result:v,preloader:c.A,calling:o.Ay,report:b.Ay});const S=(0,r.y$)(E,(0,r.Tw)(a.A))},1715:(e,t,n)=>{var r,a;n.d(t,{b:()=>r}),function(e){e.GET="get",e.POST="post",e.PUT="put",e.DELETE="delete"}(r||(r={})),function(e){e.ENTITY="entity",e.ENTITIES="entities"}(a||(a={}))},9508:(e,t,n)=>{var r;n.d(t,{O:()=>r}),function(e){e.SALES="sales",e.CUP="cup",e.TMC="tmc",e.SERVICE="service",e.EDU="edu",e.GENERAL="general"}(r||(r={}))}},e=>{e.O(0,[227,610,51,996,992,248,644,484,214],(()=>{return t=3670,e(e.s=t);var t}));e.O()}]);