(self.webpackChunkapril_crm=self.webpackChunkapril_crm||[]).push([[761],{8205:(e,t,n)=>{n.d(t,{R4:()=>s,Ss:()=>a,db:()=>r,pY:()=>l,wV:()=>c});var r=!0,a="gsr.bitrix24.ru",l=143,c=187,s=!1},2754:(e,t,n)=>{n.d(t,{A:()=>de});var r,a,l=n(7075),c=n(9733),s=n(6540),u={setFetchedCallings:function setFetchedCallings(e){return{type:"callings/SET_FITCHED_CALLINGS",callings:e}},setFetchedDepartament:function setFetchedDepartament(e,t,n,r){return{type:"callings/SET_FITCHED_DEPARTAMENT",departament:e,currentUser:t,placement:n,domain:r}},setPrimrtiveStateProp:function setPrimrtiveStateProp(e,t){return{type:"callings/SET_STATE_PROP",name:e,value:t}},setSaleComplete:function setSaleComplete(){return{type:"callings/SET_SALE_COMPLETE"}},setIsNewSaleStatus:function setIsNewSaleStatus(e){return{type:"callings/SET_IS_NEW_SALE_STATUS",status:e}},setSaleQuestionStatus:function setSaleQuestionStatus(e){return{type:"callings/SET_SALE_QUESTION_STATUS",status:e}},setSaleAnswerStatus:function setSaleAnswerStatus(e){return{type:"callings/SET_SALE_ANSWER_STATUS",status:e}},setPresentationCount:function setPresentationCount(e,t){return{type:"callings/SET_PRESENTATION_COUNT",count:e,entityType:t}},setFullCompleteStatus:function setFullCompleteStatus(e){return{type:"callings/SET_FULL_COMPLETE_STATUS",status:e}},setFinishStatus:function setFinishStatus(e,t){return{type:"callings/SET_FINISH_STATUS",status:e,result:t}}},i=n(9002),o=n(4929),p=n(291),d=n(8205),m=n(4003),f=n(1715),b=n(5580),g=n(5750),v=n(9508),E=function setMenuStatus(e,t){return{type:"callings/result/SET_MENU_STATUS",status:e,menuType:t}},__awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},__generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(u){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},y=function getResultMenu(e,t){return function(n,r){return __awaiter(void 0,void 0,void 0,(function(){var a;return __generator(this,(function(l){return n(E(e,t)),{default:{general:{next:{date:"",name:""},workStatus:{items:[],current:null},failReason:{items:[],current:null},noPerspektType:{items:[],current:null},isFail:!1},noResult:{type:{items:[],current:null}}}},a=r().result,a.fetchedKpiList,[2]}))}))}},report_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},report_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(u){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};r||(r={}),function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(a||(a={}));var S=function checkIfTaskIsOverdue(e){var t="no",n=new Date,r=new Date(e.deadline);r<n?t="yes":(r.setHours(0,0,0,0),n.setHours(0,0,0,0),n.getTime()===r.getTime()&&(t="almost"));return t},_=function parseTaskTitle(e){e.match(/^(.*?)(?=\sзапланирован)/),e.match(/запланирован[ао]?\s+(.*?)\s+\d{2}\.\d{2}\.\d{4}/);return{type:"Запланирован",name:e}},A=function getFormatDate(e){if(e){var t=(0,o.H)(e);return(0,p.GP)(t,"d MMMM yyyy HH:mm",{locale:b.ru})}return""},h=n(5826),C=n(9704),T=n(3342),I=n(6556),P=n(4930),w=n(7535),N=n(8756),O=n(7917),x=n(6540);const R=function AprilModal(e){var t=e.isOpen,n=e.cancel,r=e.children,a=(0,s.useState)(!1),c=(0,l.A)(a,2),u=(c[0],c[1],function toggle(){}),i=function close(){n(!1)};return x.createElement("div",null,x.createElement(I.A,{isOpen:t,toggle:u,size:"lg"},x.createElement(P.A,{className:"p-3 ap_modal__header",toggle:i},"Отчет о звонке и планирование"),x.createElement(w.A,null,x.createElement("div",null,r)),x.createElement(N.A,{className:"p-2 calling-modal-q-footer"},x.createElement(O.A,{size:"sm",color:"primary",onClick:u},"Отправить"),x.createElement(O.A,{size:"sm",color:"danger",onClick:i},"Отмена"))))};var D=n(277),k=n(5169),M=n(6477);const L=function ResultMenuPresentation(e){var t=e.presentation,n=(e.presentationDone,e.isFullComplete,(0,s.useState)(!1)),r=(0,l.A)(n,2),a=r[0],c=r[1];return s.createElement(s.Fragment,null,s.createElement("div",{className:"page-content"},s.createElement(k.A,{fluid:!0},s.createElement(h.A,{className:"mb-3"},s.createElement(C.A,{sm:3},s.createElement("h3",{className:"text__bold col-md-4 col-form-label"},"Презентации"))),s.createElement(h.A,null,s.createElement(C.A,{sm:12},s.createElement(h.A,null,s.createElement(C.A,{sm:3},s.createElement("p",{style:{width:"120px"},className:"text__small col-md-3"},"По компании")),s.createElement(C.A,{sm:3},s.createElement("div",{className:"f col-md-12"},s.createElement("input",{disabled:!0,className:"form-control mt-0",type:"text",id:"example-string-input",lang:"rus",value:t.companyCount}))),s.createElement(C.A,{sm:3},s.createElement("p",{className:"text__small col-md-3",style:{width:"120px"}},"Текущие")),s.createElement(C.A,{sm:3},s.createElement("div",{className:"f"},s.createElement("input",{disabled:!0,className:"form-control mt-0",type:"text",id:"example-string-input",lang:"rus",value:t.smartCout})))),s.createElement("div",{onClick:function onClick(){return c(!a)},className:"d-flex flex-column justify-content-start align-items-start"},s.createElement("label",{htmlFor:"example-string-input",className:"col-md-6 mt-1 col-form-label"},"Зафиксировать презентацию"),s.createElement("div",{className:"presentation__actions"},s.createElement(M.A,{style:{cursor:"pointer"},outline:!0,className:"col-md-3 \n                                    ".concat(a?"presentation__badge__active":"presentation__badge")},"Была проведена"),a&&s.createElement("div",{className:"presentation__done__count"},"+1"))))))))};const j=function ResultMenuSuccessReport(e){var t=e.currentResultStatus,n=e.currentFailReason,r=e.setCurentCallingProp,a=e.resultStatuses,c=e.failReasons,u=e.setCurrentFailReason,i=e.setCurrentResultStatus,o=(0,s.useState)(!1),p=(0,l.A)(o,2),d=(p[0],p[1],function handleChange(e,t){"result-status"===e?i(t):"fail-reasone"===e?u(t):r(e,t)});return s.createElement(s.Fragment,null,s.createElement("div",{className:"page-content"},s.createElement(k.A,{fluid:!0},s.createElement(h.A,null,s.createElement("div",{className:"col-md-12 col-form-label"},s.createElement("h3",{className:"text__bold col-md-4 col-form-label"},"Результат"))),s.createElement(h.A,{className:""},s.createElement(C.A,{sm:12},s.createElement("label",{className:"col-md-12 col-form-label"},"Статус Работы"),s.createElement("div",{className:"col-md-12 mt-2  mb-2"},s.createElement("select",{className:"form-control mt-2",onChange:function onChange(e){return d("result-status",e.target.value)}},a&&a.length&&a.map((function(e){return s.createElement("option",{key:"call-type-".concat(e.id),value:e.code},e.name)})))),"fail"===t&&s.createElement(s.Fragment,null,s.createElement("label",{className:"col-md-12 col-form-label"},"Причины отказа"),s.createElement("div",{className:"col-md-12 mt-2  mb-1"},s.createElement("select",{className:"form-control mt-0",value:n,onChange:function onChange(e){return d("fail-reasone",e.target.value)}},c&&c.length&&c.map((function(e){return s.createElement("option",{key:"call-type-".concat(e.id),value:e.code},e.name)}))))))))))};const F=function ResultMenuCallCreate(e){var t=e.responsibility,n=e.createdBy,r=e.date,a=(e.name,e.type),c=e.plan,u=e.setCurentCallingProp,i=e.changeDeadline,o=(e.createTask,(0,s.useState)(c)),p=(0,l.A)(o,2),d=(p[0],p[1]),m=(0,s.useState)(t.current),f=(0,l.A)(m,2),b=(f[0],f[1]),g=(0,s.useState)(n.current),v=(0,l.A)(g,2),E=(v[0],v[1],(0,s.useState)(!1)),y=(0,l.A)(E,2),S=y[0],_=y[1];(0,s.useEffect)((function(){d(c)}),[c]),(0,s.useEffect)((function(){b(t.current)}),[t.current]);var A=function handleChange(e,t){u(e,t)};return s.createElement(s.Fragment,null,s.createElement("label",{htmlFor:"example-string-input",className:"col-md-12 col-form-label ".concat(S?"calling-name-label-error":"")},S?"Заполните обязательное поле - Тема звонка":"Название - что нужно сделать"),s.createElement("div",{className:"col-md-12 mt-2 mb-2"},s.createElement("input",{onChange:function onChange(e){return A(D.u$.NAME,e.target.value)},onFocus:function handleOnNameFocus(){S&&_(!1)},className:"mt-0 form-control ".concat(S?"is-invalid":""),type:"text",id:"example-string-input",lang:"rus"})),s.createElement("label",{htmlFor:"example-datetime-local-input",className:"col-md-12 col-form-label"},"Дата и время звонка"),s.createElement("div",{className:"col-md-12 mt-2   mb-2"},s.createElement("input",{className:"form-control mt-0",type:"datetime-local",defaultValue:r,id:"example-datetime-local-input",lang:"rus",onChange:function onChange(e){return i(e.target.value)}})),s.createElement("label",{className:"col-md-12 col-form-label"},"Тип звонка"),s.createElement("div",{className:"col-md-12 mt-2  mb-0"},s.createElement("select",{className:"form-control  mt-0",value:a.current.id,onChange:function onChange(e){return A(D.u$.TYPE,e.target.value)}},a.items&&a.items.length&&a.items.map((function(e){return s.createElement("option",{key:"call-type-".concat(e.id),value:e.id},e.title)})))))};var U=n(6540);const $=function ResultComment(e){var t=e.handleChange,n=(0,s.useState)(!1),r=(0,l.A)(n,2),a=r[0],c=r[1];return U.createElement(U.Fragment,null,U.createElement("label",{htmlFor:"description-string-input",className:"col-md-12 col-form-label"},"Опишите кратко что было"),U.createElement("div",{className:"col-md-12 mt-2  mb-2"},U.createElement("textarea",{onChange:function onChange(e){return t(D.u$.DESCRIPTION,e.target.value)},onFocus:function handleOnNameFocus(){a&&c(!1)},className:"form-control",type:"text",id:"description-string-input",lang:"rus",rows:"7"})))};const Y=function ResultMenuSuccess(e){var t=e.domain,n=e.currentUser,r=e.responsibility,a=e.createdBy,c=e.date,u=e.name,i=e.type,o=e.plan,p=e.current,d=e.sale,m=(e.isOneMore,e.isUnplannedPresentation),f=e.presentation,b=e.setCurentCallingProp,g=e.changeDeadline,v=e.createTask,E=e.fail,y=e.presentationDone,S=e.isFullComplete,_=(0,s.useState)(o),A=(0,l.A)(_,2),T=(A[0],A[1]),I=(0,s.useState)(r.current),P=(0,l.A)(I,2),w=(P[0],P[1]),N=(0,s.useState)(a.current),O=(0,l.A)(N,2),x=(O[0],O[1],(0,s.useState)(!1)),R=(0,l.A)(x,2),D=(R[0],R[1],(0,s.useState)("inJob")),k=(0,l.A)(D,2),M=k[0],U=k[1],Y=(0,s.useState)("other"),B=(0,l.A)(Y,2),H=B[0],K=B[1];(0,s.useEffect)((function(){T(o)}),[o]),(0,s.useEffect)((function(){w(r.current)}),[r.current]);return s.createElement(s.Fragment,null,s.createElement(h.A,{className:"p-0"},s.createElement(C.A,{sm:6,className:"p-0"},s.createElement(j,{domain:t,currentUser:n,current:p,sale:d,currentFailReason:H,currentResultStatus:M,resultStatuses:[{id:0,code:"inJob",name:"В работе"},{id:1,code:"setAside",name:"Отложено"},{id:2,code:"success",name:"Продажа"},{id:3,code:"fail",name:"Отказ"}],failReasons:[{id:0,code:"secretar",name:"Секретарь"},{id:1,code:"concurent",name:"Остались на конкуренте"},{id:2,code:"phoneFail",name:"Не берут трубку"},{id:3,code:"other",name:"Ссылаются на третьих лиц"},{id:4,code:"money",name:"Дорого/нет Денег"}],setCurrentResultStatus:U,setCurrentFailReason:K,setCurentCallingProp:b,createTask:v,fail:E,isFullComplete:S})),s.createElement(C.A,{sm:6,className:"p-0"},s.createElement(L,{isUnplannedPresentation:m,presentation:f,presentationDone:y,isFullComplete:S}))),s.createElement(h.A,{className:"mt-2"},s.createElement(C.A,{sm:6}),s.createElement(C.A,{sm:6})),s.createElement(h.A,{className:"mt-2"},s.createElement(C.A,{sm:6},s.createElement("h3",{className:"bold"}," Комментарий")),s.createElement(C.A,{sm:6},s.createElement("h3",{className:"bold"}," Планирование следующего звонка"))),s.createElement(h.A,null,s.createElement(C.A,{sm:6},s.createElement($,{handleChange:function handleChange(e,t){b(e,t)}})),("inJob"===M||"setAside"===M)&&s.createElement(C.A,{sm:6},s.createElement(F,{responsibility:r,createdBy:a,date:c,name:u,type:i,plan:o,changeDeadline:g,setCurentCallingProp:b}))))};var B=n(6540);const H=function ResultMenu(e){e.isSuccess;var t=e.domain,n=e.currentUser,r=e.responsibility,a=e.createdBy,l=e.date,c=e.name,s=e.type,u=e.plan,i=e.current,o=e.sale,p=e.isOneMore,d=e.isUnplannedPresentation,m=e.isMenuActive,f=e.presentation,b=e.setCurentCallingProp,g=e.changeDeadline,v=e.createTask,E=e.fail,y=e.presentationDone,S=e.isFullComplete,_=e.setMenuStatus;return B.createElement(R,{isOpen:m,cancel:function cancel(){return _(!1,null)}},B.createElement(Y,{domain:t,currentUser:n,responsibility:r,createdBy:a,date:l,name:c,type:s,plan:u,current:i,sale:o,isOneMore:p,isUnplannedPresentation:d,presentation:f,setCurentCallingProp:b,changeDeadline:g,createTask:v,fail:E,presentationDone:y,isFullComplete:S}))};var K,G,z,q,Q,W,Z=n(8329),X=n(4705),V=n(467),J=n(4756),ee=n.n(J),te=n(6266).A.create({baseURL:"https://april-hook.ru/api",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),ne={getCollection:(z=(0,V.A)(ee().mark((function _callee(e,t,n){var r,a,l,c=arguments;return ee().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(r=c.length>3&&void 0!==c[3]?c[3]:null,a=null,s.prev=2,r){s.next=9;break}return s.next=6,te[t](e);case 6:s.t0=s.sent,s.next=12;break;case 9:return s.next=11,te[t](e,r);case 11:s.t0=s.sent;case 12:if(!(l=s.t0)){s.next=16;break}return l.data&&0===l.data.resultCode&&l.data[n]&&(a=l.data.isCollection?l.data[n].data:l.data[n]),s.abrupt("return",a);case 16:s.next=21;break;case 18:return s.prev=18,s.t1=s.catch(2),s.abrupt("return",a);case 21:case"end":return s.stop()}}),_callee,null,[[2,18]])}))),function getCollection(e,t,n){return z.apply(this,arguments)}),setCollection:(G=(0,V.A)(ee().mark((function _callee2(e,t){var n,r,a;return ee().wrap((function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:return n=null,l.prev=1,r=(0,X.A)({},e,t),l.next=5,te.post(e,r);case 5:return(a=l.sent)&&0===a.data.resultCode&&(n=a.data.data),l.abrupt("return",n);case 10:return l.prev=10,l.t0=l.catch(1),l.abrupt("return",n);case 13:case"end":return l.stop()}}),_callee2,null,[[1,10]])}))),function setCollection(e,t){return G.apply(this,arguments)}),service:(K=(0,V.A)(ee().mark((function _callee3(e,t,n,r){var a,l;return ee().wrap((function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,te[t](e,r);case 4:return(l=c.sent)&&l.data&&0===l.data.resultCode&&(a=l.data[n]),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee3,null,[[1,9]])}))),function service(e,t,n,r){return K.apply(this,arguments)})},re={create:(W=(0,V.A)(ee().mark((function _callee4(e,t,n,r,a,l,c,s,u,i,o,p,d,m){var f,b,g;return ee().wrap((function _callee4$(v){for(;;)switch(v.prev=v.next){case 0:return f=null,b={type:e,auth:{domain:t},company_id:n,deadline:r,responsible:a,created:l,name:c,comment:s,crm:u,company:i,smart:o,sale:p,isOneMore:d,placement:m},v.prev=2,v.next=5,te.post("task/warm",b);case 5:return(g=v.sent)&&g.data&&0===g.data.resultCode&&(f=g.data),v.abrupt("return",f);case 10:return v.prev=10,v.t0=v.catch(2),v.abrupt("return",f);case 13:case"end":return v.stop()}}),_callee4,null,[[2,10]])}))),function create(e,t,n,r,a,l,c,s,u,i,o,p,d,m){return W.apply(this,arguments)}),fail:(Q=(0,V.A)(ee().mark((function _callee5(e,t,n,r,a){var l,c,s;return ee().wrap((function _callee5$(u){for(;;)switch(u.prev=u.next){case 0:return l=null,c={auth:{domain:e},company_id:t,placement:n,smart:a,responsible:r},u.prev=2,u.next=5,te.post("task/fail",c);case 5:return(s=u.sent)&&s.data&&0===s.data.resultCode&&(l=s.data.result),u.abrupt("return",l);case 10:return u.prev=10,u.t0=u.catch(2),u.abrupt("return",l);case 13:case"end":return u.stop()}}),_callee5,null,[[2,10]])}))),function fail(e,t,n,r,a){return Q.apply(this,arguments)}),presentationDone:(q=(0,V.A)(ee().mark((function _callee6(e,t,n,r,a,l,c){var s,u,i;return ee().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return s=null,u={auth:{domain:e},company_id:t,placement:n,company:a,smart:l,responsibleId:r,isUnplannedPresentation:c},o.prev=2,o.next=5,te.post("presentation/done",u);case 5:return(i=o.sent)&&i.data&&0===i.data.resultCode&&(s=i.data.result),o.abrupt("return",s);case 10:return o.prev=10,o.t0=o.catch(2),o.abrupt("return",s);case 13:case"end":return o.stop()}}),_callee6,null,[[2,10]])}))),function presentationDone(e,t,n,r,a,l,c){return q.apply(this,arguments)})},calling_thunk_awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function fulfilled(e){try{step(r.next(e))}catch(e){l(e)}}function rejected(e){try{step(r.throw(e))}catch(e){l(e)}}function step(e){e.done?a(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},calling_thunk_generator=function(e,t){var n,r,a,l,c={label:0,sent:function sent(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(s){return function(u){return function step(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(c=0)),c;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,r=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(a=c.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){c=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){c.label=s[1];break}if(6===s[0]&&c.label<a[1]){c.label=a[1],a=s;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(s);break}a[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},ae=function getCallingPlan(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s;return calling_thunk_generator(this,(function(o){switch(o.label){case 0:return n=t(),r=n.app.domain,a=n.calling[D.u$.RESPONSIBILITY].current,l=n.calling.date,c={domain:r,userId:a&&a.ID,date:l},[4,i.o_.service("bitrix/callingtasks","post","tasks",c)];case 1:return(s=o.sent())&&e(u.setPrimrtiveStateProp(D.u$.PLAN,s)),[2]}}))}))}},le=function getBitrixItems(e){return function(t,n){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var r,a,l,c,s,i,o,p,b,g,v,E,y;return calling_thunk_generator(this,(function(S){switch(S.label){case 0:return Number(e.options.ID),null,e.placement.includes(D.u7.LEAD)?D.u7.LEAD:e.placement.includes(D.u7.COMPANY)&&D.u7.COMPANY,r=n(),a=null,l=r.app.domain,c=r.calling[D.u$.RESPONSIBILITY].current,e.placement.includes(D.u7.LEAD)?(s=Number(e.options.ID),(o=d.db)?[4,m.l.getLead(s)]:[3,2]):[3,5];case 1:o=S.sent(),S.label=2;case 2:return(i=o)?(E={domain:l,leadId:s,userId:null==c?void 0:c.ID},[4,ne.service("smart/item/fromlead",f.b.POST,"data",E)]):[3,4];case 3:(a=S.sent())&&(a.ufCrm10_1709111529&&t(u.setPresentationCount(a.ufCrm10_1709111529,"smart")),a.ufCrm6_1709894507&&t(u.setPresentationCount(a.ufCrm6_1709894507,"smart")),t(u.setPrimrtiveStateProp(D.u$.SMART,a)),a.stageId&&("DT162_26:SUCCESS"!==a.stageId&&"DT156_12:SUCCESS"!==a.stageId||t(u.setSaleComplete()))),i&&(t(u.setPrimrtiveStateProp(D.u$.LEAD,i)),p=n().calling[D.u$.LEAD],t(u.setFullCompleteStatus(p))),S.label=4;case 4:return[3,10];case 5:return e.placement.includes(D.u7.COMPANY)?(b=Number(e.options.ID),(v=d.db)?[4,m.l.getCompany(b)]:[3,7]):[3,10];case 6:v=S.sent(),S.label=7;case 7:return(g=v)?(E={domain:l,companyId:b,userId:null==c?void 0:c.ID},[4,ne.service("smart/item",f.b.POST,"data",E)]):[3,10];case 8:return(a=S.sent())&&(a.ufCrm10_1709111529&&t(u.setPresentationCount(a.ufCrm10_1709111529,"smart")),a.ufCrm6_1709894507&&t(u.setPresentationCount(a.ufCrm6_1709894507,"smart")),t(u.setPrimrtiveStateProp(D.u$.SMART,a)),a.stageId&&("DT162_26:SUCCESS"!==a.stageId&&"DT156_12:SUCCESS"!==a.stageId||t(u.setSaleComplete()))),g?(g.UF_CRM_1709807026&&t(u.setPresentationCount(g.UF_CRM_1709807026,"company")),[4,t(u.setPrimrtiveStateProp(D.u$.COMPANY,g))]):[3,10];case 9:S.sent(),y=n().calling[D.u$.COMPANY],t(u.setFullCompleteStatus(y)),S.label=10;case 10:return[2]}}))}))}},ce=function createTask(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,i,o,d,m,f,b,g,v,E,y,S,_;return calling_thunk_generator(this,(function(A){switch(A.label){case 0:return n=t(),r=n.app.domain,n.app.company,a=n.calling,l=a[D.u$.RESPONSIBILITY].current,c=a[D.u$.CREATED_BY].current,s=a[D.u$.TYPE].current,i=a[D.u$.NAME],o=a[D.u$.DESCRIPTION],d=a[D.u$.DATE],s&&i&&l&&c&&d?[3,1]:(alert("Не заполнено обязательное поле"),[3,5]);case 1:return m=n.calling[D.u$.SALE],f=m.questionStatus,!m.isSaleComplete||f?[3,2]:(e(u.setSaleQuestionStatus(!0)),[3,4]);case 2:return e((0,Z.Z)(!0)),e(u.setSaleQuestionStatus(!1)),b=(0,p.GP)(new Date(d),"dd.MM.yyyy HH:mm:ss"),g=a.placement,v=null,E=a[D.u$.COMPANY],y=a[D.u$.SMART],S=a[D.u$.IS_ONE_MORE],g&&g.options&&(v=g.options.ID),[4,re.create(s.name,r,v,b,"user_".concat(l.ID),"user_".concat(c.ID),i,o,null,E,y,m,S,g)];case 3:A.sent(),_="Звонок запланирован",s.name===D.YI.PRESENTATION&&(_="Презентация запланирована"),e(u.setFinishStatus(!0,_)),A.label=4;case 4:e((0,Z.Z)(!1)),A.label=5;case 5:return[2]}}))}))}},se=n(6540);const ue=(0,c.Ng)((function mapSTate(e){return{domain:e.app.domain,currentUser:e.app.currentUser,responsibility:e.calling.responsibility,createdBy:e.calling.createdBy,name:e.calling.name,type:e.calling.type,plan:e.calling.plan,date:e.calling.date,current:{responsibility:e.calling.responsibility.current,createdBy:e.calling.createdBy.current,type:e.calling.type.current,date:e.calling.type.date,time:e.calling.type.time,name:e.calling.type.name,description:e.calling.type.description},sale:e.calling.sale,presentation:e.calling.presentation,isFullComplete:e.calling.isFullComplete,isOneMore:e.calling.isOneMore,isUnplannedPresentation:e.calling.isUnplannedPresentation,isFinish:e.calling.isFinish,result:e.calling.result,isMenuActive:e.result.isActive}}),{initialCalling:function initialCalling(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,o,p;return calling_thunk_generator(this,(function(f){switch(f.label){case 0:return(r=d.db)?[4,m.l.getPlacement()]:[3,2];case 1:r=f.sent(),f.label=2;case 2:return n=r,e(u.setFinishStatus(!1,"")),a=null,n&&n.placement&&(a=n,console.log("initialCalling calling placement"),console.log(a)),l=t(),c=l.app.domain,s=l.app.currentUser,o=null,p={domain:c},[4,i.o_.service("bitrix/departament","post","departament",p)];case 3:return(o=f.sent())&&e(u.setFetchedDepartament(o,s,a,c)),e(ae()),n&&n.options?e(le(n)):e(u.setFullCompleteStatus(!0)),t(),[2]}}))}))}},setCurentCallingProp:function setCurentCallingProp(e,t){return function(n,r){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var a,l,c,s,o,p,d,m,f;return calling_thunk_generator(this,(function(b){switch(b.label){case 0:switch(a=r(),l=a.app.domain,e){case D.u$.RESPONSIBILITY:case D.u$.CREATED_BY:return[3,1];case D.u$.TYPE:return[3,3];case D.u$.NAME:case D.u$.DESCRIPTION:case D.u$.IS_ONE_MORE:case D.u$.IS_UNPLANNED_PRESENTATION:return[3,4]}return[3,5];case 1:return c=a.calling[e].items,s=c.find((function(e){return e.ID==t})),n(u.setPrimrtiveStateProp(e,s)),o=a.calling[D.u$.DATE],p={domain:l,userId:s.ID,date:o},[4,i.o_.service("bitrix/callingtasks","post","tasks",p)];case 2:return(d=b.sent())&&n(u.setPrimrtiveStateProp(D.u$.PLAN,d)),[3,6];case 3:return m=a.calling[e].items,f=m.find((function(e){return e.id==t})),n(u.setPrimrtiveStateProp(e,f)),[3,6];case 4:return n(u.setPrimrtiveStateProp(e,t)),[3,6];case 5:return[3,6];case 6:return[2]}}))}))}},getCallingPlan:ae,changeDeadline:function changeDeadline(e){return function(t,n){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var r,a,l,c,s,o,p;return calling_thunk_generator(this,(function(d){switch(d.label){case 0:return r=n(),a=r.app.domain,l=r.calling[D.u$.RESPONSIBILITY].current,c=e.split("T"),s=c[0],o={domain:a,userId:l&&l.ID,date:s},[4,i.o_.service("bitrix/callingtasks","post","tasks",o)];case 1:return(p=d.sent())&&t(u.setPrimrtiveStateProp(D.u$.PLAN,p)),t(u.setPrimrtiveStateProp(D.u$.DATE,e)),[2]}}))}))}},createTask:ce,fail:function fail(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,u;return calling_thunk_generator(this,(function(i){switch(i.label){case 0:return e((0,Z.Z)(!0)),n=t(),r=n.app.domain,a=n.calling,l=a[D.u$.SMART],c=a[D.u$.RESPONSIBILITY].current,s=a.placement,u=null,s&&s.options&&(u=s.options.ID),[4,re.fail(r,u,s,"user_".concat(c.ID),l)];case 1:return i.sent(),e((0,Z.Z)(!1)),[2]}}))}))}},presentationDone:function presentationDone(){return function(e,t){return calling_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,u,i,o;return calling_thunk_generator(this,(function(p){switch(p.label){case 0:return e((0,Z.Z)(!0)),n=t(),r=n.app.domain,a=n.calling,l=a.placement,c=null,s=n.calling[D.u$.COMPANY],u=n.calling[D.u$.SMART],i=n.calling[D.u$.IS_UNPLANNED_PRESENTATION],o=a[D.u$.RESPONSIBILITY].current,l&&l.options&&(c=l.options.ID),[4,re.presentationDone(r,c,l,"user_".concat(o.ID),s,u,i)];case 1:return p.sent(),e((0,Z.Z)(!1)),[2]}}))}))}},setFinishStatus:u.setFinishStatus,setMenuStatus:y})((function ResultMenuContainer(e){var t=e.domain,n=e.responsibility,r=e.createdBy,a=e.name,c=e.type,u=e.date,i=e.plan,o=e.current,p=e.sale,d=e.presentation,m=e.setCurentCallingProp,f=e.initialCalling,b=(e.getCallingPlan,e.changeDeadline),g=e.createTask,v=e.fail,E=e.presentationDone,y=e.isFullComplete,S=e.isFinish,_=(e.result,e.isOneMore),A=e.isUnplannedPresentation,h=e.isMenuActive,C=(e.setFinishStatus,e.setMenuStatus),T=(0,s.useState)(!1),I=(0,l.A)(T,2),P=I[0],w=I[1],N=(0,s.useState)(S),O=(0,l.A)(N,2),x=O[0],R=O[1];return(0,s.useEffect)((function(){P||x||(f(),w(!0))}),[P,x]),(0,s.useEffect)((function(){S&&w(!1),R(S)}),[S]),h&&se.createElement(H,{success:!0,domain:t,currentUser:n,responsibility:n,createdBy:r,date:u,name:a,type:c,plan:i,current:o,sale:p,isOneMore:_,isUnplannedPresentation:A,isMenuActive:h,presentation:d,setCurentCallingProp:m,changeDeadline:b,createTask:g,fail:v,presentationDone:E,isFullComplete:y,setMenuStatus:C})}));const ie=function CallingReportTable(e){var t=e.tasks,n=e.setResultMenuStatus;return s.createElement(s.Fragment,null,s.createElement(h.A,null,s.createElement(C.A,{xl:12},s.createElement("div",{className:"table-responsive p-4 calling__page__wrapper"},s.createElement("div",{className:"table-responsive"},s.createElement(T.A,{className:"align-middle mb-0"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",null,"#"),s.createElement("th",null,"Что надо сделать"),s.createElement("th",null,"Тип"),s.createElement("th",null,"Крайний срок"),s.createElement("th",null,"Текущий статус"),s.createElement("th",null,"Действие"))),s.createElement("tbody",null,t&&t.length&&t.map((function(e,t){return s.createElement("tr",null,s.createElement("th",{scope:"row"},t+1),s.createElement("td",null,e.name),s.createElement("td",null,e.type),s.createElement("td",null,e.deadline),s.createElement("td",null,"no"===e.isExpired?s.createElement("span",{className:"statusSuccess"},"Запланирован"):"yes"===e.isExpired?s.createElement("span",{className:"statusWarning"},"Просрочен"):s.createElement("span",{className:"statusExpired"},"Скоро")),s.createElement("td",null,s.createElement("div",{className:"actionsCell"},s.createElement("button",{type:"button",className:"btn btn-sm  mr-5 badge__star",onClick:function onClick(){return n(!0,"result")}},"Результативный"),s.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__error",onClick:function onClick(){return n(!0,"noresult")}},"Не очень"),s.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__errActive",onClick:function onClick(){return n(!0,"expired")}},"Перенос"),s.createElement("button",{type:"button",className:"btn btn-sm ms-2 badge__cancel",onClick:function onClick(){return n(!0,"cancel")}},"Не считать"))))})))))))))};const oe=function CallingFinish(e){var t=e.result,n=e.setFinishStatus;return s.createElement(s.Fragment,null,s.createElement("div",{className:"account-pages my-5 pt-2"},s.createElement(k.A,null,s.createElement(h.A,null,s.createElement(C.A,{lg:"12"},s.createElement("div",{className:"text-center mb-2"},s.createElement("h1",{className:"display-2 fw-medium"},s.createElement("i",{className:"bx bx-buoy bx-spin text-primary display-3"})),s.createElement("h4",{className:"text-uppercase"},t),s.createElement("div",{className:"mt-3 \r d-flex\r justify-content-center\r align-items-center\r "},s.createElement(O.A,{onClick:function startHendler(){n(!1,"")},className:"btn\r col-md-3\r calling-button\r d-flex justify-content-center\r bg-success\r pointer\r ",size:"sm"},"Запланировать еще"))))),s.createElement(h.A,{className:"justify-content-center"},s.createElement(C.A,{md:"8",xl:"6"})))))};var pe=n(6540);const de=(0,c.Ng)((function mapSTate(e){return{domain:e.app.domain,currentUser:e.app.currentUser,responsibility:e.calling.responsibility,tasks:e.report.tasks,isMenuActive:e.result.isActive,isFinish:e.calling.isFinish,result:e.calling.result}}),{initialCallingReport:function initialCallingReport(){return function(e,t){return report_thunk_awaiter(void 0,void 0,void 0,(function(){var n,r,a,l,c,s,u,o,p,b;return report_thunk_generator(this,(function(E){switch(E.label){case 0:return n=t(),r=n.app.domain,a=n.app.currentUser,(c=d.db)?[4,m.l.getPlacement()]:[3,2];case 1:c=E.sent(),E.label=2;case 2:return l=c,s={domain:r||d.Ss,userId:a||d.wV,placement:l||{placement:"COMPANY",options:{ID:d.pY}}},console.log("placement",l),[4,i.o_.service("bitrix/callingreport",f.b.POST,"tasks",s)];case 3:return u=E.sent(),o={domain:r||d.Ss,userId:a||d.wV},[4,i.o_.service("front/portal",f.b.POST,"portal",o)];case 4:return p=E.sent(),d.db&&p&&e(function getHistory(e){return function(t,n){return __awaiter(void 0,void 0,void 0,(function(){var t,n,r;return __generator(this,(function(a){switch(a.label){case 0:return e?(null==(t=e.bitrixLists.find((function(e){return e.group==v.O.SALES&&"history"==e.type})))||t.bitrixfields,n={IBLOCK_TYPE_ID:"lists",IBLOCK_ID:null==t?void 0:t.bitrixId},[4,m.l.getMethod("lists.element.get",n)]):[3,2];case 1:r=a.sent(),console.log("items"),console.log(r),a.label=2;case 2:return[2]}}))}))}}(p)),u&&u.length&&(b=u.map((function(e){var t=_(e.title),n=t.type;return{name:t.name,type:n,isExpired:S(e),deadline:A(e.deadline)}})),e(g.Tb.setFetchedTasks(b))),t(),[2]}}))}))}},setFinishStatus:u.setFinishStatus,setResultMenuStatus:y})((function CallingReportContainer(e){var t=e.domain,n=e.responsibility,r=e.isFinish,a=e.result,c=e.setFinishStatus,u=e.isMenuActive,i=e.tasks,o=e.initialCallingReport,p=e.setResultMenuStatus,d=(0,s.useState)(!1),m=(0,l.A)(d,2),f=m[0],b=m[1],g=(0,s.useState)(r),v=(0,l.A)(g,2),E=v[0],y=v[1];return(0,s.useEffect)((function(){f||E||(o(),b(!0))}),[f,E]),(0,s.useEffect)((function(){r&&b(!1),y(r)}),[r]),E?pe.createElement(oe,{result:a,setFinishStatus:c}):f&&pe.createElement(pe.Fragment,null,u?pe.createElement(ue,null):pe.createElement(ie,{domain:t,responsibility:n,tasks:i,setResultMenuStatus:p}))}))},6750:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6540),a=n(6229);const l=function Logo(){return r.createElement("img",{className:"logo",src:a,alt:"logo"})};n(4003),n(9245);var c=n(6540);const s=function Gradient(e){e.isResized;var t=e.isActive,n=(e.currentRoute,(0,r.useRef)(null));return(0,r.useEffect)((function(){}),[]),c.createElement("div",{ref:n,className:"monohrom__containerApril"},c.createElement("div",{className:"content__wrapper"},c.createElement("div",{className:"newchildren__wrapper"},c.createElement(l,null)),t&&c.createElement("p",{className:"loader__title"},"Загрузка  . . .")))};const u=(0,n(9733).Ng)((function mapStateToProps(e,t){return{isResized:e.app.isResized,isActive:t.isActive}}),{})(s);var i=n(6540);const o=function Preloader(e){var t=e.currentRoute;return i.createElement(u,{currentRoute:t,isActive:!0},i.createElement(l,null))}},6745:(e,t,n)=>{n.d(t,{Ay:()=>I,Fc:()=>C,Vh:()=>h});var r=n(4705),a=n(467),l=n(4756),c=n.n(l),s=n(4003),u=n(9002),i=n(8205),o=n(8329),p=n(9245),d=n(1715);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m="SET_APP_DEAL",f="SET_RESIZE_STATUS",b="SET_APP_DATA",g="SET_APP_BITRIX_DATA",v="SET_INITIALIZED_SUCCESS",E={domain:"",company:null,user:"",currentUser:null,token:"",dealId:null,bitrix:{company:null,deal:null,lead:null},isResized:!1,initialized:!1},y=function setAppData(e,t,n,r,a,l){return{type:b,domain:e,companyId:t,userId:n,currentUser:r,token:a,dealId:l}},S=function setAppBitrixData(e,t){return{type:g,company:e,deal:t}},_=function setResizeStatus(e){return{type:f,boolean:e}},A=function setInitializedSuccess(){return{type:v}},h=function initial(){return function(){var e=(0,a.A)(c().mark((function _callee(e,t){var n,r,a,l,u;return c().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e((0,o.Z)(!0)),n=t(),r=n.router.current,i.db&&r.route===p.a$.CALLING&&e(T()),!i.db){c.next=10;break}return c.next=7,s.l.getDomain();case 7:c.t0=c.sent,c.next=11;break;case 10:c.t0=null;case 11:if(a=c.t0,l=a||i.Ss,!r||!r.route){c.next=28;break}if(r.route!==p.a$.CALLING){c.next=25;break}if(c.t1=i.db,!c.t1){c.next=20;break}return c.next=19,s.l.getCurrentUser();case 19:c.t1=c.sent;case 20:u=c.t1,e(y(l,null,null,u,"",null)),e(A()),c.next=28;break;case 25:e(y(l,null,null,null,"",null)),e(A()),e((0,o.Z)(!1));case 28:e((0,p._t)(p.xY.CALLING,!1)),e((0,o.Z)(!1));case 30:case"end":return c.stop()}}),_callee)})));return function(t,n){return e.apply(this,arguments)}}()},C=function getBitrixData(e,t,n,r,l,o){return function(){var m=(0,a.A)(c().mark((function _callee2(a,m){var f,b,g,v,E,_,A,h;return c().wrap((function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:if(null,null,f={currentCompany:null,currentDeal:null},b=null,g=null,v=!1,!i.db){c.next=12;break}return c.next=9,s.l.getDealAndCompany(l,r);case 9:f=c.sent,c.next=22;break;case 12:if(!r){c.next=17;break}return E={domain:e,companyId:r},c.next=16,u.o_.service("bitrixcompany",d.b.POST,"company",E);case 16:f.currentCompany=c.sent;case 17:if(!l){c.next=22;break}return _={domain:e,dealId:l},c.next=21,u.o_.service("bitrixdeal",d.b.POST,"deal",_);case 21:f.currentCompany=c.sent;case 22:A=f.company,h=f.deal,A&&A.ID&&(b=A.ID),h&&h.ID&&(g=h.ID),a(y(e,b,n,t,o,g)),a(S(A,h)),a((0,p._t)(p.xY.KONSTRUCTOR,v));case 29:case"end":return c.stop()}}),_callee2)})));return function(e,t){return m.apply(this,arguments)}}()},T=function getResizeCalling(){return function(){var e=(0,a.A)(c().mark((function _callee5(e,t){return c().wrap((function _callee5$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.l.getResizeCalling();case 2:e(_(!0));case 3:case"end":return t.stop()}}),_callee5)})));return function(t,n){return e.apply(this,arguments)}}()};const I=function app(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return _objectSpread(_objectSpread({},e),{},{domain:t.domain,company:t.companyId,user:t.userId,token:t.token,dealId:t.dealId,currentUser:t.currentUser});case g:return _objectSpread(_objectSpread({},e),{},{bitrix:_objectSpread(_objectSpread({},e.bitrix),{},{company:t.company,deal:t.deal}),initialized:!0});case m:return _objectSpread(_objectSpread({},e),{},{dealId:t.dealId,bitrix:_objectSpread(_objectSpread({},e.bitrix),{},{deal:t.deal})});case f:return _objectSpread(_objectSpread({},e),{},{isResized:t.status});case v:return _objectSpread(_objectSpread({},e),{},{initialized:!0});default:return e}}},8329:(e,t,n)=>{n.d(t,{A:()=>s,Z:()=>c});var r=n(4705);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a={inProgress:!0},l="PRELOADER",c=function setPreloader(e){return{type:l,bool:e}};const s=function preloader(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;return t.type===l&&e.inProgress!==t.bool?_objectSpread(_objectSpread({},e),{},{inProgress:t.bool}):e}},9002:(e,t,n)=>{n.d(t,{o_:()=>A});var r=n(467),a=n(4705),l=n(4756),c=n.n(l),s=n(8205),u=n(1715),i=n(6266);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var o=i.A.create({baseURL:s.R4?"http://localhost:8000/api":"https://april-online.ru/api",withCredentials:!0,headers:(0,a.A)((0,a.A)((0,a.A)({"content-type":"application/json",accept:"application/json"},"accept","application/json"),"X-Requested-With","XMLHttpRequest"),"X-API-KEY","e0336d3b27299e405a344d2475627c5810eab829a4e5c1214e452e20519d5984")});i.A.create({baseURL:s.R4?"http://localhost:8000":"https://april-online.ru",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}});g=(0,r.A)(c().mark((function _callee3(){var e,t,n;return c().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return e=null,r.prev=1,r.next=4,o.get("profile");case 4:return t=r.sent,(n=t.data)&&(0===n.resultCode?e=n.deal:n.message),r.abrupt("return",e);case 10:return r.prev=10,r.t0=r.catch(1),r.abrupt("return",e);case 13:case"end":return r.stop()}}),_callee3,null,[[1,10]])}))),b=(0,r.A)(c().mark((function _callee4(e){var t,n;return c().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.prev=1,r.next=4,o.post("deal",_objectSpread({},e));case 4:return(n=r.sent)&&(0===n.resultCode?t=n.deal:n.message),r.abrupt("return",t);case 9:return r.prev=9,r.t0=r.catch(1),r.abrupt("return",t);case 12:case"end":return r.stop()}}),_callee4,null,[[1,9]])}))),f=(0,r.A)(c().mark((function _callee5(e,t){var n,r,a;return c().wrap((function _callee5$(l){for(;;)switch(l.prev=l.next){case 0:return n=null,l.prev=1,l.next=4,o.post("getDeal",{dealId:e,domain:t});case 4:return r=l.sent,(a=r.data)&&0===a.resultCode&&(n=a.deal),l.abrupt("return",n);case 10:return l.prev=10,l.t0=l.catch(1),l.abrupt("return",n);case 13:case"end":return l.stop()}}),_callee5,null,[[1,10]])}))),m=(0,r.A)(c().mark((function _callee6(e,t,n,r,a){var l,s,u,i;return c().wrap((function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:return l=null,c.prev=1,c.next=4,o.post("getDescription",{domain:e,userId:t,complect:n,infoblocks:r,groups:a});case 4:if(!(s=c.sent)||!s.data||0!==s.data.resultCode){c.next=9;break}return u=s.data.file,i=s.data.fileBase64,c.abrupt("return",{link:u,file:i});case 9:c.next=14;break;case 11:return c.prev=11,c.t0=c.catch(1),c.abrupt("return",l);case 14:case"end":return c.stop()}}),_callee6,null,[[1,11]])}))),d=(0,r.A)(c().mark((function _callee7(e,t,n,r,a){var l,s;return c().wrap((function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:return l=null,c.prev=1,c.next=4,o.post("get/offer",{domain:e,userId:t,complect:n,infoblocks:r,groups:a});case 4:(s=c.sent)&&s.data&&s.data.resultCode,c.next=11;break;case 8:return c.prev=8,c.t0=c.catch(1),c.abrupt("return",l);case 11:case"end":return c.stop()}}),_callee7,null,[[1,8]])}))),p=(0,r.A)(c().mark((function _callee8(e,t,n){var r,a;return c().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,o.post("get/offer",{domain:e,userId:t,complect,infoblocks,groups});case 4:(a=n.sent)&&a.data&&a.data.resultCode,n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(1),n.abrupt("return",r);case 11:case"end":return n.stop()}}),_callee8,null,[[1,8]])})));var p,d,m,f,b,g,v,E,y,S,_,A={getCollection:(y=(0,r.A)(c().mark((function _callee9(e,t,n,r){var a,l;return c().wrap((function _callee9$(c){for(;;)switch(c.prev=c.next){case 0:if(a=null,c.prev=1,r){c.next=8;break}return c.next=5,o[t](e);case 5:c.t0=c.sent,c.next=11;break;case 8:return c.next=10,o[t](e,r);case 10:c.t0=c.sent;case 11:if(!(l=c.t0)){c.next=15;break}return l.data&&0===l.data.resultCode&&l.data[n]&&(a=l.data.isCollection?l.data[n].data:l.data[n]),c.abrupt("return",a);case 15:c.next=20;break;case 17:return c.prev=17,c.t1=c.catch(1),c.abrupt("return",a);case 20:case"end":return c.stop()}}),_callee9,null,[[1,17]])}))),function getCollection(e,t,n,r){return y.apply(this,arguments)}),setCollection:(E=(0,r.A)(c().mark((function _callee10(e,t){var n,r,l;return c().wrap((function _callee10$(c){for(;;)switch(c.prev=c.next){case 0:return n=null,c.prev=1,r=(0,a.A)({},e,t),c.next=5,o.post(e,r);case 5:return(l=c.sent)&&0===l.data.resultCode&&(n=l.data.data),c.abrupt("return",n);case 10:return c.prev=10,c.t0=c.catch(1),c.abrupt("return",n);case 13:case"end":return c.stop()}}),_callee10,null,[[1,10]])}))),function setCollection(e,t){return E.apply(this,arguments)}),service:(v=(0,r.A)(c().mark((function _callee11(e,t,n,r){var a,l;return c().wrap((function _callee11$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,o[t](e,r);case 4:return(l=c.sent)&&l.data&&(0===l.data.resultCode?a=l.data.data?l.data.data[n]:l.data[n]:1===l.data.resultCode&&(l.data.message?console.log("".concat(n," ").concat(l.data.message)):console.log(l))),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee11,null,[[1,9]])}))),function service(e,t,n,r){return v.apply(this,arguments)})},h=(S=(0,r.A)(c().mark((function _callee12(e,t,n,r,l,s,i,p,d,m,f,b,g,v,E,y,S,_){var A,h,C,T,I,P,w,N,O,x,R,D;return c().wrap((function _callee12$(c){for(;;)switch(c.prev=c.next){case 0:return C=null,T={FIELDS:(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},v.dealName.bitrixId,"".concat(t)),v.assigned.bitrixId,n),v.category.bitrixId,v.category.value),v.stage.bitrixId,v.stage.value),v.opened.bitrixId,v.opened.value),"PROBABILITY",30),"OPPORTUNITY",0),"CURRENCY_ID","RUB"),"UF_CRM_5B39D7C2EC0AB",!0),PARAMS:{REGISTER_SONET_EVENT:"Y"}},I=isNaN(+y.contractSupplyPropSuppliesQuantity)?1:+y.contractSupplyPropSuppliesQuantity,P=S?S.contractConsaltingProp:y.contractConsaltingProp,w=S?S.contractConsaltingComment:y.contractConsaltingComment,N={id:r,fields:(A={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(A,g.contract.bitrixId,l),g.companyId.bitrixId,s),g.npa.bitrixId,i.npa),g.la.bitrixId,i.la),g.c.bitrixId,i.c),g.sp.bitrixId,i.sp),g.er.bitrixId,p.er),g.per.bitrixId,p.per),g.erinpac.bitrixId,p.erinpac),g.lt.bitrixId,m.lt),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(A,g.plt.bitrixId,m.plt),g.ltinpac.bitrixId,m.ltinpac),g.freeBlocks.bitrixId,d),g.consalting.bitrixId,f),g.field_14.bitrixId,b),v.category.bitrixId,v.category.value),v.stage.bitrixId,"C".concat(v.category.value,":NEW"))),PARAMS:{REGISTER_SONET_EVENT:"Y"}},O={id:r,fields:(h={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(h,E.complectName.bitrixId,y.name),E.abonementTime.bitrixId,1===y.contractCoefficient?null:y.contractCoefficient),E.consalting.bitrixId,P),E.note2.bitrixId,w),E.hdd.bitrixId,y.contractSupplyProp1?y.contractSupplyProp1:""),E.way.bitrixId,y.contractSupplyProp2?y.contractSupplyProp2:""),E.note.bitrixId,y.contractSupplyPropComment?y.contractSupplyPropComment:""),E.note3.bitrixId,y.contractSupplyPropEmail?y.contractSupplyPropEmail:""),E.supply.bitrixId,y.supplyName?y.supplyName:""),E.supplyForContract.bitrixId,y.contractSupplyName?y.contractSupplyName:""),(0,a.A)((0,a.A)((0,a.A)((0,a.A)(h,E.loginsQuantity.bitrixId,y.contractSupplyPropLoginsQuantity?y.contractSupplyPropLoginsQuantity:""),E.contractSupplyPropSuppliesQuantity.bitrixId,I),E.supplyForContract.bitrixId,y.contractSupplyName),E.field_1.bitrixId,y.quantityForKp))},x=_.map((function(e,t){var n=e.prepayment,a=e.price.current,l=e.price.default,c=l-a;return{id:e.id||e.number,priceNetto:l,price:a,discountSum:c,discountTypeId:1,ownerId:r,ownerType:"D",productName:"".concat(e.name," ").concat(e.supply.name),quantity:e.price.quantity||n,customized:"Y",supply:e.supplyName,measureCode:e.price.measure.code,measureId:e.price.measure.id,sort:t}})),R={domain:e,dealId:r,setDealData:T,updateDealInfoblocksData:N,updateDealContractData:O,setProductRowsData:{ownerType:"D",ownerId:r,productRows:x},updateProductRowsData:{id:null,fields:{priceNetto:null,price:null,discountSum:null,discountTypeId:1}}},c.prev=11,c.next=14,o[u.b.POST]("konstructor/bitrix/deal/update",R);case 14:return(D=c.sent)&&D.data&&(0===D.data.resultCode?D.data.data&&(C=D.data.data.dealId):1===D.data.resultCode&&(D.data.message?console.log("".concat(D.data.message)):console.log(D))),c.abrupt("return",C);case 19:return c.prev=19,c.t0=c.catch(11),c.abrupt("return",C);case 22:case"end":return c.stop()}}),_callee12,null,[[11,19]])}))),i.A.create({baseURL:"http://localhost:8000/api",withCredentials:!0,headers:{"content-type":"application/json",accept:"application/json","X-Requested-With":"XMLHttpRequest"}}));_=(0,r.A)(c().mark((function _callee13(e,t,n,r){var a,l;return c().wrap((function _callee13$(c){for(;;)switch(c.prev=c.next){case 0:return a=null,c.prev=1,c.next=4,h[t](e,r);case 4:return(l=c.sent)&&l.data&&(0===l.data.resultCode?a=l.data.data?l.data.data[n]:l.data[n]:1===l.data.resultCode&&(l.data.message?console.log("".concat(n," ").concat(l.data.message)):console.log(l))),c.abrupt("return",a);case 9:return c.prev=9,c.t0=c.catch(1),c.abrupt("return",a);case 12:case"end":return c.stop()}}),_callee13,null,[[1,9]])})))},4003:(e,t,n)=>{n.d(t,{l:()=>h});var r=n(467),a=n(4705),l=n(4756),c=n.n(l),s=n(3953);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u,i,o,p,d,m,f,b,g,v,E,y,S,_,A,h={getMethod:(A=(0,r.A)(c().mark((function _callee(e,t){var n,r;return c().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return n=null,a.prev=1,a.next=4,s.g9(e,t);case 4:return(r=a.sent)&&r.answer&&r.answer.result&&(n=r.answer.result),a.abrupt("return",n);case 9:return a.prev=9,a.t0=a.catch(1),console.log("error"),console.log(dealResponse),console.log(a.t0),a.abrupt("return",n);case 15:case"end":return a.stop()}}),_callee,null,[[1,9]])}))),function getMethod(e,t){return A.apply(this,arguments)}),getPlacement:(_=(0,r.A)(c().mark((function _callee2(){var e;return c().wrap((function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.ot.info();case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),_callee2)}))),function getPlacement(){return _.apply(this,arguments)}),getCompanyId:(S=(0,r.A)(c().mark((function _callee3(){var e,t;return c().wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,h.getPlacement();case 3:return e=n.sent,t=e.options.ID,n.abrupt("return",Number(t));case 8:return n.prev=8,n.t0=n.catch(0),n.abrupt("return",null);case 11:case"end":return n.stop()}}),_callee3,null,[[0,8]])}))),function getCompanyId(){return S.apply(this,arguments)}),getCurrentUserId:(y=(0,r.A)(c().mark((function _callee4(e){var t,n;return c().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.next=3,(0,s.g9)("crm.company.get",{id:e});case 3:return n=(n=r.sent).answer&&n.answer.result,t=n?n.ASSIGNED_BY_ID:null,r.abrupt("return",t);case 7:case"end":return r.stop()}}),_callee4)}))),function getCurrentUserId(e){return y.apply(this,arguments)}),getCurrentUser:(E=(0,r.A)(c().mark((function _callee5(){var e,t;return c().wrap((function _callee5$(n){for(;;)switch(n.prev=n.next){case 0:return e=null,n.prev=1,n.next=4,(0,s.g9)("user.current");case 4:return(t=n.sent)&&t.answer&&t.answer.result&&t.answer.result.ID&&(e=t.answer.result),n.abrupt("return",e);case 9:return n.prev=9,n.t0=n.catch(1),console.log(n.t0),n.abrupt("return",null);case 13:case"end":return n.stop()}}),_callee5,null,[[1,9]])}))),function getCurrentUser(){return E.apply(this,arguments)}),getResize:(v=(0,r.A)(c().mark((function _callee6(){var e,t;return c().wrap((function _callee6$(n){for(;;)switch(n.prev=n.next){case 0:return e=.9*window.screen.height,t=.73*window.screen.width,n.next=5,(0,s.Ru)(t,e);case 5:n.sent;case 6:case"end":return n.stop()}}),_callee6)}))),function getResize(){return v.apply(this,arguments)}),getResizeCalling:(g=(0,r.A)(c().mark((function _callee7(){return c().wrap((function _callee7$(e){for(;;)switch(e.prev=e.next){case 0:return window.screen.height,window.screen.width,e.next=5,(0,s.eQ)();case 5:e.sent;case 6:case"end":return e.stop()}}),_callee7)}))),function getResizeCalling(){return g.apply(this,arguments)}),getScroll:(b=(0,r.A)(c().mark((function _callee8(){var e,t;return c().wrap((function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log("scroll"),n.next=4,(0,s.TC)();case 4:return e=n.sent,console.log(e),n.next=8,(0,s.OO)(100);case 8:t=n.sent,console.log(t),n.next=14;break;case 12:n.prev=12,n.t0=n.catch(0);case 14:case"end":return n.stop()}}),_callee8,null,[[0,12]])}))),function getScroll(){return b.apply(this,arguments)}),getLead:(f=(0,r.A)(c().mark((function _callee9(e){var t,n;return c().wrap((function _callee9$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,console.log("crm.lead.get"),r.prev=2,r.next=5,s.g9("crm.lead.get",{id:e});case 5:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result,console.log(t)),r.abrupt("return",t);case 10:return r.prev=10,r.t0=r.catch(2),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 16:case"end":return r.stop()}}),_callee9,null,[[2,10]])}))),function getLead(e){return f.apply(this,arguments)}),getCompany:(m=(0,r.A)(c().mark((function _callee10(e){var t,n;return c().wrap((function _callee10$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,console.log("crm.company.get"),r.prev=2,r.next=5,s.g9("crm.company.get",{id:e,select:["TITLE","ID","UF_CRM_1706007840","UF_CRM_1706007882","UF_CRM_1706007856"]});case 5:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result,console.log(t)),r.abrupt("return",t);case 10:return r.prev=10,r.t0=r.catch(2),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 16:case"end":return r.stop()}}),_callee10,null,[[2,10]])}))),function getCompany(e){return m.apply(this,arguments)}),getDeal:(d=(0,r.A)(c().mark((function _callee11(e){var t,n;return c().wrap((function _callee11$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,r.prev=1,r.next=4,s.g9("crm.deal.get",{id:e,select:["TITLE","COMPANY_ID","ID","UF_CRM_1695372881","UF_CRM_1695373462","UF_CRM_1695373326"]});case 4:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result),r.abrupt("return",t);case 9:return r.prev=9,r.t0=r.catch(1),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 15:case"end":return r.stop()}}),_callee11,null,[[1,9]])}))),function getDeal(e){return d.apply(this,arguments)}),getDealAndCompany:(p=(0,r.A)(c().mark((function _callee12(){var e,t,n,r,a=arguments;return c().wrap((function _callee12$(l){for(;;)switch(l.prev=l.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:null,t=a.length>1&&void 0!==a[1]?a[1]:null,l.prev=2,n=null,r=null,t||!e){l.next=16;break}return l.next=8,h.getDeal(e);case 8:if(!(n=l.sent)||!n.COMPANY_ID){l.next=14;break}return t=n.COMPANY_ID,l.next=13,h.getCompany(t);case 13:r=l.sent;case 14:l.next=21;break;case 16:if(!t||e){l.next=21;break}return l.next=19,h.getCompany(t);case 19:r=l.sent,n&&n.COMPANY_ID&&(t=n.COMPANY_ID);case 21:return l.abrupt("return",{company:r,deal:n});case 24:return l.prev=24,l.t0=l.catch(2),console.error("Произошла ошибка при выполнении запроса",l.t0),l.abrupt("return",{company:null,deal:null});case 28:case"end":return l.stop()}}),_callee12,null,[[2,24]])}))),function getDealAndCompany(){return p.apply(this,arguments)}),getSmart:(o=(0,r.A)(c().mark((function _callee13(e){var t,n;return c().wrap((function _callee13$(r){for(;;)switch(r.prev=r.next){case 0:return t=null,$method="/crm.item.list.json",$data={entityTypeId:e,filter:{"=assignedById":$userId,COMPANY_ID:$companyId}},r.prev=3,r.next=6,s.g9("crm.item.list",{id:dealId});case 6:return(n=r.sent)&&n.answer&&n.answer.result&&(t=n.answer.result.items),r.abrupt("return",t);case 11:return r.prev=11,r.t0=r.catch(3),console.log("error"),console.log(dealResponse),console.log(r.t0),r.abrupt("return",t);case 17:case"end":return r.stop()}}),_callee13,null,[[3,11]])}))),function getSmart(e){return o.apply(this,arguments)}),getDomain:(i=(0,r.A)(c().mark((function _callee14(){var e;return c().wrap((function _callee14$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.xI();case 2:return t.sent,t.next=5,s.FB();case 5:return e=t.sent,t.abrupt("return",e);case 7:case"end":return t.stop()}}),_callee14)}))),function getDomain(){return i.apply(this,arguments)}),updateRecipient:(u=(0,r.A)(c().mark((function _callee15(e,t,n,r,a){var l,u,i,o,p,d,m,f,b;return c().wrap((function _callee15$(c){for(;;)switch(c.prev=c.next){case 0:if(!e&&!t){c.next=28;break}if(!(n||r||a)){c.next=28;break}return l={},u={},n&&(l.UF_CRM_1706007840=n,u.UF_CRM_1695372881=n),r&&(l.UF_CRM_1706007856=r,u.UF_CRM_1695373326=r),a&&(l.UF_CRM_1706007882=a,u.UF_CRM_1695373462=a),i={ID:e,FIELDS:_objectSpread({},u),PARAMS:{REGISTER_SONET_EVENT:"Y"}},o={ID:t,FIELDS:_objectSpread({},l),PARAMS:{REGISTER_SONET_EVENT:"Y"}},p="crm.company.update",d=null,m=null,c.prev=13,c.next=16,s.g9("crm.deal.update",_objectSpread({},i));case 16:return f=c.sent,c.next=19,s.g9(p,_objectSpread({},o));case 19:return b=c.sent,d=f.answer&&f.answer.result,m=b.answer&&b.answer.result,c.abrupt("return",{deal:d,company:m});case 25:return c.prev=25,c.t0=c.catch(13),c.abrupt("return",d);case 28:case"end":return c.stop()}}),_callee15,null,[[13,25]])}))),function updateRecipient(e,t,n,r,a){return u.apply(this,arguments)})}},5750:(e,t,n)=>{n.d(t,{Ay:()=>u,Tb:()=>s});var r,a,l,__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.COLD="cold",e.WARM="warm",e.PRESENTATION="presentation",e.HOT="hot"}(r||(r={})),a||(a={}),function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(l||(l={}));var c={tasks:null,isFetched:!1,isMenuActive:!0},s={setFetchedTasks:function setFetchedTasks(e){return{type:"report/SET_FITCHED_TASKS",tasks:e}},setFetchedDepartament:function setFetchedDepartament(e,t,n,r){return{type:"report/SET_FITCHED_DEPARTAMENT",departament:e,currentUser:t,placement:n,domain:r}}};const u=function report(e,t){return void 0===e&&(e=c),"report/SET_FITCHED_TASKS"===t.type?__assign(__assign({},e),{tasks:t.tasks}):e}},277:(e,t,n)=>{n.d(t,{Ay:()=>p,YI:()=>a,u$:()=>l,u7:()=>c});var r,a,l,c,s=n(291),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.COLD="cold",e.WARM="warm",e.PRESENTATION="presentation",e.HOT="hot",e.PAY="moneyAwait"}(a||(a={})),function(e){e.NAME="name",e.DESCRIPTION="description",e.RESPONSIBILITY="responsibility",e.CREATED_BY="createdBy",e.DATE="date",e.TIME="time",e.TYPE="type",e.STATUS="status",e.CRM="crm",e.PLAN="plan",e.COMPANY="company",e.LEAD="lead",e.SMART="smart",e.SALE="sale",e.PRESENTATION="presentation",e.IS_ONE_MORE="isOneMore",e.IS_UNPLANNED_PRESENTATION="isUnplannedPresentation"}(l||(l={})),function(e){e.LEAD="LEAD",e.COMPANY="COMPANY"}(c||(c={}));var u=function getInitialDate(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);return{first:(0,s.GP)(t,"yyyy-MM-dd"),current:(0,s.GP)(e,"yyyy-MM-dd HH:mm:ss")}},i=[{id:1,name:a.WARM,title:"Звонок"},{id:2,name:a.PRESENTATION,title:"Презентация"},{id:3,name:a.HOT,title:"Решение"},{id:4,name:a.PAY,title:"Оплата"}],o=((r={})[l.RESPONSIBILITY]={items:[],current:null},r[l.CREATED_BY]={items:[],current:null},r.type={items:i,current:{id:1,name:a.WARM,title:"Звонок"}},r.name="",r[l.DESCRIPTION]="",r.date=u().current,r.time=null,r.plan=[],r.placement=null,r.groupId=28,r.company=null,r.smart=null,r[l.SALE]={isActive:!1,questionStatus:!1,isSaleComplete:!1,isCreateNewSale:!1,questions:{new:{id:0,title:"Уже сделана продажа этому клиенту",isActive:!0,value:!0,isAnswered:!1}}},r.presentation={companyCount:0,smartCout:0},r[l.IS_ONE_MORE]=!1,r[l.IS_UNPLANNED_PRESENTATION]=!1,r.isFullComplete=!1,r.isFinish=!1,r.result="",r);const p=function calling(e,t){var n,r,c;switch(void 0===e&&(e=o),t.type){case"callings/SET_FITCHED_CALLINGS":return __assign(__assign({},e),{calling:t.callings});case"callings/SET_FITCHED_DEPARTAMENT":var s=t.currentUser?t.currentUser:t.departament[0],p=107;return"alfacentr.bitrix24.ru"===t.domain&&(p=158),__assign(__assign({},e),{responsibility:__assign(__assign({},e.responsibility),{items:t.departament,current:s}),createdBy:__assign(__assign({},e.createdBy),{items:t.departament,current:{ID:p}}),placement:t.placement});case"callings/SET_STATE_PROP":switch(t.name){case l.RESPONSIBILITY:case l.CREATED_BY:case l.TYPE:return __assign(__assign({},e),((n={})[t.name]=__assign(__assign({},e[t.name]),{current:t.value}),n));default:return __assign(__assign({},e),((r={})[t.name]=t.value,r))}case"callings/SET_SALE_COMPLETE":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{isSaleComplete:!0})});case"callings/SET_IS_NEW_SALE_STATUS":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{isCreateNewSale:t.status})});case"callings/SET_SALE_ANSWER_STATUS":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{questionStatus:t.status})});case"callings/SET_SALE_QUESTION_STATUS":return __assign(__assign({},e),{sale:__assign(__assign({},e.sale),{isActive:t.status})});case"callings/SET_PRESENTATION_COUNT":var d=__assign({},e.presentation);return"company"==t.entityType?d.companyCount=t.count:"smart"==t.entityType&&(d.smartCout=t.count),__assign(__assign({},e),{presentation:__assign(__assign({},e.presentation),d)});case"callings/SET_FULL_COMPLETE_STATUS":return __assign(__assign({},e),{isFullComplete:t.status});case"callings/SET_FINISH_STATUS":return(c={})[l.RESPONSIBILITY]={items:[],current:null},c[l.CREATED_BY]={items:[],current:null},c.type={items:i,current:{id:1,name:a.WARM,title:"Звонок"}},c.name="",c[l.DESCRIPTION]="",c.date=u().current,c.time=null,c.plan=[],c.placement=null,c.groupId=28,c.company=null,c.smart=null,c[l.SALE]={isActive:!1,questionStatus:!1,isSaleComplete:!1,isCreateNewSale:!1,questions:{new:{id:0,title:"Уже сделана продажа этому клиенту",isActive:!0,value:!0,isAnswered:!1}}},c.presentation={companyCount:0,smartCout:0},c[l.IS_ONE_MORE]=!1,c[l.IS_UNPLANNED_PRESENTATION]=!1,c.isFullComplete=!1,c.isFinish=t.status,c.result=t.result,c;default:return e}}},9245:(e,t,n)=>{n.d(t,{QB:()=>o,_t:()=>u,a$:()=>r,xY:()=>a});var r,a,l=n(8329),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.GLOBAL="global",e.KONSTRUCTOR="konstructor",e.PRODUCTS="products",e.TEMPLATE="template",e.DOCUMENT="document",e.REPORT="report",e.CALLING="calling",e.TRANSKRIBATION="transcribation",e.FINISH="finish"}(r||(r={})),function(e){e.KONSTRUCTOR="konstructor",e.REPORT="report",e.CALLING="calling",e.TRANSKRIBATION="transcribation"}(a||(a={}));var c={routes:[{id:0,name:"Начальные настройки",route:r.GLOBAL},{id:1,name:"Конструктор",route:r.KONSTRUCTOR},{id:2,name:"Цены и сравнение комплектов",route:r.PRODUCTS},{id:3,name:"Выбор Шаблона",route:r.TEMPLATE},{id:4,name:"Документ",route:r.DOCUMENT},{id:5,name:"Отчет",route:r.REPORT},{id:6,name:"Звонки",route:r.CALLING},{id:7,name:"Транскрибация",route:r.TRANSKRIBATION},{id:8,name:"Финиш",route:r.FINISH}],current:{id:6,name:"Звонки",route:r.CALLING},previous:null,next:null},s=function setCurrentRoute(e){return{type:"router/SET_CURRENT",id:e}},u=function setInitialRoute(e,t){return function(e,t){e(i(r.CALLING))}},i=function navigate(e){return function(t,n){console.log("navigate "+e);var r=n().router.routes.find((function(t){return t.route===e}));if(r){var a=r.id;t(s(a))}t((0,l.Z)(!1))}},o=function router(e,t){if(void 0===e&&(e=c),"router/SET_CURRENT"===t.type){var n=e.routes.find((function(e){return e.id==t.id})),r=e.current,a=e.previous;return n?__assign(__assign({},e),{current:n,previous:r,next:a}):e}return e}},7775:(e,t,n)=>{n.d(t,{A:()=>S});var r=n(2960),a=n(1265),l=n(6745),c=n(8329),s=n(9245),u=n(277),i=n(4705);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var o="SET_TOP_DISPLAY_STATUS",p="SET_SCROLL_TOP_STATUS",d={isTopDisplayShowing:!0,scrollTop:!1};const m=function display(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o:return _objectSpread(_objectSpread({},e),{},{isTopDisplayShowing:t.status});case p:return _objectSpread(_objectSpread({},e),{},{scrollTop:t.status});default:return e}};var f,b=n(5750),g=n(9508),__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},__assign.apply(this,arguments)};!function(e){e.RESULT="result",e.NORESULT="noresult",e.EXPIRED="expired"}(f||(f={}));var v={isActive:!1,type:null,fetchedKpiList:null};const E=function callingResult(e,t){switch(void 0===e&&(e=v),t.type){case"callings/result/SET_FITCHED_LIST":var n=t.portal.bitrixLists.find((function(e){return e.group==g.O.SALES}));return __assign(__assign({},e),{fetchedKpiList:n});case"callings/result/SET_MENU_STATUS":return __assign(__assign({},e),{isActive:t.status,type:t.status?t.menuType:null});default:return e}};var y=(0,r.HY)({app:l.Ay,display:m,router:s.QB,result:E,preloader:c.A,calling:u.Ay,report:b.Ay});const S=(0,r.y$)(y,(0,r.Tw)(a.A))},1715:(e,t,n)=>{var r,a;n.d(t,{b:()=>r}),function(e){e.GET="get",e.POST="post",e.PUT="put",e.DELETE="delete"}(r||(r={})),function(e){e.ENTITY="entity",e.ENTITIES="entities"}(a||(a={}))},9508:(e,t,n)=>{var r;n.d(t,{O:()=>r}),function(e){e.SALES="sales",e.CUP="cup",e.TMC="tmc",e.SERVICE="service",e.EDU="edu",e.GENERAL="general"}(r||(r={}))}},e=>{e.O(0,[227,610,51,996,992,248,644,484,214],(()=>{return t=3670,e(e.s=t);var t}));e.O()}]);